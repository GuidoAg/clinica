import{a as xe,b as Ce}from"./chunk-DZUCOP4O.js";import{a as fe}from"./chunk-KLTD2K6X.js";import{a as L}from"./chunk-WZDOETQ3.js";import{a as ge}from"./chunk-EVSMGOY5.js";import{n as _e}from"./chunk-4CBNAM3C.js";import{l as pe}from"./chunk-ISKSCZVY.js";import"./chunk-X5YLR3NI.js";import"./chunk-J36EOOTC.js";import{c as B,g as W,j as H,l as ne,m as le,s as se,t as ce,u as de,v as ue,w as j,x as me}from"./chunk-ET4QANTK.js";import"./chunk-BJZ3VNWM.js";import{e as ae,h as re,i as oe,j as N}from"./chunk-EUZGYKR3.js";import{Db as p,Fb as c,Oa as l,P as Y,Qb as te,Ta as q,Tb as s,Ub as A,Vb as C,Wb as D,Xb as v,Yb as b,Z as I,Za as P,Zb as y,bc as E,ca as u,cc as O,da as m,eb as K,ec as F,f as X,fc as ie,gc as z,mb as ee,na as w,nb as g,ob as x,pb as M,qb as V,rb as k,sb as _,tb as o,ub as n,vb as U,zb as h}from"./chunk-7RTQA4J5.js";import{i as R}from"./chunk-ODN5LVDJ.js";var f={altura:{min:40,max:250,unidad:"cm"},peso:{min:.5,max:300,unidad:"kg"},temperatura:{min:32,max:43,unidad:"\xB0C"},presion:{sistolica:{min:50,max:250},diastolica:{min:30,max:180},unidad:"mmHg"}};function T(a,i){return a==null||isNaN(a)?{valido:!1,mensaje:"El valor es requerido"}:a<i.min?{valido:!1,mensaje:`El valor debe ser mayor o igual a ${i.min} ${i.unidad}`}:a>i.max?{valido:!1,mensaje:`El valor debe ser menor o igual a ${i.max} ${i.unidad}`}:{valido:!0,mensaje:""}}function $(a){if(!a||!a.trim())return{valido:!1,mensaje:"La presi\xF3n arterial es requerida"};let i=/^(\d+)\s*[/-]\s*(\d+)$/,e=a.trim().match(i);if(!e)return{valido:!1,mensaje:'Formato inv\xE1lido. Use formato "120/80"'};let r=parseInt(e[1],10),t=parseInt(e[2],10);return r<f.presion.sistolica.min||r>f.presion.sistolica.max?{valido:!1,mensaje:`Presi\xF3n sist\xF3lica debe estar entre ${f.presion.sistolica.min} y ${f.presion.sistolica.max} ${f.presion.unidad}`}:t<f.presion.diastolica.min||t>f.presion.diastolica.max?{valido:!1,mensaje:`Presi\xF3n diast\xF3lica debe estar entre ${f.presion.diastolica.min} y ${f.presion.diastolica.max} ${f.presion.unidad}`}:r<=t?{valido:!1,mensaje:"La presi\xF3n sist\xF3lica debe ser mayor que la diast\xF3lica"}:{valido:!0,mensaje:""}}function he(a){let i=[],e=T(a.alturaCm,f.altura);e.valido||i.push(`Altura: ${e.mensaje}`);let r=T(a.pesoKg,f.peso);r.valido||i.push(`Peso: ${r.mensaje}`);let t=T(a.temperaturaC,f.temperatura);t.valido||i.push(`Temperatura: ${t.mensaje}`);let d=$(a.presionArterial);return d.valido||i.push(`Presi\xF3n arterial: ${d.mensaje}`),{valido:i.length===0,errores:i}}var Ae=a=>({"max-w-3xl p-10":a}),S=a=>({"border-red-500 ring-red-300":a}),Se=(a,i)=>({"bg-indigo-600":a,"bg-gray-300":i}),Fe=(a,i)=>({"translate-x-6":a,"translate-x-1":i}),Te=(a,i)=>({"bg-indigo-600 hover:bg-indigo-800":a,"bg-gray-400":i});function Me(a,i){if(a&1){let e=h();o(0,"button",11),p("click",function(){u(e);let t=c(2);return m(t.mostrarFormularioCancelar=!0)}),s(1," Cancelar turno "),n()}}function Ve(a,i){if(a&1){let e=h();o(0,"button",12),p("click",function(){u(e);let t=c(2);return m(t.mostrarFormularioRechazar=!0)}),s(1," Rechazar turno "),n()}}function ke(a,i){if(a&1){let e=h();o(0,"button",13),p("click",function(){u(e);let t=c(2);return m(t.mostrarFormularioAceptar=!0)}),s(1," Aceptar turno "),n()}}function ze(a,i){if(a&1){let e=h();o(0,"button",14),p("click",function(){u(e);let t=c(2);return m(t.mostrarFormularioFinalizar=!0)}),s(1," Finalizar turno "),n()}}function Re(a,i){if(a&1){let e=h();o(0,"button",15),p("click",function(){u(e);let t=c(2);return m(t.verResenia())}),s(1," Ver rese\xF1a "),n()}}function Ie(a,i){if(a&1){let e=h();o(0,"button",16),p("click",function(){u(e);let t=c(2);return m(t.mostrarFormularioHistoriaClinica=!0)}),s(1," Cargar historia cl\xEDnica "),n()}}function Pe(a,i){if(a&1&&(o(0,"div",2),g(1,Me,2,0,"button",5),g(2,Ve,2,0,"button",6),g(3,ke,2,0,"button",7),g(4,ze,2,0,"button",8),g(5,Re,2,0,"button",9),g(6,Ie,2,0,"button",10),n()),a&2){let e=c();l(),x(e.puedeCancelar?1:-1),l(),x(e.puedeRechazar?2:-1),l(),x(e.puedeAceptar?3:-1),l(),x(e.puedeFinalizar?4:-1),l(),x(e.puedeVerResenia?5:-1),l(),x(e.puedeCargarHistoriaClinica?6:-1)}}function De(a,i){if(a&1){let e=h();o(0,"div",2)(1,"textarea",17),y("ngModelChange",function(t){u(e);let d=c();return b(d.comentarioCancelar,t)||(d.comentarioCancelar=t),m(t)}),n(),o(2,"div",18)(3,"button",19),p("click",function(){u(e);let t=c();return m(t.cancelarAccionCancelar())}),s(4," Cancelar "),n(),o(5,"button",20),p("click",function(){u(e);let t=c();return m(t.confirmarCancelarTurno())}),s(6," Confirmar cancelaci\xF3n "),n()()()}if(a&2){let e=c();l(),v("ngModel",e.comentarioCancelar),l(4),_("disabled",!e.comentarioCancelar.trim()||e.cargando())}}function Oe(a,i){if(a&1){let e=h();o(0,"div",2)(1,"textarea",21),y("ngModelChange",function(t){u(e);let d=c();return b(d.comentarioRechazar,t)||(d.comentarioRechazar=t),m(t)}),n(),o(2,"div",18)(3,"button",19),p("click",function(){u(e);let t=c();return m(t.cancelarAccionRechazar())}),s(4," Cancelar "),n(),o(5,"button",20),p("click",function(){u(e);let t=c();return m(t.confirmarRechazarTurno())}),s(6," Confirmar Rechazo "),n()()()}if(a&2){let e=c();l(),v("ngModel",e.comentarioRechazar),l(4),_("disabled",!e.comentarioRechazar.trim()||e.cargando())}}function Ne(a,i){if(a&1){let e=h();o(0,"div",2)(1,"div",18)(2,"button",19),p("click",function(){u(e);let t=c();return m(t.cancelarAccionAceptar())}),s(3," Cancelar "),n(),o(4,"button",22),p("click",function(){u(e);let t=c();return m(t.confirmarAceptarTurno())}),s(5," Confirmar Aceptar "),n()()()}}function Be(a,i){if(a&1){let e=h();o(0,"div",2)(1,"textarea",23),y("ngModelChange",function(t){u(e);let d=c();return b(d.reseniaFinalizar,t)||(d.reseniaFinalizar=t),m(t)}),n(),o(2,"div",18)(3,"button",19),p("click",function(){u(e);let t=c();return m(t.cancelarAccionFinalizar())}),s(4," Cancelar "),n(),o(5,"button",24),p("click",function(){u(e);let t=c();return m(t.confirmarFinalizarTurno())}),s(6," Confirmar Finalizar "),n()()()}if(a&2){let e=c();l(),v("ngModel",e.reseniaFinalizar),l(4),_("disabled",!e.reseniaFinalizar.trim()||e.cargando())}}function We(a,i){if(a&1){let e=h();o(0,"div",3)(1,"h3",25),s(2," Rese\xF1a "),n(),o(3,"p",26),s(4),n(),o(5,"button",27),p("click",function(){u(e);let t=c();return m(t.volverDesdeVistaResenia())}),s(6," Volver "),n()()}if(a&2){let e=c();l(4),C(" ",e.cita.resenia||"No se ha dejado una rese\xF1a para este turno."," ")}}function He(a,i){if(a&1&&(o(0,"p",33),s(1),n()),a&2){let e=c(2);l(),A(e.errorAltura)}}function je(a,i){if(a&1&&(o(0,"p",33),s(1),n()),a&2){let e=c(2);l(),A(e.errorPeso)}}function Le(a,i){if(a&1&&(o(0,"p",33),s(1),n()),a&2){let e=c(2);l(),A(e.errorTemperatura)}}function Ge(a,i){if(a&1&&(o(0,"p",33),s(1),n()),a&2){let e=c(2);l(),A(e.errorPresion)}}function qe(a,i){if(a&1){let e=h();o(0,"div",41)(1,"div")(2,"label",60),s(3),n(),o(4,"input",61),y("ngModelChange",function(t){let d=u(e).$implicit;return b(d.clave,t)||(d.clave=t),m(t)}),n()(),o(5,"div")(6,"label",60),s(7,"Valor"),n(),o(8,"input",61),y("ngModelChange",function(t){let d=u(e).$implicit;return b(d.valor,t)||(d.valor=t),m(t)}),n()()()}if(a&2){let e=i.$implicit,r=i.$index;l(2),_("for","clave-texto-"+r),l(),C("Clave #",r+1),l(),_("id","clave-texto-"+r),v("ngModel",e.clave),l(2),_("for","valor-texto-"+r),l(2),_("id","valor-texto-"+r),v("ngModel",e.valor)}}function Ke(a,i){if(a&1){let e=h();o(0,"div",4)(1,"h3",28),s(2," Cargar historia cl\xEDnica "),n(),o(3,"div",29)(4,"div")(5,"label",30),s(6,"Altura (cm) "),o(7,"span",31),s(8),n()(),o(9,"input",32),y("ngModelChange",function(t){u(e);let d=c();return b(d.registro.alturaCm,t)||(d.registro.alturaCm=t),m(t)}),p("blur",function(){u(e);let t=c();return m(t.validarAltura())})("input",function(){u(e);let t=c();return m(t.validarAltura())}),n(),g(10,He,2,1,"p",33),n(),o(11,"div")(12,"label",34),s(13,"Peso (kg) "),o(14,"span",31),s(15),n()(),o(16,"input",35),y("ngModelChange",function(t){u(e);let d=c();return b(d.registro.pesoKg,t)||(d.registro.pesoKg=t),m(t)}),p("blur",function(){u(e);let t=c();return m(t.validarPeso())})("input",function(){u(e);let t=c();return m(t.validarPeso())}),n(),g(17,je,2,1,"p",33),n(),o(18,"div")(19,"label",36),s(20,"Temperatura (\xB0C) "),o(21,"span",31),s(22),n()(),o(23,"input",37),y("ngModelChange",function(t){u(e);let d=c();return b(d.registro.temperaturaC,t)||(d.registro.temperaturaC=t),m(t)}),p("blur",function(){u(e);let t=c();return m(t.validarTemperatura())})("input",function(){u(e);let t=c();return m(t.validarTemperatura())}),n(),g(24,Le,2,1,"p",33),n(),o(25,"div")(26,"label",38),s(27,"Presi\xF3n arterial "),o(28,"span",31),s(29,"(ej: 120/80)"),n()(),o(30,"input",39),y("ngModelChange",function(t){u(e);let d=c();return b(d.registro.presionArterial,t)||(d.registro.presionArterial=t),m(t)}),p("blur",function(){u(e);let t=c();return m(t.validarPresion())})("input",function(){u(e);let t=c();return m(t.validarPresion())}),n(),g(31,Ge,2,1,"p",33),n()(),o(32,"div",40)(33,"div",4),V(34,qe,9,7,"div",41,M),n(),o(36,"div",42)(37,"div",29)(38,"div")(39,"label",43),s(40,"Clave slider"),n(),o(41,"input",44),y("ngModelChange",function(t){u(e);let d=c();return b(d.datoSlider.clave,t)||(d.datoSlider.clave=t),m(t)}),n()(),o(42,"div")(43,"label",45),s(44),n(),o(45,"input",46),y("ngModelChange",function(t){u(e);let d=c();return b(d.datoSlider.valor,t)||(d.datoSlider.valor=t),m(t)}),n()()(),o(46,"div",29)(47,"div")(48,"label",47),s(49,"Clave num\xE9rica"),n(),o(50,"input",48),y("ngModelChange",function(t){u(e);let d=c();return b(d.datoNumero.clave,t)||(d.datoNumero.clave=t),m(t)}),n()(),o(51,"div")(52,"label",49),s(53,"Valor"),n(),o(54,"input",50),y("ngModelChange",function(t){u(e);let d=c();return b(d.datoNumero.valor,t)||(d.datoNumero.valor=t),m(t)}),n()()(),o(55,"div",51)(56,"div")(57,"label",52),s(58,"Clave boolean"),n(),o(59,"input",53),y("ngModelChange",function(t){u(e);let d=c();return b(d.datoBoolean.clave,t)||(d.datoBoolean.clave=t),m(t)}),n()(),o(60,"div",54)(61,"button",55),p("click",function(){u(e);let t=c();return m(t.datoBoolean.valor=!t.datoBoolean.valor)}),U(62,"span",56),n(),o(63,"span",57),s(64),n()()()()(),o(65,"div",58)(66,"button",59),p("click",function(){u(e);let t=c();return m(t.guardarHistoriaClinica())}),s(67," Guardar historia cl\xEDnica "),n()()()}if(a&2){let e=c();l(8),D("(",e.RANGOS_MEDICOS.altura.min,"-",e.RANGOS_MEDICOS.altura.max,")"),l(),v("ngModel",e.registro.alturaCm),_("min",e.RANGOS_MEDICOS.altura.min)("max",e.RANGOS_MEDICOS.altura.max)("ngClass",E(40,S,e.errorAltura)),l(),x(e.errorAltura?10:-1),l(5),D("(",e.RANGOS_MEDICOS.peso.min,"-",e.RANGOS_MEDICOS.peso.max,")"),l(),v("ngModel",e.registro.pesoKg),_("min",e.RANGOS_MEDICOS.peso.min)("max",e.RANGOS_MEDICOS.peso.max)("ngClass",E(42,S,e.errorPeso)),l(),x(e.errorPeso?17:-1),l(5),D("(",e.RANGOS_MEDICOS.temperatura.min,"-",e.RANGOS_MEDICOS.temperatura.max,")"),l(),v("ngModel",e.registro.temperaturaC),_("min",e.RANGOS_MEDICOS.temperatura.min)("max",e.RANGOS_MEDICOS.temperatura.max)("ngClass",E(44,S,e.errorTemperatura)),l(),x(e.errorTemperatura?24:-1),l(6),v("ngModel",e.registro.presionArterial),_("ngClass",E(46,S,e.errorPresion)),l(),x(e.errorPresion?31:-1),l(3),k(e.datosTexto),l(7),v("ngModel",e.datoSlider.clave),_("ngClass",E(48,S,!e.datoSlider.clave.trim())),l(3),C(" Valor (0\u2013100): ",e.datoSlider.valor," "),l(),v("ngModel",e.datoSlider.valor),l(5),v("ngModel",e.datoNumero.clave),_("ngClass",E(50,S,!e.datoNumero.clave.trim())),l(4),v("ngModel",e.datoNumero.valor),_("ngClass",E(52,S,e.datoNumero.valor===null)),l(5),v("ngModel",e.datoBoolean.clave),_("ngClass",E(54,S,!e.datoBoolean.clave.trim())),l(2),_("ngClass",O(56,Se,e.datoBoolean.valor,!e.datoBoolean.valor)),ee("aria-checked",e.datoBoolean.valor),l(),_("ngClass",O(59,Fe,e.datoBoolean.valor,!e.datoBoolean.valor)),l(2),C(" ",e.datoBoolean.valor?"S\xED":"No"," "),l(2),_("disabled",e.cargando()||!e.esFormularioHistoriaClinicaValido())("ngClass",O(62,Te,e.esFormularioHistoriaClinicaValido()&&!e.cargando(),!e.esFormularioHistoriaClinicaValido()||e.cargando()))}}var G=class a{cita;cerrar=new K;accionRealizada=new K;turnos=I(L);fb=I(ue);snackBar=I(_e);cargando=w(!1);RANGOS_MEDICOS=f;errorAltura="";errorPeso="";errorTemperatura="";errorPresion="";mostrarFormularioCancelar=!1;mostrarFormularioRechazar=!1;mostrarFormularioAceptar=!1;mostrarFormularioFinalizar=!1;mostrarFormularioResenia=!1;mostrarFormularioHistoriaClinica=!1;comentarioCancelar="";comentarioRechazar="";reseniaFinalizar="";get puedeCancelar(){return this.cita.estado!=="completado"&&this.cita.estado!=="cancelado"&&this.cita.estado!=="aceptado"&&this.cita.estado!=="rechazado"&&!this.mostrarFormularioCancelar&&!this.mostrarFormularioAceptar&&!this.mostrarFormularioFinalizar&&!this.mostrarFormularioRechazar&&!this.mostrarFormularioHistoriaClinica&&!this.mostrarFormularioResenia}get puedeRechazar(){return this.cita.estado!=="completado"&&this.cita.estado!=="cancelado"&&this.cita.estado!=="aceptado"&&this.cita.estado!=="rechazado"&&!this.mostrarFormularioCancelar&&!this.mostrarFormularioAceptar&&!this.mostrarFormularioFinalizar&&!this.mostrarFormularioRechazar&&!this.mostrarFormularioHistoriaClinica&&!this.mostrarFormularioResenia}get puedeAceptar(){return this.cita.estado!=="completado"&&this.cita.estado!=="cancelado"&&this.cita.estado!=="aceptado"&&this.cita.estado!=="rechazado"&&!this.mostrarFormularioCancelar&&!this.mostrarFormularioAceptar&&!this.mostrarFormularioFinalizar&&!this.mostrarFormularioRechazar&&!this.mostrarFormularioHistoriaClinica&&!this.mostrarFormularioResenia}get puedeFinalizar(){return this.cita.estado==="aceptado"&&!this.mostrarFormularioCancelar&&!this.mostrarFormularioAceptar&&!this.mostrarFormularioFinalizar&&!this.mostrarFormularioRechazar&&!this.mostrarFormularioHistoriaClinica&&!this.mostrarFormularioResenia}get puedeCargarHistoriaClinica(){return this.cita.estado==="completado"&&!this.yaTieneHistoriaClinica&&!this.mostrarFormularioCancelar&&!this.mostrarFormularioAceptar&&!this.mostrarFormularioFinalizar&&!this.mostrarFormularioRechazar&&!this.mostrarFormularioResenia&&!this.mostrarFormularioHistoriaClinica}get puedeVerResenia(){return!!this.cita.resenia&&this.cita.resenia.trim().length>0&&!this.mostrarFormularioCancelar&&!this.mostrarFormularioAceptar&&!this.mostrarFormularioFinalizar&&!this.mostrarFormularioRechazar&&!this.mostrarFormularioResenia&&!this.mostrarFormularioHistoriaClinica}get yaTieneHistoriaClinica(){return this.cita.alturaCm!==null&&this.cita.pesoKg!==null&&this.cita.temperaturaC!==null&&!!this.cita.presionArterial?.trim()}registro={alturaCm:0,pesoKg:0,temperaturaC:0,presionArterial:"",citaId:0};datosTexto=[{clave:"",valor:""},{clave:"",valor:""},{clave:"",valor:""}];datoSlider={clave:"",valor:50};datoNumero={clave:"",valor:null};datoBoolean={clave:"",valor:!1};cancelarAccionCancelar(){this.mostrarFormularioCancelar=!1,this.comentarioCancelar=""}confirmarCancelarTurno(){this.comentarioCancelar.trim()&&(this.cargando.set(!0),this.turnos.cancelarCitaEspecialista(this.cita,this.comentarioCancelar.trim()).then(i=>{this.cargando.set(!1),i.success?(this.snackBar.open("Turno cancelado exitosamente.","Cerrar",{duration:3e3}),this.accionRealizada.emit("cancelado"),this.cerrar.emit()):this.snackBar.open(i.message??"Ocurri\xF3 un error","Cerrar",{duration:4e3})}).finally(()=>{this.mostrarFormularioCancelar=!1,this.comentarioCancelar=""}))}cancelarAccionRechazar(){this.mostrarFormularioRechazar=!1,this.comentarioRechazar=""}confirmarRechazarTurno(){this.comentarioRechazar.trim()&&(this.cargando.set(!0),this.turnos.rechazarCitaEspecialista(this.cita,this.comentarioRechazar.trim()).then(i=>{this.cargando.set(!1),i.success?(this.snackBar.open("Turno rechazado exitosamente.","Cerrar",{duration:3e3}),this.accionRealizada.emit("rechazado"),this.cerrar.emit()):this.snackBar.open(i.message??"Ocurri\xF3 un error","Cerrar",{duration:4e3})}).finally(()=>{this.mostrarFormularioRechazar=!1,this.comentarioRechazar=""}))}cancelarAccionAceptar(){this.mostrarFormularioAceptar=!1}confirmarAceptarTurno(){this.cargando.set(!0),this.turnos.aceptarCitaEspecialista(this.cita).then(i=>{this.cargando.set(!1),i.success?(this.snackBar.open("Turno aceptado exitosamente.","Cerrar",{duration:3e3}),this.accionRealizada.emit("aceptado"),this.cerrar.emit()):this.snackBar.open(i.message??"Ocurri\xF3 un error","Cerrar",{duration:4e3})}).finally(()=>{this.mostrarFormularioAceptar=!1})}cancelarAccionFinalizar(){this.mostrarFormularioFinalizar=!1,this.reseniaFinalizar=""}confirmarFinalizarTurno(){this.reseniaFinalizar.trim()&&(this.cargando.set(!0),this.turnos.completarCitaEspecialista(this.cita,this.reseniaFinalizar.trim()).then(i=>{this.cargando.set(!1),i.success?(this.snackBar.open("Turno finalizado exitosamente.","Cerrar",{duration:3e3}),this.accionRealizada.emit("completado"),this.cerrar.emit()):this.snackBar.open(i.message??"Ocurri\xF3 un error","Cerrar",{duration:4e3})}).finally(()=>{this.mostrarFormularioFinalizar=!1,this.reseniaFinalizar=""}))}verResenia(){this.mostrarFormularioResenia=!0}volverDesdeVistaResenia(){this.mostrarFormularioResenia=!1}cancelarHistoriaClinica(){this.mostrarFormularioHistoriaClinica=!1}guardarHistoriaClinica(){return R(this,null,function*(){let i=he(this.registro);if(!i.valido){this.snackBar.open(i.errores.join(". "),"Cerrar",{duration:5e3});return}this.cargando.set(!0);let e=[...this.datosTexto.map(t=>({id:0,clave:t.clave,valor:t.valor,citaId:this.registro.citaId})),{id:0,clave:this.datoSlider.clave,valor:this.datoSlider.valor.toString(),citaId:this.registro.citaId},{id:0,clave:this.datoNumero.clave,valor:(this.datoNumero.valor??0).toString(),citaId:this.registro.citaId},{id:0,clave:this.datoBoolean.clave,valor:this.datoBoolean.valor?"S\xED":"No",citaId:this.registro.citaId}].filter(t=>t.clave&&t.valor);if(!this.registro.alturaCm||!this.registro.pesoKg||!this.registro.temperaturaC||!this.registro.presionArterial?.trim()||!this.datoSlider.clave.trim()||!this.datoNumero.clave.trim()||this.datoNumero.valor===null||!this.datoBoolean.clave.trim()){this.snackBar.open("Complet\xE1 todos los campos obligatorios","Cerrar",{duration:3e3}),this.cargando.set(!1);return}this.registro.citaId=this.cita.citaId;let r=yield this.turnos.cargarHistoriaClinica(this.registro,e);this.cargando.set(!1),r.success?(this.snackBar.open("Historia cl\xEDnica guardada","Cerrar",{duration:3e3}),this.accionRealizada.emit("historia_clinica"),this.cerrar.emit()):this.snackBar.open(r.message??"Error al guardar","Cerrar",{duration:4e3})})}esFormularioHistoriaClinicaValido(){let i=this.registro,e=this.datoSlider.clave.trim()!=="",r=this.datoNumero.clave.trim()!==""&&this.datoNumero.valor!==null,t=this.datoBoolean.clave.trim()!=="",d=this.datosTexto.every(Z=>{let J=Z.clave.trim(),Q=Z.valor.trim();return J&&Q||!J&&!Q});return i.alturaCm!==null&&i.pesoKg!==null&&i.temperaturaC!==null&&!!i.presionArterial?.trim()&&e&&r&&t&&d}cerrarModal(){this.cerrar.emit()}validarAltura(){let i=T(this.registro.alturaCm,f.altura);this.errorAltura=i.valido?"":i.mensaje}validarPeso(){let i=T(this.registro.pesoKg,f.peso);this.errorPeso=i.valido?"":i.mensaje}validarTemperatura(){let i=T(this.registro.temperaturaC,f.temperatura);this.errorTemperatura=i.valido?"":i.mensaje}validarPresion(){let i=$(this.registro.presionArterial);this.errorPresion=i.valido?"":i.mensaje}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=P({type:a,selectors:[["app-acciones-especialista"]],inputs:{cita:"cita"},outputs:{cerrar:"cerrar",accionRealizada:"accionRealizada"},decls:9,vars:10,consts:[["tabindex","0","role","button","aria-label","Cerrar modal",1,"fixed","inset-0","z-50","flex","items-center","justify-center","bg-black/50","backdrop-blur-sm"],["appClickFueraPopup","","tabindex","0","role","dialog","aria-modal","true",1,"fixed","top-1/2","left-1/2","z-50","w-full","max-w-md","-translate-x-1/2","-translate-y-1/2","transform","rounded-2xl","bg-white","p-8","shadow-xl","transition-all","duration-300","md:max-w-3xl",3,"clickFuera","ngClass"],[1,"flex","flex-col","gap-3"],[1,"flex","flex-col","items-center","gap-4","text-center"],[1,"flex","flex-col","gap-4"],[1,"rounded-lg","bg-gray-500","px-4","py-2","font-semibold","text-white","transition-transform","hover:scale-105","hover:bg-gray-800"],[1,"rounded-lg","bg-red-500","px-4","py-2","font-semibold","text-white","transition-transform","hover:scale-105","hover:bg-red-700"],[1,"rounded-lg","bg-green-500","px-4","py-2","font-semibold","text-white","transition-transform","hover:scale-105","hover:bg-green-800"],[1,"rounded-lg","bg-blue-400","px-4","py-2","font-semibold","text-white","transition-transform","hover:scale-105","hover:bg-blue-800"],[1,"rounded-lg","bg-pink-400","px-4","py-2","font-semibold","text-white","transition-transform","hover:scale-105","hover:bg-pink-700"],[1,"rounded-lg","bg-indigo-500","px-4","py-2","font-semibold","text-white","transition-transform","hover:scale-105","hover:bg-indigo-700"],[1,"rounded-lg","bg-gray-500","px-4","py-2","font-semibold","text-white","transition-transform","hover:scale-105","hover:bg-gray-800",3,"click"],[1,"rounded-lg","bg-red-500","px-4","py-2","font-semibold","text-white","transition-transform","hover:scale-105","hover:bg-red-700",3,"click"],[1,"rounded-lg","bg-green-500","px-4","py-2","font-semibold","text-white","transition-transform","hover:scale-105","hover:bg-green-800",3,"click"],[1,"rounded-lg","bg-blue-400","px-4","py-2","font-semibold","text-white","transition-transform","hover:scale-105","hover:bg-blue-800",3,"click"],[1,"rounded-lg","bg-pink-400","px-4","py-2","font-semibold","text-white","transition-transform","hover:scale-105","hover:bg-pink-700",3,"click"],[1,"rounded-lg","bg-indigo-500","px-4","py-2","font-semibold","text-white","transition-transform","hover:scale-105","hover:bg-indigo-700",3,"click"],["placeholder","Ingrese el motivo de cancelaci\xF3n","rows","3",1,"w-full","resize-none","rounded","border","border-gray-300","px-3","py-2","text-sm","focus:ring-2","focus:ring-red-500","focus:outline-none",3,"ngModelChange","ngModel"],[1,"flex","justify-end","gap-3"],["type","button",1,"rounded","border","border-gray-400","px-4","py-2","text-sm","text-gray-700","hover:bg-gray-100",3,"click"],["type","button",1,"rounded","bg-red-600","px-4","py-2","text-sm","font-semibold","text-white","hover:bg-red-800","disabled:opacity-50",3,"click","disabled"],["placeholder","Ingrese el motivo de rechazo","rows","3",1,"w-full","resize-none","rounded","border","border-gray-300","px-3","py-2","text-sm","focus:ring-2","focus:ring-red-500","focus:outline-none",3,"ngModelChange","ngModel"],["type","button",1,"rounded","bg-green-500","px-4","py-2","text-sm","font-semibold","text-white","hover:bg-green-700","disabled:opacity-50",3,"click"],["placeholder","Ingrese una rese\xF1a","rows","3",1,"w-full","resize-none","rounded","border","border-gray-300","px-3","py-2","text-sm","focus:ring-2","focus:ring-pink-400","focus:outline-none",3,"ngModelChange","ngModel"],["type","button",1,"rounded","bg-pink-400","px-4","py-2","text-sm","font-semibold","text-white","hover:bg-pink-600","disabled:opacity-50",3,"click","disabled"],[1,"text-xl","font-bold","text-[color:var(--color-azul-oscuro)]"],[1,"px-2","text-gray-700","italic"],[1,"mt-4","rounded","bg-gray-300","px-4","py-2","text-sm","font-semibold","text-gray-800","hover:bg-gray-400",3,"click"],[1,"text-center","text-xl","font-bold","text-[color:var(--color-azul-oscuro)]"],[1,"grid","grid-cols-2","gap-4"],["for","altura",1,"mb-1","block","text-sm","font-medium","text-gray-700"],[1,"text-xs","text-gray-500"],["id","altura","required","","type","number","step","0.1",1,"w-full","rounded-lg","border","px-3","py-2","text-sm","shadow-sm","transition","focus:border-indigo-500","focus:ring","focus:ring-indigo-300",3,"ngModelChange","blur","input","ngModel","min","max","ngClass"],[1,"mt-1","text-xs","text-red-600"],["for","peso",1,"mb-1","block","text-sm","font-medium","text-gray-700"],["id","peso","required","","type","number","step","0.1",1,"w-full","rounded-lg","border","px-3","py-2","text-sm","shadow-sm","transition","focus:border-indigo-500","focus:ring","focus:ring-indigo-300",3,"ngModelChange","blur","input","ngModel","min","max","ngClass"],["for","temperatura",1,"mb-1","block","text-sm","font-medium","text-gray-700"],["id","temperatura","required","","type","number","step","0.1",1,"w-full","rounded-lg","border","px-3","py-2","text-sm","shadow-sm","transition","focus:border-indigo-500","focus:ring","focus:ring-indigo-300",3,"ngModelChange","blur","input","ngModel","min","max","ngClass"],["for","presion",1,"mb-1","block","text-sm","font-medium","text-gray-700"],["id","presion","required","","type","text","placeholder","120/80",1,"w-full","rounded-lg","border","px-3","py-2","text-sm","shadow-sm","transition","focus:border-indigo-500","focus:ring","focus:ring-indigo-300",3,"ngModelChange","blur","input","ngModel","ngClass"],[1,"mt-6","grid","grid-cols-1","gap-6","md:grid-cols-2"],[1,"grid","grid-cols-2","gap-2"],[1,"mt-6","flex","flex-col","gap-6"],["for","clave-slider",1,"text-sm","font-medium","text-gray-700"],["id","clave-slider","required","","type","text",1,"w-full","rounded-lg","border","px-3","py-2","text-sm","shadow-sm","transition","focus:border-indigo-500","focus:ring","focus:ring-indigo-300",3,"ngModelChange","ngModel","ngClass"],["for","valor-slider",1,"text-sm","font-medium","text-gray-700"],["id","valor-slider","type","range","min","0","max","100",1,"w-full","accent-indigo-500",3,"ngModelChange","ngModel"],["for","clave-numero",1,"text-sm","font-medium","text-gray-700"],["id","clave-numero","required","","type","text",1,"w-full","rounded-lg","border","px-3","py-2","text-sm","shadow-sm","transition","focus:border-indigo-500","focus:ring","focus:ring-indigo-300",3,"ngModelChange","ngModel","ngClass"],["for","valor-numero",1,"text-sm","font-medium","text-gray-700"],["id","valor-numero","required","","type","number",1,"w-full","rounded-lg","border","px-3","py-2","text-sm","shadow-sm","transition","focus:border-indigo-500","focus:ring","focus:ring-indigo-300",3,"ngModelChange","ngModel","ngClass"],[1,"grid","grid-cols-2","items-center","gap-4"],["for","clave-boolean",1,"text-sm","font-medium","text-gray-700"],["id","clave-boolean","required","","type","text",1,"w-full","rounded-lg","border","px-3","py-2","text-sm","shadow-sm","transition","focus:border-indigo-500","focus:ring","focus:ring-indigo-300",3,"ngModelChange","ngModel","ngClass"],[1,"mt-6","flex","items-center","gap-3"],["type","button","role","switch",1,"relative","inline-flex","h-6","w-11","items-center","rounded-full","transition-colors","focus:ring-2","focus:ring-indigo-500","focus:ring-offset-2","focus:outline-none",3,"click","ngClass"],[1,"inline-block","h-4","w-4","transform","rounded-full","bg-white","shadow-lg","transition-transform",3,"ngClass"],[1,"text-sm","font-medium","text-gray-700"],[1,"mt-6","flex","justify-end","gap-4"],[1,"rounded-lg","px-4","py-2","text-sm","font-semibold","text-white","transition","disabled:cursor-not-allowed","disabled:opacity-50",3,"click","disabled","ngClass"],[1,"mb-1","block","text-sm","font-medium","text-gray-700",3,"for"],["type","text",1,"w-full","rounded-lg","border","border-gray-300","px-3","py-2","text-sm","shadow-sm","transition","focus:border-indigo-500","focus:ring","focus:ring-indigo-300",3,"ngModelChange","id","ngModel"]],template:function(e,r){e&1&&(U(0,"div",0),o(1,"div",1),p("clickFuera",function(){return r.cerrarModal()}),g(2,Pe,7,6,"div",2),g(3,De,7,2,"div",2),g(4,Oe,7,2,"div",2),g(5,Ne,6,0,"div",2),g(6,Be,7,2,"div",2),g(7,We,7,1,"div",3),g(8,Ke,68,65,"div",4),n()),e&2&&(l(),_("ngClass",E(8,Ae,r.mostrarFormularioHistoriaClinica)),l(),x(!r.mostrarFormularioCancelar&&!r.mostrarFormularioRechazar&&!r.mostrarFormularioAceptar&&!r.mostrarFormularioFinalizar&&!r.mostrarFormularioResenia?2:-1),l(),x(r.mostrarFormularioCancelar?3:-1),l(),x(r.mostrarFormularioRechazar?4:-1),l(),x(r.mostrarFormularioAceptar?5:-1),l(),x(r.mostrarFormularioFinalizar?6:-1),l(),x(r.mostrarFormularioResenia?7:-1),l(),x(r.mostrarFormularioHistoriaClinica?8:-1))},dependencies:[N,ae,j,B,ne,le,W,de,ce,se,H,me,ge],encapsulation:2})};function Ue(a,i){if(a&1){let e=h();o(0,"app-acciones-especialista",11),p("cerrar",function(){u(e);let t=c();return m(t.cerrarPopupAcciones())})("accionRealizada",function(){u(e);let t=c();return m(t.accionDesdeModal())}),n()}if(a&2){let e=c();_("cita",e.citaSeleccionada())}}function $e(a,i){if(a&1&&(o(0,"th",10),s(1),n()),a&2){let e=i.$implicit;l(),A(e.label)}}function Ze(a,i){if(a&1&&(o(0,"div")(1,"strong"),s(2),n(),s(3),n()),a&2){let e=i.$implicit;l(2),C("",e.clave,":"),l(),C(" ",e.valor)}}function Je(a,i){if(a&1&&(o(0,"tr")(1,"td",19)(2,"div",20),V(3,Ze,4,2,"div",null,M),n()()()),a&2){let e=c().$implicit;l(3),k(e.datosDinamicos)}}function Qe(a,i){if(a&1){let e=h();o(0,"tr",12),p("click",function(){let t=u(e).$implicit,d=c(2);return m(d.toggleFilaExpandida(t.citaId))}),o(1,"td",13),s(2),n(),o(3,"td",13),s(4),F(5,"date"),n(),o(6,"td",14),s(7),F(8,"titlecase"),n(),o(9,"td",13),s(10),F(11,"unidadMedida"),n(),o(12,"td",13),s(13),F(14,"unidadMedida"),n(),o(15,"td",13),s(16),F(17,"unidadMedida"),n(),o(18,"td",13),s(19),F(20,"unidadMedida"),n(),o(21,"td",13),s(22),n(),o(23,"td",13),s(24),n(),o(25,"td",13),s(26),n(),o(27,"td",15)(28,"button",16),s(29),n()(),o(30,"td",17)(31,"button",18),p("click",function(){let t=u(e).$implicit,d=c(2);return m(d.abrirPopupAcciones(t))}),s(32," Acciones "),n()()(),g(33,Je,5,0,"tr")}if(a&2){let e=i.$implicit,r=c(2);te("background-color",r.filaExpandida()===e.citaId?"rgba(46, 64, 45, 0.2)":null),l(2),A(e.citaId),l(2),C(" ",z(5,15,e.fechaHora,"short")," "),l(2),_("appColorEstado",e.estado),l(),C(" ",ie(8,18,e.estado)," "),l(3),C(" ",z(11,20,e.alturaCm,"altura")," "),l(3),C(" ",z(14,23,e.pesoKg,"peso")," "),l(3),C(" ",z(17,26,e.temperaturaC,"temperatura")," "),l(3),C(" ",z(20,29,e.presionArterial,"presion")," "),l(3),C(" ",e.pacienteNombreCompleto," "),l(2),C(" ",e.especialistaNombreCompleto," "),l(2),C(" ",e.especialidadNombre," "),l(3),C(" ",r.filaExpandida()===e.citaId?"Ocultar":"Mostrar"," "),l(4),x(r.filaExpandida()===e.citaId?33:-1)}}function Xe(a,i){if(a&1&&V(0,Qe,34,32,null,null,M),a&2){let e=c();k(e.citasFiltradas)}}function Ye(a,i){a&1&&(o(0,"tr")(1,"td",21),s(2," Cargando datos... "),n()())}var ve=class a{constructor(i,e){this.turnosService=i;this.authSupabase=e;this.usuario$=this.authSupabase.user$}usuario$;usuarioActual=null;destroy$=new X;citas=w([]);filaExpandida=w(null);cargando=w(!0);citaSeleccionada=w(null);mostrarPopupAcciones=!1;columnas=[{key:"citaId",label:"ID"},{key:"fechaHora",label:"Fecha/Hora"},{key:"estado",label:"Estado"},{key:"alturaCm",label:"Altura"},{key:"pesoKg",label:"Peso"},{key:"temperaturaC",label:"Temperatura"},{key:"presionArterial",label:"Presi\xF3n arterial"},{key:"pacienteNombreCompleto",label:"Paciente"},{key:"especialistaNombreCompleto",label:"Especialista"},{key:"especialidadNombre",label:"Especialidad"}];columnasConDatosDinamicos=[...this.columnas,{key:"datosDinamicos",label:"Datos din\xE1micos"}];_filtroValor=w("");get filtroValorModel(){return this._filtroValor()}set filtroValorModel(i){this._filtroValor.set(i)}ngOnInit(){return R(this,null,function*(){this.usuario$.pipe(Y(this.destroy$)).subscribe(i=>{if(!i){this.usuarioActual=null;return}i.id=typeof i.id=="string"?Number(i.id):i.id,this.usuarioActual=i,this.cargarCitas()})})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}cargarCitas(){return R(this,null,function*(){this.cargando.set(!0);try{if(this.usuarioActual?.id!=null){let i=yield this.turnosService.obtenerCitasEspecialista(this.usuarioActual.id);this.citas.set(i)}}catch(i){console.error("Error al obtener citas",i)}finally{this.cargando.set(!1)}})}toggleFilaExpandida(i){this.filaExpandida.set(this.filaExpandida()===i?null:i)}get citasFiltradas(){return Ce(this.citas(),this._filtroValor())}limpiarFiltro(){this._filtroValor.set("")}abrirPopupAcciones(i){this.citaSeleccionada.set(i),this.mostrarPopupAcciones=!0}cerrarPopupAcciones(){this.mostrarPopupAcciones=!1,this.citaSeleccionada.set(null)}accionDesdeModal(){this.cerrarPopupAcciones(),this.cargarCitas()}static \u0275fac=function(e){return new(e||a)(q(L),q(pe))};static \u0275cmp=P({type:a,selectors:[["app-mis-turnos-especialista"]],decls:18,vars:3,consts:[[1,"h-full","w-full","p-1"],[1,"h-full","w-full","overflow-auto","rounded-2xl","border","border-white","bg-[color:var(--color-crema)]","p-6","shadow-inner"],[1,"mb-4","flex","flex-wrap","items-center","gap-3"],["for","filtro",1,"text-sm","font-semibold","text-[color:var(--color-azul-oscuro)]"],["id","filtro","type","text","placeholder","Ingres\xE1 filtro",1,"w-64","rounded","border","border-gray-300","px-3","py-1","text-sm","focus:ring-2","focus:ring-[color:var(--color-azul-oscuro)]","focus:outline-none",3,"ngModelChange","ngModel"],["type","button",1,"rounded","bg-[color:var(--color-azul-oscuro)]","px-3","py-1","text-sm","font-semibold","text-white","shadow","transition-transform","hover:scale-105","hover:bg-[color:var(--color-azul-claro)]",3,"click"],[1,"ml-auto"],[3,"cita"],[1,"min-w-full","border-collapse","border","border-gray-300","text-sm"],[1,"bg-[color:var(--color-azul-claro)]","text-[color:var(--color-azul-oscuro)]"],[1,"border","border-gray-300","px-3","py-2"],[3,"cerrar","accionRealizada","cita"],[1,"cursor-pointer","border","border-gray-300","transition-colors","duration-150","hover:bg-[color:var(--color-verde-claro)]",3,"click"],[1,"border","border-gray-300","px-3","py-1"],[1,"rounded","border","border-gray-300","px-3","py-1","text-center","font-semibold",3,"appColorEstado"],[1,"border","border-gray-300","px-3","py-1","text-center"],["type","button",1,"text-[color:var(--color-azul-oscuro)]","underline","hover:text-[color:var(--color-azul-claro)]"],[1,"border","border-gray-300","bg-green-200","px-3","py-1","text-center","hover:bg-green-500"],["type","button",1,"font-bold","text-[color:var(--color-azul-oscuro)]","hover:text-[color:var(--color-white)]",3,"click"],["colspan","11",1,"border","border-gray-300","bg-[color:var(--color-crema)]","px-3","py-2","text-[color:var(--color-azul-oscuro)]"],[1,"grid","grid-cols-2","gap-4"],["colspan","11",1,"border","border-gray-300","px-3","py-6","text-center","font-semibold","text-[color:var(--color-azul-oscuro)]"]],template:function(e,r){e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"label",3),s(4," Filtrar: "),n(),o(5,"input",4),y("ngModelChange",function(d){return b(r.filtroValorModel,d)||(r.filtroValorModel=d),d}),n(),o(6,"button",5),p("click",function(){return r.limpiarFiltro()}),s(7," Limpiar "),n(),o(8,"div",6),g(9,Ue,1,1,"app-acciones-especialista",7),n()(),o(10,"table",8)(11,"thead")(12,"tr",9),V(13,$e,2,1,"th",10,M),n()(),o(15,"tbody"),g(16,Xe,2,0)(17,Ye,3,0,"tr"),n()()()()),e&2&&(l(5),v("ngModel",r.filtroValorModel),l(4),x(r.mostrarPopupAcciones&&r.citaSeleccionada()?9:-1),l(4),k(r.columnasConDatosDinamicos),l(3),x(r.cargando()?17:16))},dependencies:[N,j,B,W,H,G,xe,re,oe,fe],encapsulation:2})};export{ve as MisTurnosEspecialista};

import{a as ye}from"./chunk-WZDOETQ3.js";import{a as W}from"./chunk-QYWCDNK3.js";import{a as P,b as M,g as le,h as Se,i as fe,l as ce}from"./chunk-ISKSCZVY.js";import"./chunk-X5YLR3NI.js";import{b as xe}from"./chunk-4VZVLTUD.js";import{f as Ee,g as Ce}from"./chunk-ATVDQTBL.js";import"./chunk-BJZ3VNWM.js";import{g as oe,j as se}from"./chunk-EUZGYKR3.js";import{Db as T,Fb as b,Jb as C,Kb as S,Lb as y,Oa as p,Sb as be,Ta as U,Tb as r,U as he,Ub as B,Vb as j,Z as w,Za as x,ca as H,da as O,ea as q,ec as ae,fa as G,fc as re,n as ge,na as Y,nb as F,ob as k,qb as ve,rb as _e,sb as J,tb as t,ub as n,vb as E,wb as L,xb as z,yb as D,zb as X}from"./chunk-7RTQA4J5.js";import{a as Z,b as K,i as u}from"./chunk-ODN5LVDJ.js";var I=class s{obtenerLogIngresos(){return u(this,null,function*(){let{data:i,error:e}=yield P.from(M.REGISTRO_INGRESOS).select(fe.BASICO).order("fecha_ingreso",{ascending:!1});if(e||!i)return console.error("[Supabase] Error al obtener log de ingresos:",e?.message),[];let o=[...new Set(i.map(m=>m.perfil_id).filter(Boolean))],{data:a,error:l}=yield P.from(M.PERFILES).select(le.IDENTIFICACION).in("id",o);return l||!a?(console.error("[Supabase] Error al obtener perfiles:",l?.message),[]):i.map(m=>{let d=a.find(h=>h.id===m.perfil_id);return{fecha:m.fecha_ingreso,nombre:d?.nombre??"Desconocido",apellido:d?.apellido??"",rol:d?.rol??"N/A"}})})}obtenerTurnosPorEspecialidad(){return u(this,null,function*(){let{data:i,error:e}=yield P.from(M.CITAS).select("especialidad_id");if(e||!i)return console.error("[Supabase] Error al obtener turnos por especialidad:",e?.message),[];let o=[...new Set(i.map(d=>d.especialidad_id).filter(Boolean))],{data:a,error:l}=yield P.from(M.ESPECIALIDADES).select(Se.BASICO).in("id",o);if(l||!a)return console.error("[Supabase] Error al obtener especialidades:",l?.message),[];let m=new Map;for(let d of i)d.especialidad_id&&m.set(d.especialidad_id,(m.get(d.especialidad_id)??0)+1);return o.map(d=>({especialidad:a.find(g=>g.id===d)?.nombre??"Sin especialidad",cantidad:m.get(d)??0}))})}obtenerTurnosPorDia(){return u(this,null,function*(){let{data:i,error:e}=yield P.from(M.CITAS).select("fecha_hora");if(e||!i)return console.error("[Supabase] Error al obtener turnos por d\xEDa:",e?.message),[];let o=new Map;for(let a of i){let l=new Date(a.fecha_hora).toISOString().split("T")[0];o.set(l,(o.get(l)??0)+1)}return Array.from(o.entries()).map(([a,l])=>({fecha:a,cantidad:l})).sort((a,l)=>a.fecha.localeCompare(l.fecha))})}obtenerTurnosPorMedico(i,e){return u(this,null,function*(){let o=P.from(M.CITAS).select("especialista_id");i&&e&&(o=o.gte("fecha_hora",i).lte("fecha_hora",e));let{data:a,error:l}=yield o;if(l||!a)return console.error("[Supabase] Error al obtener turnos por m\xE9dico:",l?.message),[];let m=[...new Set(a.map(c=>c.especialista_id).filter(Boolean))],{data:d,error:h}=yield P.from(M.PERFILES).select(le.NOMBRE_COMPLETO).in("id",m);if(h||!d)return console.error("[Supabase] Error al obtener perfiles:",h?.message),[];let g=new Map;for(let c of a)c.especialista_id&&g.set(c.especialista_id,(g.get(c.especialista_id)??0)+1);return m.map(c=>{let _=d.find(v=>v.id===c);return{nombre:_?`${_.nombre} ${_.apellido}`:"Desconocido",cantidad:g.get(c)??0}})})}obtenerTurnosFinalizadosPorMedico(i,e){return u(this,null,function*(){let o=P.from(M.CITAS).select("especialista_id, estado").eq("estado","completado");i&&e&&(o=o.gte("fecha_hora",i).lte("fecha_hora",e));let{data:a,error:l}=yield o;if(l||!a)return console.error("[Supabase] Error al obtener turnos finalizados por m\xE9dico:",l?.message),[];let m=[...new Set(a.map(c=>c.especialista_id).filter(Boolean))],{data:d,error:h}=yield P.from(M.PERFILES).select(le.NOMBRE_COMPLETO).in("id",m);if(h||!d)return console.error("[Supabase] Error al obtener perfiles:",h?.message),[];let g=new Map;for(let c of a)c.especialista_id&&g.set(c.especialista_id,(g.get(c.especialista_id)??0)+1);return m.map(c=>{let _=d.find(v=>v.id===c);return{nombre:_?`${_.nombre} ${_.apellido}`:"Desconocido",cantidad:g.get(c)??0}})})}obtenerIngresosEspecialistas60Dias(){return u(this,null,function*(){return this.obtenerIngresosPorRol("especialista")})}obtenerIngresosPacientes60Dias(){return u(this,null,function*(){return this.obtenerIngresosPorRol("paciente")})}obtenerIngresosPorRol(i){return u(this,null,function*(){let e=new Date;e.setDate(e.getDate()-60);let o=e.toISOString(),{data:a,error:l}=yield P.from(M.REGISTRO_INGRESOS).select(fe.BASICO).gte("fecha_ingreso",o).order("fecha_ingreso",{ascending:!0});if(l||!a)return console.error(`[Supabase] Error al obtener ingresos de ${i}:`,l?.message),{datos:[],maxY:40};let m=[...new Set(a.map(f=>f.perfil_id).filter(Boolean))];if(m.length===0)return{datos:[],maxY:40};let{data:d,error:h}=yield P.from(M.PERFILES).select("id, rol").in("id",m).eq("rol",i);if(h||!d)return console.error(`[Supabase] Error al obtener perfiles de ${i}:`,h?.message),{datos:[],maxY:40};let g=new Set(d.map(f=>f.id)),c=a.filter(f=>g.has(f.perfil_id)),_=new Map;for(let f of c){let R=new Date(f.fecha_ingreso),Q=`${R.getFullYear()}-${String(R.getMonth()+1).padStart(2,"0")}-${String(R.getDate()).padStart(2,"0")}`;_.set(Q,(_.get(Q)??0)+1)}let v=Array.from(_.entries()).map(([f,R])=>({fecha_hora:f,cantidad:R})),A=Math.max(...v.map(f=>f.cantidad),0),V=A===0?40:Math.ceil((A+1)/5)*5;return{datos:v,maxY:V}})}static \u0275fac=function(e){return new(e||s)};static \u0275prov=he({token:s,factory:s.\u0275fac,providedIn:"root"})};var Pe=["canvas"],ee=class s{estadisticas=w(I);canvasRef;ngAfterViewInit(){return u(this,null,function*(){let{Chart:i,BarElement:e,BarController:o,CategoryScale:a,LinearScale:l,Tooltip:m,Legend:d}=yield import("./chunk-MBHQL6GC.js");i.register(e,o,a,l,m,d);let h=this.canvasRef.nativeElement,g=yield this.estadisticas.obtenerTurnosPorDia(),c=g.map(v=>v.fecha),_=g.map(v=>v.cantidad);new i(h,{type:"bar",data:{labels:c,datasets:[{label:"Turnos por D\xEDa",data:_,backgroundColor:"rgba(54, 162, 235, 0.7)"}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{stepSize:1,precision:0}}}}})})}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=x({type:s,selectors:[["app-turnos-por-dia-chart"]],viewQuery:function(e,o){if(e&1&&C(Pe,7),e&2){let a;S(a=y())&&(o.canvasRef=a.first)}},decls:2,vars:0,consts:[["canvas",""],[1,"mx-auto","h-64","w-full"]],template:function(e,o){e&1&&D(0,"canvas",1,0)},encapsulation:2})};var Me=["canvas"],te=class s{estadisticas=w(I);chart;canvasRef;ngAfterViewInit(){this.render()}render(){return u(this,null,function*(){let{Chart:i,ArcElement:e,PieController:o,Tooltip:a,Legend:l}=yield import("./chunk-MBHQL6GC.js");i.register(e,o,a,l);let m=yield this.estadisticas.obtenerTurnosPorEspecialidad(),d=m.map(c=>c.especialidad),h=m.map(c=>c.cantidad),g=this.canvasRef.nativeElement;this.chart?.destroy(),this.chart=new i(g,{type:"pie",data:{labels:d,datasets:[{label:"Turnos por Especialidad",data:h,backgroundColor:["rgba(255, 99, 132, 0.7)","rgba(54, 162, 235, 0.7)","rgba(255, 206, 86, 0.7)","rgba(75, 192, 192, 0.7)","rgba(153, 102, 255, 0.7)","rgba(255, 159, 64, 0.7)"],borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1}})})}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=x({type:s,selectors:[["app-turnos-por-especialidad-chart"]],viewQuery:function(e,o){if(e&1&&C(Me,7),e&2){let a;S(a=y())&&(o.canvasRef=a.first)}},decls:3,vars:0,consts:[["canvas",""],[1,"relative","h-64","w-full"],[1,"absolute","inset-0","h-full","w-full"]],template:function(e,o){e&1&&(L(0,"div",1),D(1,"canvas",2,0),z())},encapsulation:2})};var Ie=["canvas"],ie=class s{estadisticas=w(I);chart;canvasRef;render(i,e){return u(this,null,function*(){let{Chart:o,BarElement:a,BarController:l,CategoryScale:m,LinearScale:d,Tooltip:h,Legend:g}=yield import("./chunk-MBHQL6GC.js");o.register(a,l,m,d,h,g);let c=yield this.estadisticas.obtenerTurnosPorMedico(i,e),_=c.map(V=>V.nombre),v=c.map(V=>V.cantidad),A=this.canvasRef.nativeElement;this.chart?.destroy(),this.chart=new o(A,{type:"bar",data:{labels:_,datasets:[{label:"Turnos por M\xE9dico",data:v,backgroundColor:"rgba(75, 192, 192, 0.7)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{stepSize:1,precision:0}}}}})})}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=x({type:s,selectors:[["app-turnos-por-medico-chart"]],viewQuery:function(e,o){if(e&1&&C(Ie,7),e&2){let a;S(a=y())&&(o.canvasRef=a.first)}},decls:3,vars:0,consts:[["canvas",""],[1,"relative","h-64","w-full"],[1,"absolute","inset-0","h-full","w-full"]],template:function(e,o){e&1&&(L(0,"div",1),D(1,"canvas",2,0),z())},encapsulation:2})};var Ae=["canvas"],ne=class s{estadisticas=w(I);chart;canvasRef;render(i,e){return u(this,null,function*(){let{Chart:o,BarElement:a,BarController:l,CategoryScale:m,LinearScale:d,Tooltip:h,Legend:g}=yield import("./chunk-MBHQL6GC.js");o.register(a,l,m,d,h,g);let c=yield this.estadisticas.obtenerTurnosFinalizadosPorMedico(i,e),_=c.map(A=>A.nombre),v=c.map(A=>A.cantidad);this.chart?.destroy(),this.chart=new o(this.canvasRef.nativeElement,{type:"bar",data:{labels:_,datasets:[{label:"Turnos Finalizados por M\xE9dico",data:v,backgroundColor:"rgba(153, 102, 255, 0.7)",borderColor:"rgba(153, 102, 255, 1)",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{stepSize:1,precision:0}}}}})})}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=x({type:s,selectors:[["app-turnos-finalizados-por-medico-chart"]],viewQuery:function(e,o){if(e&1&&C(Ae,7),e&2){let a;S(a=y())&&(o.canvasRef=a.first)}},decls:3,vars:0,consts:[["canvas",""],[1,"relative","h-64","w-full"],[1,"absolute","inset-0","h-full","w-full"]],template:function(e,o){e&1&&(L(0,"div",1),D(1,"canvas",2,0),z())},encapsulation:2})};var De=["canvas"],de=class s{estadisticas=w(I);chart;canvasRef;ngAfterViewInit(){this.render()}render(){return u(this,null,function*(){let{Chart:i,LineElement:e,LineController:o,PointElement:a,CategoryScale:l,LinearScale:m,Tooltip:d,Legend:h,Filler:g}=yield import("./chunk-MBHQL6GC.js");i.register(e,o,a,l,m,d,h,g);let{datos:c,maxY:_}=yield this.estadisticas.obtenerIngresosEspecialistas60Dias(),v=c.map(f=>f.fecha_hora),A=c.map(f=>f.cantidad),V=this.canvasRef.nativeElement;this.chart?.destroy(),this.chart=new i(V,{type:"line",data:{labels:v,datasets:[{label:"Ingresos de Especialistas (\xFAltimos 60 d\xEDas)",data:A,borderColor:"rgba(54, 162, 235, 1)",backgroundColor:"rgba(54, 162, 235, 0.1)",borderWidth:2,fill:!0,tension:.4,pointRadius:2,pointHoverRadius:5}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,max:_,ticks:{stepSize:5,precision:0}},x:{ticks:{maxTicksLimit:20,callback:function(f,R){let Q=v[R];return Q&&R%Math.ceil(v.length/20)===0?Q:""}}}},plugins:{tooltip:{callbacks:{title:function(f){return f[0].label||""}}}}}})})}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=x({type:s,selectors:[["app-ingresos-especialistas-chart"]],viewQuery:function(e,o){if(e&1&&C(De,7),e&2){let a;S(a=y())&&(o.canvasRef=a.first)}},decls:3,vars:0,consts:[["canvas",""],[1,"relative","h-80","w-full"],[1,"absolute","inset-0","h-full","w-full"]],template:function(e,o){e&1&&(L(0,"div",1),D(1,"canvas",2,0),z())},encapsulation:2})};var Re=["canvas"],me=class s{estadisticas=w(I);chart;canvasRef;ngAfterViewInit(){this.render()}render(){return u(this,null,function*(){let{Chart:i,LineElement:e,LineController:o,PointElement:a,CategoryScale:l,LinearScale:m,Tooltip:d,Legend:h,Filler:g}=yield import("./chunk-MBHQL6GC.js");i.register(e,o,a,l,m,d,h,g);let{datos:c,maxY:_}=yield this.estadisticas.obtenerIngresosPacientes60Dias(),v=c.map(f=>f.fecha_hora),A=c.map(f=>f.cantidad),V=this.canvasRef.nativeElement;this.chart?.destroy(),this.chart=new i(V,{type:"line",data:{labels:v,datasets:[{label:"Ingresos de Pacientes (\xFAltimos 60 d\xEDas)",data:A,borderColor:"rgba(75, 192, 192, 1)",backgroundColor:"rgba(75, 192, 192, 0.1)",borderWidth:2,fill:!0,tension:.4,pointRadius:2,pointHoverRadius:5}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,max:_,ticks:{stepSize:5,precision:0}},x:{ticks:{maxTicksLimit:20,callback:function(f,R){let Q=v[R];return Q&&R%Math.ceil(v.length/20)===0?Q:""}}}},plugins:{tooltip:{callbacks:{title:function(f){return f[0].label||""}}}}}})})}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=x({type:s,selectors:[["app-ingresos-pacientes-chart"]],viewQuery:function(e,o){if(e&1&&C(Re,7),e&2){let a;S(a=y())&&(o.canvasRef=a.first)}},decls:3,vars:0,consts:[["canvas",""],[1,"relative","h-80","w-full"],[1,"absolute","inset-0","h-full","w-full"]],template:function(e,o){e&1&&(L(0,"div",1),D(1,"canvas",2,0),z())},encapsulation:2})};var ue=class s{loading=w(W);rangoTurnosPorMedico=Y({desde:"2024-01-01",hasta:"2027-01-01"});rangoTurnosFinalizados=Y({desde:"2024-01-01",hasta:"2027-01-01"});turnosPorDiaChart;turnosPorEspecialidadChart;turnosPorMedicoChart;turnosFinalizadosChart;ngAfterViewInit(){this.cargarDatos()}cargarDatos(){return u(this,null,function*(){this.loading.show();try{yield Promise.all([this.cargarTurnosPorMedico(),this.cargarTurnosFinalizados()])}finally{this.loading.hide()}})}cargarTurnosPorMedico(){return u(this,null,function*(){let{desde:i,hasta:e}=this.rangoTurnosPorMedico();yield this.turnosPorMedicoChart?.render(i,e)})}cargarTurnosFinalizados(){return u(this,null,function*(){let{desde:i,hasta:e}=this.rangoTurnosFinalizados();yield this.turnosFinalizadosChart?.render(i,e)})}onDesdeTurnosMedicoChange(i){let e=i.target;this.rangoTurnosPorMedico.set(K(Z({},this.rangoTurnosPorMedico()),{desde:e.value}))}onHastaTurnosMedicoChange(i){let e=i.target;this.rangoTurnosPorMedico.set(K(Z({},this.rangoTurnosPorMedico()),{hasta:e.value}))}onAplicarTurnosMedico(){return u(this,null,function*(){this.loading.show();try{yield this.cargarTurnosPorMedico()}finally{this.loading.hide()}})}onDesdeTurnosFinalizadosChange(i){let e=i.target;this.rangoTurnosFinalizados.set(K(Z({},this.rangoTurnosFinalizados()),{desde:e.value}))}onHastaTurnosFinalizadosChange(i){let e=i.target;this.rangoTurnosFinalizados.set(K(Z({},this.rangoTurnosFinalizados()),{hasta:e.value}))}onAplicarTurnosFinalizados(){return u(this,null,function*(){this.loading.show();try{yield this.cargarTurnosFinalizados()}finally{this.loading.hide()}})}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=x({type:s,selectors:[["app-home"]],viewQuery:function(e,o){if(e&1&&(C(ee,5),C(te,5),C(ie,5),C(ne,5)),e&2){let a;S(a=y())&&(o.turnosPorDiaChart=a.first),S(a=y())&&(o.turnosPorEspecialidadChart=a.first),S(a=y())&&(o.turnosPorMedicoChart=a.first),S(a=y())&&(o.turnosFinalizadosChart=a.first)}},decls:102,vars:4,consts:[[1,"h-full","w-full","p-1"],[1,"h-full","w-full","overflow-auto","rounded-2xl","border","border-white","bg-crema","p-6","shadow-inner"],[1,"mb-8"],[1,"mb-2","text-4xl","font-bold","text-azul-oscuro"],[1,"text-gray-600"],[1,"grid","gap-6","lg:grid-cols-2"],[1,"rounded-xl","bg-white","p-6","shadow-lg","transition-all","hover:shadow-xl"],[1,"mb-4","flex","items-center","gap-3"],[1,"rounded-lg","bg-blue-100","p-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"text-xl","font-semibold","text-gray-800"],[1,"text-sm","text-gray-500"],[1,"rounded-lg","bg-gray-50","p-4"],[1,"rounded-lg","bg-purple-100","p-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-purple-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"],[1,"rounded-xl","bg-white","p-6","shadow-lg","transition-all","hover:shadow-xl","lg:col-span-2"],[1,"rounded-lg","bg-teal-100","p-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-teal-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"],[1,"flex-1"],[1,"mb-4","flex","flex-wrap","items-center","gap-4","rounded-lg","bg-gray-50","p-4"],[1,"flex","items-center","gap-2"],[1,"text-sm","font-medium","text-gray-700"],["type","date",1,"focus:ring-opacity-50","rounded-lg","border","border-gray-300","px-3","py-2","text-sm","shadow-sm","focus:border-azul-oscuro","focus:ring-2","focus:ring-azul-oscuro","focus:outline-none",3,"change","value"],[1,"ml-auto","rounded-lg","bg-azul-oscuro","px-6","py-2","text-sm","font-medium","text-white","shadow-md","transition-all","hover:bg-azul-claro","hover:shadow-lg","active:scale-95",3,"click"],[1,"rounded-lg","bg-green-100","p-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"rounded-lg","bg-indigo-100","p-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-indigo-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"],[1,"rounded-lg","bg-cyan-100","p-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-cyan-600"]],template:function(e,o){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),r(4," Panel de Estad\xEDsticas "),n(),t(5,"p",4),r(6," An\xE1lisis y m\xE9tricas del sistema en tiempo real "),n()(),t(7,"div",5)(8,"section",6)(9,"div",7)(10,"div",8),q(),t(11,"svg",9),E(12,"path",10),n()(),G(),t(13,"div")(14,"h3",11),r(15,"Turnos por D\xEDa"),n(),t(16,"p",12),r(17,"Distribuci\xF3n diaria de turnos"),n()()(),t(18,"div",13),E(19,"app-turnos-por-dia-chart"),n()(),t(20,"section",6)(21,"div",7)(22,"div",14),q(),t(23,"svg",15),E(24,"path",16),n()(),G(),t(25,"div")(26,"h3",11),r(27," Turnos por Especialidad "),n(),t(28,"p",12),r(29,"Distribuci\xF3n por \xE1rea m\xE9dica"),n()()(),t(30,"div",13),E(31,"app-turnos-por-especialidad-chart"),n()(),t(32,"section",17)(33,"div",7)(34,"div",18),q(),t(35,"svg",19),E(36,"path",20),n()(),G(),t(37,"div",21)(38,"h3",11),r(39," Turnos por M\xE9dico "),n(),t(40,"p",12),r(41," Carga de trabajo por profesional "),n()()(),t(42,"div",22)(43,"label",23)(44,"span",24),r(45,"Desde:"),n(),t(46,"input",25),T("change",function(l){return o.onDesdeTurnosMedicoChange(l)}),n()(),t(47,"label",23)(48,"span",24),r(49,"Hasta:"),n(),t(50,"input",25),T("change",function(l){return o.onHastaTurnosMedicoChange(l)}),n()(),t(51,"button",26),T("click",function(){return o.onAplicarTurnosMedico()}),r(52," Aplicar Filtro "),n()(),t(53,"div",13),E(54,"app-turnos-por-medico-chart"),n()(),t(55,"section",17)(56,"div",7)(57,"div",27),q(),t(58,"svg",28),E(59,"path",29),n()(),G(),t(60,"div",21)(61,"h3",11),r(62," Turnos Finalizados por M\xE9dico "),n(),t(63,"p",12),r(64," Consultas completadas exitosamente "),n()()(),t(65,"div",22)(66,"label",23)(67,"span",24),r(68,"Desde:"),n(),t(69,"input",25),T("change",function(l){return o.onDesdeTurnosFinalizadosChange(l)}),n()(),t(70,"label",23)(71,"span",24),r(72,"Hasta:"),n(),t(73,"input",25),T("change",function(l){return o.onHastaTurnosFinalizadosChange(l)}),n()(),t(74,"button",26),T("click",function(){return o.onAplicarTurnosFinalizados()}),r(75," Aplicar Filtro "),n()(),t(76,"div",13),E(77,"app-turnos-finalizados-por-medico-chart"),n()(),t(78,"section",6)(79,"div",7)(80,"div",30),q(),t(81,"svg",31),E(82,"path",32),n()(),G(),t(83,"div")(84,"h3",11),r(85," Ingresos - Especialistas "),n(),t(86,"p",12),r(87,"\xDAltimos 60 d\xEDas (por d\xEDa)"),n()()(),t(88,"div",13),E(89,"app-ingresos-especialistas-chart"),n()(),t(90,"section",6)(91,"div",7)(92,"div",33),q(),t(93,"svg",34),E(94,"path",32),n()(),G(),t(95,"div")(96,"h3",11),r(97," Ingresos - Pacientes "),n(),t(98,"p",12),r(99,"\xDAltimos 60 d\xEDas (por d\xEDa)"),n()()(),t(100,"div",13),E(101,"app-ingresos-pacientes-chart"),n()()()()()),e&2&&(p(46),J("value",o.rangoTurnosPorMedico().desde),p(4),J("value",o.rangoTurnosPorMedico().hasta),p(19),J("value",o.rangoTurnosFinalizados().desde),p(4),J("value",o.rangoTurnosFinalizados().hasta))},dependencies:[ee,te,ie,ne,de,me],encapsulation:2})};var Le=(s,i)=>i.citaId;function ze(s,i){s&1&&(t(0,"div",5)(1,"div",7),E(2,"div",8),t(3,"p",4),r(4,"Cargando informaci\xF3n..."),n()()())}function Ve(s,i){if(s&1){let e=X();t(0,"button",38),T("click",function(){H(e);let a=b(4);return O(a.navegarA("solicitar-turnos"))}),r(1," Solicitar un turno "),n()}}function He(s,i){if(s&1&&(t(0,"div",21)(1,"mat-icon",35),r(2,"event_busy"),n(),t(3,"p",36),r(4),n(),F(5,Ve,2,0,"button",37),n()),s&2){let e=b(2);p(4),j(" ",e.rol==="paciente"?"No tienes turnos programados":"No tienes turnos pendientes"," "),p(),k(e.rol==="paciente"?5:-1)}}function Oe(s,i){if(s&1&&(t(0,"mat-icon",36),r(1,"person"),n(),t(2,"span"),r(3),n()),s&2){let e=b().$implicit;p(3),B(e.especialistaNombreCompleto)}}function Ne(s,i){if(s&1&&(t(0,"mat-icon",36),r(1,"person"),n(),t(2,"span"),r(3),n()),s&2){let e=b().$implicit;p(3),B(e.pacienteNombreCompleto)}}function Qe(s,i){if(s&1){let e=X();t(0,"div",39)(1,"div",40)(2,"div",41)(3,"div",42)(4,"span",43),r(5),n(),t(6,"span",44),r(7),n()(),t(8,"div",45)(9,"mat-icon",36),r(10,"calendar_today"),n(),t(11,"span",46),r(12),n()(),t(13,"div",47)(14,"mat-icon",36),r(15,"schedule"),n(),t(16,"span"),r(17),n(),t(18,"span",48),r(19,"\u2022"),n(),F(20,Oe,4,1)(21,Ne,4,1),n()(),t(22,"button",49),T("click",function(){H(e);let a=b(3),l=b();return O(l.navegarA(a.rol==="paciente"?"mis-turnos-paciente":"mis-turnos-especialista"))}),r(23," Ver Detalles "),n()()()}if(s&2){let e=i.$implicit,o=b(3),a=b();p(4),be(a.getEstadoClase(e.estado)),p(),j(" ",e.estado.charAt(0).toUpperCase()+e.estado.slice(1)," "),p(2),j(" ",e.especialidadNombre," "),p(5),j(" ",a.formatearFecha(e.fechaHora)," "),p(5),B(a.formatearHora(e.fechaHora)),p(3),k(o.rol==="paciente"?20:21)}}function Be(s,i){if(s&1&&(t(0,"div",22),ve(1,Qe,24,7,"div",39,Le),n()),s&2){let e=b(3);p(),_e(e.proximosTurnos())}}function je(s,i){if(s&1){let e=X();t(0,"button",50),T("click",function(){H(e);let a=b(3);return O(a.navegarA("solicitar-turnos"))}),t(1,"mat-icon",12),r(2,"add_circle"),n(),t(3,"div",51)(4,"p",52),r(5,"Solicitar Turno"),n(),t(6,"p",53),r(7,"Agenda una nueva cita"),n()()(),t(8,"button",50),T("click",function(){H(e);let a=b(3);return O(a.navegarA("mis-turnos-paciente"))}),t(9,"mat-icon",12),r(10,"list_alt"),n(),t(11,"div",51)(12,"p",52),r(13,"Mis Turnos"),n(),t(14,"p",53),r(15,"Ver historial completo"),n()()(),t(16,"button",50),T("click",function(){H(e);let a=b(3);return O(a.navegarA("perfil-paciente"))}),t(17,"mat-icon",12),r(18,"account_circle"),n(),t(19,"div",51)(20,"p",52),r(21,"Mi Perfil"),n(),t(22,"p",53),r(23,"Editar informaci\xF3n"),n()()()}}function $e(s,i){if(s&1){let e=X();t(0,"button",50),T("click",function(){H(e);let a=b(3);return O(a.navegarA("mis-turnos-especialista"))}),t(1,"mat-icon",12),r(2,"event_note"),n(),t(3,"div",51)(4,"p",52),r(5,"Mis Turnos"),n(),t(6,"p",53),r(7,"Ver agenda completa"),n()()(),t(8,"button",50),T("click",function(){H(e);let a=b(3);return O(a.navegarA("pacientes"))}),t(9,"mat-icon",12),r(10,"people"),n(),t(11,"div",51)(12,"p",52),r(13,"Mis Pacientes"),n(),t(14,"p",53),r(15,"Ver historial cl\xEDnico"),n()()(),t(16,"button",50),T("click",function(){H(e);let a=b(3);return O(a.navegarA("perfil-especialista"))}),t(17,"mat-icon",12),r(18,"account_circle"),n(),t(19,"div",51)(20,"p",52),r(21,"Mi Perfil"),n(),t(22,"p",53),r(23,"Configurar horarios"),n()()()}}function qe(s,i){s&1&&(t(0,"li",54)(1,"mat-icon",55),r(2,"check_circle"),n(),t(3,"span"),r(4,"Record\xE1 confirmar tus turnos con 24hs de anticipaci\xF3n"),n()(),t(5,"li",54)(6,"mat-icon",55),r(7,"check_circle"),n(),t(8,"span"),r(9,"Pod\xE9s cancelar turnos hasta 12hs antes"),n()(),t(10,"li",54)(11,"mat-icon",55),r(12,"check_circle"),n(),t(13,"span"),r(14,"No olvides completar las encuestas de satisfacci\xF3n"),n()())}function Ge(s,i){s&1&&(t(0,"li",54)(1,"mat-icon",55),r(2,"check_circle"),n(),t(3,"span"),r(4,"Revis\xE1 tu agenda diariamente"),n()(),t(5,"li",54)(6,"mat-icon",55),r(7,"check_circle"),n(),t(8,"span"),r(9,"Complet\xE1 el registro m\xE9dico de cada consulta"),n()(),t(10,"li",54)(11,"mat-icon",55),r(12,"check_circle"),n(),t(13,"span"),r(14,"Manten\xE9 actualizada tu disponibilidad horaria"),n()())}function Ye(s,i){if(s&1&&(t(0,"div",6)(1,"div",9)(2,"div",10)(3,"div",11)(4,"mat-icon",12),r(5,"event_available"),n(),t(6,"span",13),r(7),n()(),t(8,"p",14),r(9),n()(),t(10,"div",15)(11,"div",11)(12,"mat-icon",12),r(13,"today"),n(),t(14,"span",13),r(15),n()(),t(16,"p",14),r(17,"Turnos Hoy"),n()(),t(18,"div",16)(19,"div",11)(20,"mat-icon",12),r(21,"calendar_month"),n(),t(22,"span",13),r(23),n()(),t(24,"p",14),r(25),n()()(),t(26,"div",17)(27,"div",18)(28,"h2",19)(29,"mat-icon",20),r(30,"event_note"),n(),r(31," Pr\xF3ximos Turnos "),n()(),F(32,He,6,2,"div",21)(33,Be,3,0,"div",22),n(),t(34,"div",17)(35,"h2",23)(36,"mat-icon",20),r(37,"flash_on"),n(),r(38," Acciones R\xE1pidas "),n(),t(39,"div",9),F(40,je,24,0)(41,$e,24,0),n()(),t(42,"div",24)(43,"div",25)(44,"div",26)(45,"mat-icon",27),r(46,"info"),n(),t(47,"h3",28),r(48," Informaci\xF3n Importante "),n()(),t(49,"ul",29),F(50,qe,15,0)(51,Ge,15,0),n()(),t(52,"div",30)(53,"div",26)(54,"mat-icon",31),r(55,"contact_support"),n(),t(56,"h3",28),r(57," \xBFNecesit\xE1s Ayuda? "),n()(),t(58,"p",32),r(59," Nuestro equipo est\xE1 disponible para asistirte con cualquier consulta o inconveniente. "),n(),t(60,"div",29)(61,"div",33)(62,"mat-icon",34),r(63,"email"),n(),t(64,"span"),r(65,"soporte@clinica.com"),n()(),t(66,"div",33)(67,"mat-icon",34),r(68,"phone"),n(),t(69,"span"),r(70,"0800-123-4567"),n()()()()()()),s&2){let e=b(),o=b();p(7),B(o.resumen().turnosPendientes),p(2),j(" ",e.rol==="paciente"?"Turnos Pendientes":"Turnos por Atender"," "),p(6),B(o.resumen().turnosHoy),p(8),B(o.resumen().turnosMes),p(2),j(" ",e.rol==="paciente"?"Turnos Este Mes":"Atendidos Este Mes"," "),p(7),k(o.proximosTurnos().length===0?32:33),p(8),k(e.rol==="paciente"?40:e.rol==="especialista"?41:-1),p(10),k(e.rol==="paciente"?50:51)}}function Ue(s,i){if(s&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),r(4),n(),t(5,"p",4),r(6),n()(),F(7,ze,5,0,"div",5)(8,Ye,71,8,"div",6),n()()),s&2){let e=b();p(4),j(" \xA1Bienvenido/a, ",i.nombre,"! "),p(2),B(e.getFechaActual()),p(),k(e.cargando()?7:8)}}var pe=class s{constructor(i,e,o,a){this.authSupabase=i;this.turnosService=e;this.router=o;this.loading=a;this.usuario$=this.authSupabase.user$}usuario$;usuarioActual=null;realtimeChannel;proximosTurnos=Y([]);resumen=Y({turnosPendientes:0,turnosHoy:0,turnosMes:0});cargando=Y(!0);ngOnInit(){return u(this,null,function*(){this.usuarioActual=yield ge(this.usuario$),this.usuarioActual&&(yield this.cargarDatos(),this.suscribirseACambiosCitas())})}ngOnDestroy(){this.realtimeChannel&&P.removeChannel(this.realtimeChannel)}suscribirseACambiosCitas(){if(!this.usuarioActual?.id)return;let i=this.usuarioActual.id,e=this.usuarioActual.rol;this.realtimeChannel=P.channel("citas-changes").on("postgres_changes",{event:"*",schema:"public",table:M.CITAS,filter:e==="paciente"?`paciente_id=eq.${i}`:`especialista_id=eq.${i}`},()=>{this.cargarDatos()}).subscribe()}cargarDatos(){return u(this,null,function*(){if(this.usuarioActual?.id){this.cargando.set(!0);try{let i=[];this.usuarioActual.rol==="paciente"?i=yield this.turnosService.obtenerCitasPaciente(this.usuarioActual.id):this.usuarioActual.rol==="especialista"&&(i=yield this.turnosService.obtenerCitasEspecialista(this.usuarioActual.id)),this.proximosTurnos.set(this.turnosService.obtenerProximosTurnos(i,3));let e=this.turnosService.calcularResumenActividad(i);this.resumen.set({turnosPendientes:e.turnosPendientes,turnosHoy:e.turnosHoy,turnosMes:e.turnosMes})}catch(i){console.error("Error al cargar datos:",i)}finally{this.cargando.set(!1)}}})}formatearFecha(i){return new Date(i).toLocaleDateString("es-AR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}getFechaActual(){return new Date().toLocaleDateString("es-AR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}formatearHora(i){return new Date(i).toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit"})}getEstadoClase(i){return{solicitado:"bg-yellow-100 text-yellow-800",aceptado:"bg-green-100 text-green-800",rechazado:"bg-red-100 text-red-800",cancelado:"bg-gray-100 text-gray-800",realizado:"bg-blue-100 text-blue-800",completado:"bg-blue-100 text-blue-800"}[i]||"bg-gray-100 text-gray-800"}navegarA(i){i!=="mis-turnos-especialista"&&i!=="pacientes"&&i!=="mis-turnos-paciente"&&this.loading.show();let e=`/home/${i}`;if(this.router.url===e){i!=="mis-turnos-especialista"&&this.loading.hide();return}this.router.navigate([e])}static \u0275fac=function(e){return new(e||s)(U(ce),U(ye),U(xe),U(W))};static \u0275cmp=x({type:s,selectors:[["app-entrada"]],decls:2,vars:3,consts:[[1,"h-full","w-full","p-1"],[1,"h-full","w-full","overflow-auto","rounded-2xl","border","border-white","bg-crema","p-6","shadow-inner"],[1,"mb-6"],[1,"mb-2","text-3xl","font-bold","text-azul-oscuro"],[1,"text-gray-600"],[1,"flex","items-center","justify-center","py-12"],[1,"mx-auto","max-w-6xl","space-y-6"],[1,"text-center"],[1,"mx-auto","mb-4","h-12","w-12","animate-spin","rounded-full","border-4","border-azul-oscuro","border-t-transparent"],[1,"grid","grid-cols-1","gap-4","md:grid-cols-2","lg:grid-cols-3"],[1,"rounded-lg","bg-gradient-to-br","from-blue-500","to-blue-600","p-4","text-white","shadow-md","transition-transform","hover:scale-105"],[1,"mb-2","flex","items-center","justify-between"],[1,"text-3xl"],[1,"text-3xl","font-bold"],[1,"text-sm","font-medium"],[1,"rounded-lg","bg-gradient-to-br","from-green-500","to-green-600","p-4","text-white","shadow-md","transition-transform","hover:scale-105"],[1,"rounded-lg","bg-gradient-to-br","from-purple-500","to-purple-600","p-4","text-white","shadow-md","transition-transform","hover:scale-105"],[1,"rounded-lg","bg-white","p-6","shadow-md"],[1,"mb-4","flex","items-center","justify-between"],[1,"text-2xl","font-semibold","text-azul-oscuro"],[1,"mr-2","align-middle"],[1,"py-8","text-center","text-gray-500"],[1,"space-y-3"],[1,"mb-4","text-2xl","font-semibold","text-azul-oscuro"],[1,"grid","grid-cols-1","gap-4","md:grid-cols-2"],[1,"rounded-lg","bg-blue-50","p-6","shadow-md"],[1,"mb-3","flex","items-center","gap-2"],[1,"text-2xl","text-blue-600"],[1,"text-lg","font-semibold","text-azul-oscuro"],[1,"space-y-2","text-sm","text-gray-700"],[1,"rounded-lg","bg-green-50","p-6","shadow-md"],[1,"text-2xl","text-green-600"],[1,"mb-3","text-sm","text-gray-700"],[1,"flex","items-center","gap-2"],[1,"text-sm","text-green-600"],[1,"mb-2","text-5xl","text-gray-300"],[1,"text-lg"],[1,"mt-4","rounded-lg","bg-azul-oscuro","px-6","py-2","font-medium","text-white","transition-colors","hover:bg-blue-700"],[1,"mt-4","rounded-lg","bg-azul-oscuro","px-6","py-2","font-medium","text-white","transition-colors","hover:bg-blue-700",3,"click"],[1,"rounded-lg","border","border-gray-200","bg-gray-50","p-4","transition-shadow","hover:shadow-md"],[1,"flex","items-start","justify-between"],[1,"flex-1"],[1,"mb-2","flex","items-center","gap-3"],[1,"rounded-full","px-3","py-1","text-xs","font-semibold"],[1,"text-sm","font-medium","text-gray-700"],[1,"mb-2","flex","items-center","gap-2","text-gray-700"],[1,"font-medium"],[1,"flex","items-center","gap-2","text-gray-600"],[1,"mx-2"],[1,"rounded-lg","bg-azul-oscuro","px-4","py-2","text-sm","font-medium","text-white","transition-colors","hover:bg-blue-700",3,"click"],[1,"flex","items-center","gap-3","rounded-lg","border-2","border-azul-oscuro","bg-white","p-4","transition-all","hover:bg-azul-oscuro","hover:text-white",3,"click"],[1,"text-left"],[1,"font-semibold"],[1,"text-sm","opacity-75"],[1,"flex","items-start","gap-2"],[1,"text-sm","text-blue-600"]],template:function(e,o){if(e&1&&(F(0,Ue,9,3,"div",0),ae(1,"async")),e&2){let a;k((a=re(1,1,o.usuario$))?0:-1,a)}},dependencies:[se,Ce,Ee,oe],encapsulation:2})};function We(s,i){s&1&&E(0,"app-home")}function Ze(s,i){s&1&&E(0,"app-entrada")}function Ke(s,i){s&1&&F(0,We,1,0,"app-home")(1,Ze,1,0,"app-entrada"),s&2&&k(i.rol==="admin"?0:1)}var we=class s{constructor(i){this.authSupabase=i;this.usuario$=this.authSupabase.user$}usuario$;loading=w(W);ngAfterViewInit(){setTimeout(()=>{this.loading.hide()},0)}static \u0275fac=function(e){return new(e||s)(U(ce))};static \u0275cmp=x({type:s,selectors:[["app-home-router"]],decls:2,vars:3,template:function(e,o){if(e&1&&(F(0,Ke,2,1),ae(1,"async")),e&2){let a;k((a=re(1,1,o.usuario$))?0:-1,a)}},dependencies:[se,ue,pe,oe],encapsulation:2})};export{we as HomeRouter};

import{a as Ee,b as he,c as Ae,d as Se}from"./chunk-6622NN6A.js";import"./chunk-IBKYDQVC.js";import{a as _e,b as fe,f as ge,i as ve,j as xe,k as be}from"./chunk-U6JYIE4V.js";import{f as ce,g as pe,n as ue}from"./chunk-AE2NBSWY.js";import{a as D,b as I,c as O}from"./chunk-FGWPXEB7.js";import{a as M}from"./chunk-HKXNSF3N.js";import"./chunk-LJ5XHLMQ.js";import"./chunk-ICKPCRNS.js";import{b as te,c,e as ie,f as re,i as ae,j as oe,k as ne,l as le,r as se,s as me,t as de}from"./chunk-MWZLYR54.js";import{e as ee}from"./chunk-MGZ6HB6D.js";import"./chunk-EPDCLEQZ.js";import{e as Y,f as U,g as P,j as k}from"./chunk-DDJZ7MLA.js";import{$a as z,Fb as C,Hb as l,Ib as V,Ja as w,Jb as v,Ka as n,Kb as T,Pa as S,T as Q,Ua as F,X,Za as p,ba as b,ca as E,f as K,mb as m,nb as r,ob as a,pb as h,qb as y,sb as f,tb as _}from"./chunk-GQUYXPDO.js";import{h as x}from"./chunk-FK42CRUA.js";function Te(i,t){if(i&1){let e=y();r(0,"div",5)(1,"p",6),l(2,"Seleccionar tipo usuario para alta"),a(),r(3,"div",7)(4,"button",8),f("click",function(){b(e);let s=_();return E(s.seleccionarTipo("paciente"))}),r(5,"span",9),l(6,"Paciente"),a()(),r(7,"button",8),f("click",function(){b(e);let s=_();return E(s.seleccionarTipo("especialista"))}),r(8,"span",9),l(9,"Especialista"),a()(),r(10,"button",8),f("click",function(){b(e);let s=_();return E(s.seleccionarTipo("admin"))}),r(11,"span",9),l(12,"Admin"),a()()()()}}function Ue(i,t){i&1&&(r(0,"mat-error"),l(1," Campo obligatorio "),a())}function Pe(i,t){i&1&&(r(0,"mat-error"),l(1," M\xEDnimo 2 caracteres "),a())}function ke(i,t){i&1&&(r(0,"mat-error"),l(1," Solo letras "),a())}function Oe(i,t){i&1&&(r(0,"mat-error"),l(1," Campo obligatorio "),a())}function Me(i,t){i&1&&(r(0,"mat-error"),l(1," M\xEDnimo 2 caracteres "),a())}function Ne(i,t){i&1&&(r(0,"mat-error"),l(1," Solo letras "),a())}function Re(i,t){i&1&&(r(0,"mat-error"),l(1," Campo obligatorio "),a())}function ze(i,t){i&1&&(r(0,"mat-error"),l(1," M\xEDnimo 18 "),a())}function De(i,t){i&1&&(r(0,"mat-error"),l(1," M\xE1ximo 99 "),a())}function qe(i,t){i&1&&(r(0,"mat-error"),l(1," Campo obligatorio "),a())}function je(i,t){i&1&&(r(0,"mat-error"),l(1," Debe contener 8 d\xEDgitos "),a())}function Le(i,t){if(i&1&&(r(0,"mat-option",30),l(1),a()),i&2){let e=t.$implicit;m("value",e),n(),v(" ",e," ")}}function $e(i,t){i&1&&(r(0,"mat-error"),l(1," Campo obligatorio "),a())}function Be(i,t){if(i&1&&(r(0,"mat-form-field",11)(1,"mat-label"),l(2,"Obra Social"),a(),r(3,"mat-select",28),p(4,Le,2,2,"mat-option",29),a(),p(5,$e,2,0,"mat-error",13),a()),i&2){let e,o=_(2);n(4),m("ngForOf",o.obraSocialOptions),n(),m("ngIf",(e=o.registroForm.get("obraSocial"))==null?null:e.hasError("required"))}}function Ge(i,t){if(i&1&&(r(0,"mat-option",30),l(1),a()),i&2){let e=t.$implicit;m("value",e),n(),v(" ",e.nombre," ")}}function Ze(i,t){i&1&&(r(0,"mat-error"),l(1," Campo obligatorio "),a())}function He(i,t){if(i&1&&(r(0,"mat-form-field",11)(1,"mat-label"),l(2,"Especialidad"),a(),r(3,"mat-select",31),p(4,Ge,2,2,"mat-option",29),a(),p(5,Ze,2,0,"mat-error",13),a()),i&2){let e,o=_(2);n(4),m("ngForOf",o.especialidadOptions),n(),m("ngIf",(e=o.registroForm.get("especialidad"))==null?null:e.hasError("required"))}}function We(i,t){i&1&&(r(0,"mat-error"),l(1," Campo obligatorio "),a())}function Je(i,t){i&1&&(r(0,"mat-error"),l(1," M\xEDnimo 2 caracteres "),a())}function Ke(i,t){i&1&&(r(0,"mat-error"),l(1," Solo letras "),a())}function Qe(i,t){if(i&1&&(r(0,"mat-form-field",11)(1,"mat-label"),l(2,"Otra Especialidad"),a(),h(3,"input",32),p(4,We,2,0,"mat-error",13)(5,Je,2,0,"mat-error",13)(6,Ke,2,0,"mat-error",13),a()),i&2){let e,o,s,d,g=_(2);n(3),m("disabled",!((e=g.registroForm.get("otraEspecialidad"))!=null&&e.enabled)),n(),m("ngIf",(o=g.registroForm.get("otraEspecialidad"))==null?null:o.hasError("required")),n(),m("ngIf",(s=g.registroForm.get("otraEspecialidad"))==null?null:s.hasError("minlength")),n(),m("ngIf",(d=g.registroForm.get("otraEspecialidad"))==null?null:d.hasError("pattern"))}}function Xe(i,t){i&1&&(r(0,"mat-error"),l(1," Campo obligatorio "),a())}function Ye(i,t){i&1&&(r(0,"mat-error"),l(1," Email inv\xE1lido "),a())}function et(i,t){i&1&&(r(0,"mat-error"),l(1," Campo obligatorio "),a())}function tt(i,t){i&1&&(r(0,"mat-error"),l(1," M\xEDnimo 7 caracteres "),a())}function it(i,t){i&1&&(r(0,"mat-error"),l(1," Campo obligatorio "),a())}function rt(i,t){if(i&1){let e=y();r(0,"div",20)(1,"label",21),l(2,"Imagen de fondo"),a(),r(3,"input",22),f("change",function(s){b(e);let d=_(2);return E(d.onFileSelected(s,"fondo"))}),a()()}}function at(i,t){if(i&1){let e=y();r(0,"form",10),f("ngSubmit",function(){b(e);let s=_();return E(s.registrar())}),r(1,"mat-form-field",11)(2,"mat-label"),l(3,"Nombre"),a(),h(4,"input",12),p(5,Ue,2,0,"mat-error",13)(6,Pe,2,0,"mat-error",13)(7,ke,2,0,"mat-error",13),a(),r(8,"mat-form-field",11)(9,"mat-label"),l(10,"Apellido"),a(),h(11,"input",14),p(12,Oe,2,0,"mat-error",13)(13,Me,2,0,"mat-error",13)(14,Ne,2,0,"mat-error",13),a(),r(15,"mat-form-field",11)(16,"mat-label"),l(17,"Edad"),a(),h(18,"input",15),p(19,Re,2,0,"mat-error",13)(20,ze,2,0,"mat-error",13)(21,De,2,0,"mat-error",13),a(),r(22,"mat-form-field",11)(23,"mat-label"),l(24,"DNI"),a(),h(25,"input",16),p(26,qe,2,0,"mat-error",13)(27,je,2,0,"mat-error",13),a(),p(28,Be,6,2,"mat-form-field",17)(29,He,6,2,"mat-form-field",17)(30,Qe,7,4,"mat-form-field",17),r(31,"mat-form-field",11)(32,"mat-label"),l(33,"Email"),a(),h(34,"input",18),p(35,Xe,2,0,"mat-error",13)(36,Ye,2,0,"mat-error",13),a(),r(37,"mat-form-field",11)(38,"mat-label"),l(39,"Contrase\xF1a"),a(),h(40,"input",19),p(41,et,2,0,"mat-error",13)(42,tt,2,0,"mat-error",13),a(),r(43,"div",20)(44,"label",21),l(45,"Imagen de perfil"),a(),r(46,"input",22),f("change",function(s){b(e);let d=_();return E(d.onFileSelected(s,"perfil"))}),a(),p(47,it,2,0,"mat-error",13),a(),p(48,rt,4,0,"div",23),r(49,"div",24)(50,"button",25),l(51," Registrar "),a()(),r(52,"div",26)(53,"button",27),f("click",function(){b(e);let s=_();return E(s.tipoUsuario=null)}),l(54," Cambiar tipo de usuario "),a()()()}if(i&2){let e,o,s,d,g,A,q,j,L,$,B,G,Z,H,W,J,u=_();m("formGroup",u.registroForm),n(5),m("ngIf",(e=u.registroForm.get("nombre"))==null?null:e.hasError("required")),n(),m("ngIf",(o=u.registroForm.get("nombre"))==null?null:o.hasError("minlength")),n(),m("ngIf",(s=u.registroForm.get("nombre"))==null?null:s.hasError("pattern")),n(5),m("ngIf",(d=u.registroForm.get("apellido"))==null?null:d.hasError("required")),n(),m("ngIf",(g=u.registroForm.get("apellido"))==null?null:g.hasError("minlength")),n(),m("ngIf",(A=u.registroForm.get("apellido"))==null?null:A.hasError("pattern")),n(5),m("ngIf",(q=u.registroForm.get("edad"))==null?null:q.hasError("required")),n(),m("ngIf",(j=u.registroForm.get("edad"))==null?null:j.hasError("min")),n(),m("ngIf",(L=u.registroForm.get("edad"))==null?null:L.hasError("max")),n(5),m("ngIf",($=u.registroForm.get("dni"))==null?null:$.hasError("required")),n(),m("ngIf",(B=u.registroForm.get("dni"))==null?null:B.hasError("pattern")),n(),m("ngIf",u.tipoUsuario==="paciente"),n(),m("ngIf",u.tipoUsuario==="especialista"),n(),m("ngIf",u.tipoUsuario==="especialista"),n(5),m("ngIf",(G=u.registroForm.get("mail"))==null?null:G.hasError("required")),n(),m("ngIf",(Z=u.registroForm.get("mail"))==null?null:Z.hasError("email")),n(5),m("ngIf",(H=u.registroForm.get("password"))==null?null:H.hasError("required")),n(),m("ngIf",(W=u.registroForm.get("password"))==null?null:W.hasError("minlength")),n(5),m("ngIf",(J=u.registroForm.get("imagenPerfil"))==null?null:J.hasError("required")),n(),m("ngIf",u.tipoUsuario==="paciente"),n(2),m("disabled",u.registroForm.invalid)}}var N=class i{constructor(t,e,o,s){this.fb=t;this.auth=e;this.snackBar=o;this.loading=s}perfilId;cerrar=new z;altaExitosa=new z;registroForm;tipoUsuario=null;obraSocialOptions=Se;especialidadOptions=[];subEspecialidad;ngOnInit(){this.initForm()}ngOnDestroy(){this.subEspecialidad?.unsubscribe()}cerrarPopup(){this.cerrar.emit()}initForm(){return x(this,null,function*(){try{this.loading.show(),this.especialidadOptions=yield this.auth.obtenerEspecialidades(),this.especialidadOptions.push({id:-1,nombre:"Otra",url_icono:"http",duracion:"30"}),this.registroForm=this.fb.group({nombre:["",[c.required,c.minLength(2),c.pattern(/^[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+$/)]],apellido:["",[c.required,c.minLength(2),c.pattern(/^[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+$/)]],edad:[null,[c.required,c.min(18),c.max(99)]],dni:["",[c.required,c.pattern(/^\d{8}$/)]],obraSocial:[""],mail:["",[c.required,c.email]],password:["",[c.required,c.minLength(7)]],especialidad:[""],otraEspecialidad:[{value:"",disabled:!0},[c.minLength(2),c.pattern(/^[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+$/)]],imagenPerfil:[null,c.required],imagenFondo:[""]}),this.subEspecialidad=this.registroForm.get("especialidad").valueChanges.subscribe(t=>{let e=this.registroForm.get("otraEspecialidad");t?.id===-1?(e.enable(),e.setValidators([c.required,c.minLength(2),c.pattern(/^[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+$/)])):(e.disable(),e.clearValidators()),e.updateValueAndValidity()})}catch{}finally{this.loading.hide()}})}seleccionarTipo(t){if(this.tipoUsuario=t,!this.registroForm)return;let e=this.registroForm.get("obraSocial"),o=this.registroForm.get("especialidad"),s=this.registroForm.get("otraEspecialidad");t==="paciente"?(e?.setValidators([c.required]),o?.clearValidators(),s?.clearValidators(),s?.disable()):t==="especialista"?(e?.clearValidators(),o?.setValidators([c.required]),o?.value?.id===-1?(s?.enable(),s?.setValidators([c.required,c.minLength(2),c.pattern(/^[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+$/)])):(s?.disable(),s?.clearValidators())):t==="admin"&&(this.registroForm.get("obraSocial")?.setValue(""),this.registroForm.get("especialidad")?.setValue(""),this.registroForm.get("otraEspecialidad")?.setValue(""),this.registroForm.get("imagenFondo")?.setValue(""),e?.clearValidators(),o?.clearValidators(),s?.clearValidators(),s?.disable()),e?.updateValueAndValidity(),o?.updateValueAndValidity(),s?.updateValueAndValidity()}onFileSelected(t,e){let o=e==="perfil"?"imagenPerfil":"imagenFondo",s=t.target,d=this.registroForm.get(o);if(!s.files?.length){d.setValue(null),d.setErrors({required:!0});return}let g=s.files[0];if(!["image/jpeg","image/png","image/jpg"].includes(g.type)){d.setErrors({invalidType:!0});return}d.setValue(g),d.setErrors(null)}registrar(){return x(this,null,function*(){if(!(this.registroForm.invalid||!this.tipoUsuario)){this.loading.show();try{this.tipoUsuario==="paciente"?yield this.handleRegistroPaciente():this.tipoUsuario==="especialista"?yield this.handleRegistroEspecialista():this.tipoUsuario==="admin"&&(yield this.handleRegistroAdmin())}finally{this.loading.hide()}}})}handleRegistroAdmin(){return x(this,null,function*(){try{let t=this.registroForm.value,e=yield I(t.imagenPerfil),o={nombre:t.nombre,apellido:t.apellido,edad:t.edad,dni:t.dni,mail:t.mail,contrasena:t.password,imagenPerfil:e},s=yield this.auth.registerAdmin(o),d=s.errorCode?.toLowerCase();console.log(s.errorCode),d?.includes("error desconocido")?this.mostrarResultado(s.success,s.message):this.mostrarResultado(s.success,s.errorCode)}catch{this.mostrarResultado(!1,"Error al procesar las im\xE1genes.")}})}handleRegistroPaciente(){return x(this,null,function*(){try{let t=this.registroForm.value,e=yield I(t.imagenPerfil),o=yield I(t.imagenFondo),s={nombre:t.nombre,apellido:t.apellido,edad:t.edad,dni:t.dni,obraSocial:t.obraSocial,mail:t.mail,contrasena:t.password,imagenPerfil:e,imagenFondo:o},d=yield this.auth.registerPaciente(s),g=d.errorCode?.toLowerCase();console.log(d.errorCode),g?.includes("error desconocido")?this.mostrarResultado(d.success,d.message):this.mostrarResultado(d.success,d.errorCode)}catch{this.mostrarResultado(!1,"Error al procesar las im\xE1genes.")}})}handleRegistroEspecialista(){return x(this,null,function*(){try{let t=this.registroForm.value,e=yield I(t.imagenPerfil),o=t.especialidad.id===-1?t.otraEspecialidad:t.especialidad.nombre,s={nombre:t.nombre,apellido:t.apellido,edad:t.edad,dni:t.dni,mail:t.mail,contrasena:t.password,especialidad:o,imagenPerfil:e},d=yield this.auth.registerEspecialista(s);d.errorCode?.toLowerCase()?.includes("error desconocido")?this.mostrarResultado(d.success,d.message):this.mostrarResultado(d.success,d.errorCode)}catch{this.mostrarResultado(!1,"Error al procesar la imagen.")}})}mostrarResultado(t,e){if(!t){this.snackBar.open(e||"Ocurri\xF3 un error.","Cerrar",{duration:4e3,panelClass:["bg-red-600","text-white"]});return}this.tipoUsuario=null,this.altaExitosa.emit()}static \u0275fac=function(e){return new(e||i)(S(se),S(O),S(ue),S(M))};static \u0275cmp=F({type:i,selectors:[["app-altas-admin"]],inputs:{perfilId:"perfilId"},outputs:{cerrar:"cerrar",altaExitosa:"altaExitosa"},decls:6,vars:2,consts:[[1,"fixed","inset-0","z-50","flex","items-center","justify-center","bg-black/50","backdrop-blur-sm",3,"click"],[1,"w-full","max-w-3xl","rounded-2xl","bg-white","px-6","py-1","shadow-xl",3,"click"],[1,"mt-2","mb-4","text-center","text-4xl","font-bold","text-azul-oscuro"],["class","space-y-6 p-10 text-center",4,"ngIf"],["class","mt-6 grid grid-cols-1 gap-6 md:grid-cols-2",3,"formGroup","ngSubmit",4,"ngIf"],[1,"space-y-6","p-10","text-center"],[1,"text-xl","text-gray-700"],[1,"flex","flex-col","justify-center","gap-6","sm:flex-row"],[1,"rounded-xl","bg-white","px-8","py-4","shadow","transition-transform","hover:scale-105",3,"click"],[1,"text-xl","font-semibold","text-azul-oscuro"],[1,"mt-6","grid","grid-cols-1","gap-6","md:grid-cols-2",3,"ngSubmit","formGroup"],["appearance","fill"],["matInput","","formControlName","nombre"],[4,"ngIf"],["matInput","","formControlName","apellido"],["matInput","","type","number","formControlName","edad"],["matInput","","formControlName","dni"],["appearance","fill",4,"ngIf"],["matInput","","type","email","formControlName","mail"],["matInput","","type","password","formControlName","password"],[1,"md:col-span-2"],[1,"block","text-sm","font-medium","text-gray-700"],["type","file","accept","image/*",1,"register-input",3,"change"],["class","md:col-span-2",4,"ngIf"],[1,"flex","justify-center","pt-2","md:col-span-2"],["mat-raised-button","","color","primary","type","submit",1,"rounded-full","bg-verde-oscuro","px-6","py-2","text-white","shadow",3,"disabled"],[1,"text-center","md:col-span-2"],["mat-button","","type","button",1,"text-sm","text-gray-600","underline",3,"click"],["formControlName","obraSocial"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["formControlName","especialidad"],["matInput","","formControlName","otraEspecialidad",3,"disabled"]],template:function(e,o){e&1&&(r(0,"div",0),f("click",function(){return o.cerrarPopup()}),r(1,"div",1),f("click",function(d){return d.stopPropagation()}),r(2,"h2",2),l(3," Alta "),a(),p(4,Te,13,0,"div",3)(5,at,55,22,"form",4),a()()),e&2&&(n(4),m("ngIf",!o.tipoUsuario&&o.registroForm),n(),m("ngIf",o.tipoUsuario&&o.registroForm))},dependencies:[k,U,P,me,ae,te,oe,ie,re,de,ne,le,ve,ge,_e,fe,be,xe,Ae,he,Ee,pe,ce,ee],styles:[".register-input[_ngcontent-%COMP%]{padding:12px 20px;margin:10px 0;border:2px solid #333;border-radius:6px;background-color:#222;color:#fff;font-size:16px;cursor:pointer;transition:all .3s ease}.register-input[_ngcontent-%COMP%]:hover{border-color:#92cc34;background-color:#2c2c2c}.register-input[_ngcontent-%COMP%]:focus{border-color:#19b44d;background-color:#2c2c2c;outline:none}.register-input[_ngcontent-%COMP%]::-webkit-file-upload-button{background-color:#fff;color:#fff;padding:8px 15px;border-radius:4px;border:none;cursor:pointer;font-size:14px;transition:background-color .3s ease}"]})};var R=class i{constructor(t){this.auth=t}obtenerTodosUsuarios(){return x(this,null,function*(){let{data:t,error:e}=yield D.from("vista_perfiles_con_email").select(`
      id,
      auth_id,
      nombre,
      apellido,
      edad,
      dni,
      url_imagen_perfil, 
      rol,
      email,
      email_verificado_real,
      detalles_paciente (
        obra_social,
        url_imagen_fondo
      ),
      detalles_especialista (
        validado_admin,
        activo
      ),
      especialista_especialidades (
        duracion,
        especialidades (
          id,
          nombre,
          url_icono
        )
      )
    `);return e?(console.error("Error al obtener usuarios:",e),[]):t.map(o=>{let s=Array.isArray(o.detalles_paciente)?o.detalles_paciente[0]:o.detalles_paciente??null,d=Array.isArray(o.detalles_especialista)?o.detalles_especialista[0]:o.detalles_especialista??null,g=(o.especialista_especialidades??[]).map(A=>({id:A.especialidades.id,nombre:A.especialidades.nombre,urlIcono:A.especialidades.url_icono??void 0,duracion:A.duracion}));return{id:o.id,auth_id:o.auth_id,nombre:o.nombre,apellido:o.apellido,edad:String(o.edad),dni:o.dni,urlImagenPerfil:o.url_imagen_perfil,email:o.email??"",emailVerificado:o.email_verificado_real??!1,rol:o.rol,activo:d?.activo??!0,validadoAdmin:d?.validado_admin??!1,obraSocial:s?.obra_social,urlImagenFondo:s?.url_imagen_fondo,especialidades:g}})})}actualizarEstadoEspecialista(t,e){return x(this,null,function*(){let{error:o}=yield D.from("detalles_especialista").update({validado_admin:e}).eq("perfil_id",t);return o?(console.error("Error al actualizar validado_admin del especialista:",o),!1):!0})}static \u0275fac=function(e){return new(e||i)(X(O))};static \u0275prov=Q({token:i,factory:i.\u0275fac,providedIn:"root"})};function nt(i,t){if(i&1){let e=y();r(0,"app-altas-admin",9),f("cerrar",function(){b(e);let s=_();return E(s.cerrarPopupAltas())})("altaExitosa",function(){b(e);let s=_();return E(s.onAltaExitosa())}),a()}}function lt(i,t){if(i&1&&h(0,"img",18),i&2){let e=_().$implicit;m("src",e.urlImagenPerfil,w)}}function st(i,t){if(i&1&&(r(0,"div",12),p(1,lt,1,1,"img",13),r(2,"div",14)(3,"p",15),l(4),a(),r(5,"p",16),l(6),a(),r(7,"p"),l(8),a(),r(9,"p"),l(10),a(),r(11,"p"),l(12," Email verificado: "),r(13,"span",17),l(14),a()()()()),i&2){let e=t.$implicit;n(),m("ngIf",e.urlImagenPerfil),n(3),T(" ",e.nombre," ",e.apellido," "),n(2),V(e.email),n(2),v("DNI: ",e.dni),n(2),v("Edad: ",e.edad),n(3),m("ngClass",e.emailVerificado?"text-verde-oscuro":"text-red-600"),n(),v(" ",e.emailVerificado?"Verificado":"Sin Verificar"," ")}}function mt(i,t){if(i&1&&(r(0,"div",10),p(1,st,15,8,"div",11),a()),i&2){let e=_();n(),m("ngForOf",e.pacientes)}}function dt(i,t){if(i&1&&h(0,"img",18),i&2){let e=_().$implicit;m("src",e.urlImagenPerfil,w)}}function ct(i,t){if(i&1){let e=y();r(0,"div",12),p(1,dt,1,1,"img",13),r(2,"div",14)(3,"p",15),l(4),a(),r(5,"p",16),l(6),a(),r(7,"p"),l(8),a(),r(9,"p"),l(10),a(),r(11,"p"),l(12," Email verificado: "),r(13,"span",17),l(14),a()(),r(15,"p"),l(16," Estado: "),r(17,"span",17),l(18),a()()(),r(19,"button",19),f("click",function(){let s=b(e).$implicit,d=_(2);return E(d.toggleValidadoAdmin(s))}),l(20),a()()}if(i&2){let e=t.$implicit;n(),m("ngIf",e.urlImagenPerfil),n(3),T(" ",e.nombre," ",e.apellido," "),n(2),V(e.email),n(2),v("DNI: ",e.dni),n(2),v("Edad: ",e.edad),n(3),m("ngClass",e.emailVerificado?"text-verde-oscuro":"text-red-600"),n(),v(" ",e.emailVerificado?"Verificado":"Sin Verificar"," "),n(3),m("ngClass",e.validadoAdmin?"text-verde-oscuro":"text-red-600"),n(),v(" ",e.validadoAdmin?"Habilitado":"Inhabilitado"," "),n(2),v(" ",e.validadoAdmin?"Deshabilitar":"Habilitar"," ")}}function pt(i,t){if(i&1&&(r(0,"div",10),p(1,ct,21,11,"div",11),a()),i&2){let e=_();n(),m("ngForOf",e.especialistas)}}function ut(i,t){if(i&1&&h(0,"img",18),i&2){let e=_().$implicit;m("src",e.urlImagenPerfil,w)}}function _t(i,t){if(i&1&&(r(0,"div",12),p(1,ut,1,1,"img",13),r(2,"div",14)(3,"p",15),l(4),a(),r(5,"p",16),l(6),a(),r(7,"p"),l(8),a(),r(9,"p"),l(10),a(),r(11,"p"),l(12," Email verificado: "),r(13,"span",17),l(14),a()()()()),i&2){let e=t.$implicit;n(),m("ngIf",e.urlImagenPerfil),n(3),T(" ",e.nombre," ",e.apellido," "),n(2),V(e.email),n(2),v("DNI: ",e.dni),n(2),v("Edad: ",e.edad),n(3),m("ngClass",e.emailVerificado?"text-verde-oscuro":"text-red-600"),n(),v(" ",e.emailVerificado?"Verificado":"Sin Verificar"," ")}}function ft(i,t){if(i&1&&(r(0,"div",10),p(1,_t,15,8,"div",11),a()),i&2){let e=_();n(),m("ngForOf",e.administradores)}}var Ie=class i{constructor(t,e){this.usuariosService=t;this.loading=e}solapaActiva="pacientes";pacientes=[];especialistas=[];administradores=[];usuarioSeleccionado=null;destroy$=new K;mostrarPopupAltas=!1;ngOnInit(){this.recargarUsuarios(),this.loading.hide()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}recargarUsuarios(){return x(this,null,function*(){let t=yield this.usuariosService.obtenerTodosUsuarios();this.pacientes=t.filter(e=>e.rol==="paciente"),this.especialistas=t.filter(e=>e.rol==="especialista"),this.administradores=t.filter(e=>e.rol==="admin")})}seleccionarUsuario(t){this.usuarioSeleccionado=t}toggleValidadoAdmin(t){return x(this,null,function*(){if(t.rol!=="especialista")return;let e=!t.validadoAdmin;(yield this.usuariosService.actualizarEstadoEspecialista(t.id,e))&&(t.validadoAdmin=e,yield this.recargarUsuarios())})}abrirPopupAltas(){this.mostrarPopupAltas=!0}cerrarPopupAltas(){this.mostrarPopupAltas=!1}onAltaExitosa(){return x(this,null,function*(){yield this.recargarUsuarios(),this.cerrarPopupAltas()})}static \u0275fac=function(e){return new(e||i)(S(R),S(M))};static \u0275cmp=F({type:i,selectors:[["app-usuarios"]],decls:17,vars:22,consts:[[1,"h-full","w-full","p-1"],[1,"h-full","w-full","overflow-auto","rounded-2xl","border","border-white","bg-crema","p-6","pb-6","shadow-inner"],[1,"flex","flex-wrap","items-center","justify-between","pb-7"],[1,"flex","flex-wrap","gap-2"],[1,"px-4","py-2","font-semibold","text-gray-600","hover:text-azul-oscuro",3,"click"],[1,"mr-10"],[1,"btn","btn-primary","h-12","rounded-2xl","bg-azul-oscuro","px-6","py-2","text-base","text-white","transition-all","duration-50","hover:bg-azul-claro","hover:text-lg",3,"click"],[3,"cerrar","altaExitosa",4,"ngIf"],["class","grid justify-center gap-x-1 gap-y-3","style","grid-template-columns: repeat(auto-fill, minmax(300px, 1fr))",4,"ngIf"],[3,"cerrar","altaExitosa"],[1,"grid","justify-center","gap-x-1","gap-y-3",2,"grid-template-columns","repeat(auto-fill, minmax(300px, 1fr))"],["class","w-full rounded-lg border border-gray-300 bg-white p-4 shadow-sm",4,"ngFor","ngForOf"],[1,"w-full","rounded-lg","border","border-gray-300","bg-white","p-4","shadow-sm"],["alt","Avatar","class","mb-2 h-14 w-14 rounded-full object-cover",3,"src",4,"ngIf"],[1,"text-sm"],[1,"font-semibold","text-azul-oscuro"],[1,"text-gray-600"],[3,"ngClass"],["alt","Avatar",1,"mb-2","h-14","w-14","rounded-full","object-cover",3,"src"],[1,"mt-2","w-full","rounded","bg-azul-claro","px-3","py-1","text-sm","text-white","hover:bg-azul-oscuro",3,"click"]],template:function(e,o){e&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),f("click",function(){return o.solapaActiva="pacientes"}),l(5," Pacientes "),a(),r(6,"button",4),f("click",function(){return o.solapaActiva="especialistas"}),l(7," Especialistas "),a(),r(8,"button",4),f("click",function(){return o.solapaActiva="administradores"}),l(9," Administradores "),a()(),r(10,"div",5)(11,"button",6),f("click",function(){return o.abrirPopupAltas()}),l(12," Dar Alta Usuario "),a()()(),p(13,nt,1,0,"app-altas-admin",7)(14,mt,2,1,"div",8)(15,pt,2,1,"div",8)(16,ft,2,1,"div",8),a()()),e&2&&(n(4),C("border-b-2",o.solapaActiva==="pacientes")("border-azul-oscuro",o.solapaActiva==="pacientes")("text-azul-oscuro",o.solapaActiva==="pacientes"),n(2),C("border-b-2",o.solapaActiva==="especialistas")("border-azul-oscuro",o.solapaActiva==="especialistas")("text-azul-oscuro",o.solapaActiva==="especialistas"),n(2),C("border-b-2",o.solapaActiva==="administradores")("border-azul-oscuro",o.solapaActiva==="administradores")("text-azul-oscuro",o.solapaActiva==="administradores"),n(5),m("ngIf",o.mostrarPopupAltas),n(),m("ngIf",o.solapaActiva==="pacientes"),n(),m("ngIf",o.solapaActiva==="especialistas"),n(),m("ngIf",o.solapaActiva==="administradores"))},dependencies:[k,Y,U,P,N],encapsulation:2})};export{Ie as Usuarios};

import{b as f}from"./chunk-VPTHVLTQ.js";import{b as t,c as s,j as c}from"./chunk-YDT6XDAL.js";import{U as m,Z as _}from"./chunk-PTIYVII4.js";import{j as l}from"./chunk-K4ALXBGI.js";var E=class n{auth=_(f);obtenerTodosUsuarios(){return l(this,null,function*(){let{data:r,error:a}=yield t.from(s.VISTA_PERFILES_CON_EMAIL).select(c.COMPLETO_CON_RELACIONES);return a?(console.error("Error al obtener usuarios:",a),[]):r.map(e=>{let i=Array.isArray(e.detalles_paciente)?e.detalles_paciente[0]:e.detalles_paciente??null,u=Array.isArray(e.detalles_especialista)?e.detalles_especialista[0]:e.detalles_especialista??null,A=(e.especialista_especialidades??[]).map(o=>{let d=Array.isArray(o.especialidades)?o.especialidades[0]:o.especialidades;return{id:d?.id??0,nombre:d?.nombre??"",urlIcono:d?.url_icono??void 0,duracion:o.duracion}});return{id:e.id,auth_id:e.auth_id,nombre:e.nombre,apellido:e.apellido,edad:String(e.edad),dni:e.dni,urlImagenPerfil:e.url_imagen_perfil,email:e.email??"",emailVerificado:e.email_verificado_real??!1,rol:e.rol,activo:u?.activo??!0,validadoAdmin:u?.validado_admin??!1,obraSocial:i?.obra_social,urlImagenFondo:i?.url_imagen_fondo,especialidades:A}})})}obtenerPacientesVerificados(){return l(this,null,function*(){let{data:r,error:a}=yield t.from(s.VISTA_PERFILES_CON_EMAIL).select(c.PACIENTES_VERIFICADOS).eq("rol","paciente").eq("email_verificado_real",!0);return a?(console.error("Error al obtener pacientes:",a),[]):r.map(e=>{let i=Array.isArray(e.detalles_paciente)?e.detalles_paciente[0]:e.detalles_paciente??null;return{id:e.id,auth_id:e.auth_id,nombre:e.nombre,apellido:e.apellido,edad:String(e.edad),dni:e.dni,urlImagenPerfil:e.url_imagen_perfil,email:e.email??"",emailVerificado:!0,rol:"paciente",activo:!0,validadoAdmin:!1,obraSocial:i?.obra_social,urlImagenFondo:i?.url_imagen_fondo,especialidades:[]}})})}actualizarEstadoEspecialista(r,a){return l(this,null,function*(){let{error:e}=yield t.from(s.DETALLES_ESPECIALISTA).update({validado_admin:a}).eq("perfil_id",r);return e?(console.error("Error al actualizar validado_admin del especialista:",e),!1):!0})}static \u0275fac=function(a){return new(a||n)};static \u0275prov=m({token:n,factory:n.\u0275fac,providedIn:"root"})};export{E as a};

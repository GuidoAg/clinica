import{a as ve}from"./chunk-YHDM7GGE.js";import{a as Z}from"./chunk-QYWCDNK3.js";import{a as T,c as ae}from"./chunk-NSHH6JJ5.js";import"./chunk-X5YLR3NI.js";import{b as fe}from"./chunk-K32GGTJZ.js";import{f as he,g as ge}from"./chunk-DHRKF7SU.js";import"./chunk-HICRNNMR.js";import{h as ie,k as ne}from"./chunk-M3XRSK3P.js";import{Db as z,Fb as _,Jb as E,Kb as w,Lb as y,Oa as g,Sb as ue,Ta as Y,Tb as r,U as de,Ub as O,Vb as j,Z as S,Za as b,ca as L,da as H,ea as B,ec as ee,fa as q,fc as te,n as ce,na as X,nb as I,ob as R,qb as me,rb as pe,tb as t,ub as n,vb as C,wb as k,xb as V,yb as D,zb as G}from"./chunk-7RTQA4J5.js";import{i as p}from"./chunk-ODN5LVDJ.js";var P=class s{obtenerLogIngresos(){return p(this,null,function*(){let{data:i,error:e}=yield T.from("registro_ingresos").select("fecha_ingreso, perfil_id").order("fecha_ingreso",{ascending:!1});if(e||!i)return console.error("[Supabase] Error al obtener log de ingresos:",e?.message),[];let o=[...new Set(i.map(m=>m.perfil_id).filter(Boolean))],{data:a,error:c}=yield T.from("perfiles").select("id, nombre, apellido, rol").in("id",o);return c||!a?(console.error("[Supabase] Error al obtener perfiles:",c?.message),[]):i.map(m=>{let d=a.find(h=>h.id===m.perfil_id);return{fecha:m.fecha_ingreso,nombre:d?.nombre??"Desconocido",apellido:d?.apellido??"",rol:d?.rol??"N/A"}})})}obtenerTurnosPorEspecialidad(){return p(this,null,function*(){let{data:i,error:e}=yield T.from("citas").select("especialidad_id");if(e||!i)return console.error("[Supabase] Error al obtener turnos por especialidad:",e?.message),[];let o=[...new Set(i.map(d=>d.especialidad_id).filter(Boolean))],{data:a,error:c}=yield T.from("especialidades").select("id, nombre").in("id",o);if(c||!a)return console.error("[Supabase] Error al obtener especialidades:",c?.message),[];let m=new Map;for(let d of i)d.especialidad_id&&m.set(d.especialidad_id,(m.get(d.especialidad_id)??0)+1);return o.map(d=>({especialidad:a.find(f=>f.id===d)?.nombre??"Sin especialidad",cantidad:m.get(d)??0}))})}obtenerTurnosPorDia(){return p(this,null,function*(){let{data:i,error:e}=yield T.from("citas").select("fecha_hora");if(e||!i)return console.error("[Supabase] Error al obtener turnos por d\xEDa:",e?.message),[];let o=new Map;for(let a of i){let c=new Date(a.fecha_hora).toISOString().split("T")[0];o.set(c,(o.get(c)??0)+1)}return Array.from(o.entries()).map(([a,c])=>({fecha:a,cantidad:c}))})}obtenerTurnosPorMedico(i,e){return p(this,null,function*(){let o=T.from("citas").select("especialista_id");i&&e&&(o=o.gte("fecha_hora",i).lte("fecha_hora",e));let{data:a,error:c}=yield o;if(c||!a)return console.error("[Supabase] Error al obtener turnos por m\xE9dico:",c?.message),[];let m=[...new Set(a.map(l=>l.especialista_id).filter(Boolean))],{data:d,error:h}=yield T.from("perfiles").select("id, nombre, apellido").in("id",m);if(h||!d)return console.error("[Supabase] Error al obtener perfiles:",h?.message),[];let f=new Map;for(let l of a)l.especialista_id&&f.set(l.especialista_id,(f.get(l.especialista_id)??0)+1);return m.map(l=>{let x=d.find(v=>v.id===l);return{nombre:x?`${x.nombre} ${x.apellido}`:"Desconocido",cantidad:f.get(l)??0}})})}obtenerTurnosFinalizadosPorMedico(i,e){return p(this,null,function*(){let o=T.from("citas").select("especialista_id, estado").eq("estado","completado");i&&e&&(o=o.gte("fecha_hora",i).lte("fecha_hora",e));let{data:a,error:c}=yield o;if(c||!a)return console.error("[Supabase] Error al obtener turnos finalizados por m\xE9dico:",c?.message),[];let m=[...new Set(a.map(l=>l.especialista_id).filter(Boolean))],{data:d,error:h}=yield T.from("perfiles").select("id, nombre, apellido").in("id",m);if(h||!d)return console.error("[Supabase] Error al obtener perfiles:",h?.message),[];let f=new Map;for(let l of a)l.especialista_id&&f.set(l.especialista_id,(f.get(l.especialista_id)??0)+1);return m.map(l=>{let x=d.find(v=>v.id===l);return{nombre:x?`${x.nombre} ${x.apellido}`:"Desconocido",cantidad:f.get(l)??0}})})}obtenerIngresosEspecialistas60Dias(){return p(this,null,function*(){return this.obtenerIngresosPorRol("especialista")})}obtenerIngresosPacientes60Dias(){return p(this,null,function*(){return this.obtenerIngresosPorRol("paciente")})}obtenerIngresosPorRol(i){return p(this,null,function*(){let e=new Date;e.setDate(e.getDate()-60);let o=e.toISOString(),{data:a,error:c}=yield T.from("registro_ingresos").select("fecha_ingreso, perfil_id").gte("fecha_ingreso",o).order("fecha_ingreso",{ascending:!0});if(c||!a)return console.error(`[Supabase] Error al obtener ingresos de ${i}:`,c?.message),{datos:[],maxY:40};let m=[...new Set(a.map(u=>u.perfil_id).filter(Boolean))];if(m.length===0)return{datos:[],maxY:40};let{data:d,error:h}=yield T.from("perfiles").select("id, rol").in("id",m).eq("rol",i);if(h||!d)return console.error(`[Supabase] Error al obtener perfiles de ${i}:`,h?.message),{datos:[],maxY:40};let f=new Set(d.map(u=>u.id)),l=a.filter(u=>f.has(u.perfil_id)),x=new Map;for(let u of l){let A=new Date(u.fecha_ingreso),N=`${A.getFullYear()}-${String(A.getMonth()+1).padStart(2,"0")}-${String(A.getDate()).padStart(2,"0")}`;x.set(N,(x.get(N)??0)+1)}let v=Array.from(x.entries()).map(([u,A])=>({fecha_hora:u,cantidad:A})),M=Math.max(...v.map(u=>u.cantidad),0),F=M===0?40:Math.ceil((M+1)/5)*5;return{datos:v,maxY:F}})}static \u0275fac=function(e){return new(e||s)};static \u0275prov=de({token:s,factory:s.\u0275fac,providedIn:"root"})};var be=["canvas"],U=class s{estadisticas=S(P);canvasRef;ngAfterViewInit(){return p(this,null,function*(){let{Chart:i,BarElement:e,BarController:o,CategoryScale:a,LinearScale:c,Tooltip:m,Legend:d}=yield import("./chunk-MBHQL6GC.js");i.register(e,o,a,c,m,d);let h=this.canvasRef.nativeElement,f=yield this.estadisticas.obtenerTurnosPorDia(),l=f.map(v=>v.fecha),x=f.map(v=>v.cantidad);new i(h,{type:"bar",data:{labels:l,datasets:[{label:"Turnos por D\xEDa",data:x,backgroundColor:"rgba(54, 162, 235, 0.7)"}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{stepSize:1,precision:0}}}}})})}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=b({type:s,selectors:[["app-turnos-por-dia-chart"]],viewQuery:function(e,o){if(e&1&&E(be,7),e&2){let a;w(a=y())&&(o.canvasRef=a.first)}},decls:2,vars:0,consts:[["canvas",""],[1,"mx-auto","h-64","w-full"]],template:function(e,o){e&1&&D(0,"canvas",1,0)},encapsulation:2})};var Ce=["canvas"],W=class s{estadisticas=S(P);chart;canvasRef;ngAfterViewInit(){this.render()}render(){return p(this,null,function*(){let{Chart:i,ArcElement:e,PieController:o,Tooltip:a,Legend:c}=yield import("./chunk-MBHQL6GC.js");i.register(e,o,a,c);let m=yield this.estadisticas.obtenerTurnosPorEspecialidad(),d=m.map(l=>l.especialidad),h=m.map(l=>l.cantidad),f=this.canvasRef.nativeElement;this.chart?.destroy(),this.chart=new i(f,{type:"pie",data:{labels:d,datasets:[{label:"Turnos por Especialidad",data:h,backgroundColor:["rgba(255, 99, 132, 0.7)","rgba(54, 162, 235, 0.7)","rgba(255, 206, 86, 0.7)","rgba(75, 192, 192, 0.7)","rgba(153, 102, 255, 0.7)","rgba(255, 159, 64, 0.7)"],borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1}})})}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=b({type:s,selectors:[["app-turnos-por-especialidad-chart"]],viewQuery:function(e,o){if(e&1&&E(Ce,7),e&2){let a;w(a=y())&&(o.canvasRef=a.first)}},decls:3,vars:0,consts:[["canvas",""],[1,"relative","h-64","w-full"],[1,"absolute","inset-0","h-full","w-full"]],template:function(e,o){e&1&&(k(0,"div",1),D(1,"canvas",2,0),V())},encapsulation:2})};var Ee=["canvas"],K=class s{estadisticas=S(P);chart;canvasRef;render(i,e){return p(this,null,function*(){let{Chart:o,BarElement:a,BarController:c,CategoryScale:m,LinearScale:d,Tooltip:h,Legend:f}=yield import("./chunk-MBHQL6GC.js");o.register(a,c,m,d,h,f);let l=yield this.estadisticas.obtenerTurnosPorMedico(i,e),x=l.map(F=>F.nombre),v=l.map(F=>F.cantidad),M=this.canvasRef.nativeElement;this.chart?.destroy(),this.chart=new o(M,{type:"bar",data:{labels:x,datasets:[{label:"Turnos por M\xE9dico",data:v,backgroundColor:"rgba(75, 192, 192, 0.7)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{stepSize:1,precision:0}}}}})})}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=b({type:s,selectors:[["app-turnos-por-medico-chart"]],viewQuery:function(e,o){if(e&1&&E(Ee,7),e&2){let a;w(a=y())&&(o.canvasRef=a.first)}},decls:3,vars:0,consts:[["canvas",""],[1,"relative","h-64","w-full"],[1,"absolute","inset-0","h-full","w-full"]],template:function(e,o){e&1&&(k(0,"div",1),D(1,"canvas",2,0),V())},encapsulation:2})};var we=["canvas"],J=class s{estadisticas=S(P);chart;canvasRef;render(i,e){return p(this,null,function*(){let{Chart:o,BarElement:a,BarController:c,CategoryScale:m,LinearScale:d,Tooltip:h,Legend:f}=yield import("./chunk-MBHQL6GC.js");o.register(a,c,m,d,h,f);let l=yield this.estadisticas.obtenerTurnosFinalizadosPorMedico(i,e),x=l.map(M=>M.nombre),v=l.map(M=>M.cantidad);this.chart?.destroy(),this.chart=new o(this.canvasRef.nativeElement,{type:"bar",data:{labels:x,datasets:[{label:"Turnos Finalizados por M\xE9dico",data:v,backgroundColor:"rgba(153, 102, 255, 0.7)",borderColor:"rgba(153, 102, 255, 1)",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{stepSize:1,precision:0}}}}})})}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=b({type:s,selectors:[["app-turnos-finalizados-por-medico-chart"]],viewQuery:function(e,o){if(e&1&&E(we,7),e&2){let a;w(a=y())&&(o.canvasRef=a.first)}},decls:3,vars:0,consts:[["canvas",""],[1,"relative","h-64","w-full"],[1,"absolute","inset-0","h-full","w-full"]],template:function(e,o){e&1&&(k(0,"div",1),D(1,"canvas",2,0),V())},encapsulation:2})};var ye=["canvas"],re=class s{estadisticas=S(P);chart;canvasRef;ngAfterViewInit(){this.render()}render(){return p(this,null,function*(){let{Chart:i,LineElement:e,LineController:o,PointElement:a,CategoryScale:c,LinearScale:m,Tooltip:d,Legend:h,Filler:f}=yield import("./chunk-MBHQL6GC.js");i.register(e,o,a,c,m,d,h,f);let{datos:l,maxY:x}=yield this.estadisticas.obtenerIngresosEspecialistas60Dias(),v=l.map(u=>u.fecha_hora),M=l.map(u=>u.cantidad),F=this.canvasRef.nativeElement;this.chart?.destroy(),this.chart=new i(F,{type:"line",data:{labels:v,datasets:[{label:"Ingresos de Especialistas (\xFAltimos 60 d\xEDas)",data:M,borderColor:"rgba(54, 162, 235, 1)",backgroundColor:"rgba(54, 162, 235, 0.1)",borderWidth:2,fill:!0,tension:.4,pointRadius:2,pointHoverRadius:5}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,max:x,ticks:{stepSize:5,precision:0}},x:{ticks:{maxTicksLimit:20,callback:function(u,A){let N=v[A];return N&&A%Math.ceil(v.length/20)===0?N:""}}}},plugins:{tooltip:{callbacks:{title:function(u){return u[0].label||""}}}}}})})}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=b({type:s,selectors:[["app-ingresos-especialistas-chart"]],viewQuery:function(e,o){if(e&1&&E(ye,7),e&2){let a;w(a=y())&&(o.canvasRef=a.first)}},decls:3,vars:0,consts:[["canvas",""],[1,"relative","h-80","w-full"],[1,"absolute","inset-0","h-full","w-full"]],template:function(e,o){e&1&&(k(0,"div",1),D(1,"canvas",2,0),V())},encapsulation:2})};var Se=["canvas"],oe=class s{estadisticas=S(P);chart;canvasRef;ngAfterViewInit(){this.render()}render(){return p(this,null,function*(){let{Chart:i,LineElement:e,LineController:o,PointElement:a,CategoryScale:c,LinearScale:m,Tooltip:d,Legend:h,Filler:f}=yield import("./chunk-MBHQL6GC.js");i.register(e,o,a,c,m,d,h,f);let{datos:l,maxY:x}=yield this.estadisticas.obtenerIngresosPacientes60Dias(),v=l.map(u=>u.fecha_hora),M=l.map(u=>u.cantidad),F=this.canvasRef.nativeElement;this.chart?.destroy(),this.chart=new i(F,{type:"line",data:{labels:v,datasets:[{label:"Ingresos de Pacientes (\xFAltimos 60 d\xEDas)",data:M,borderColor:"rgba(75, 192, 192, 1)",backgroundColor:"rgba(75, 192, 192, 0.1)",borderWidth:2,fill:!0,tension:.4,pointRadius:2,pointHoverRadius:5}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,max:x,ticks:{stepSize:5,precision:0}},x:{ticks:{maxTicksLimit:20,callback:function(u,A){let N=v[A];return N&&A%Math.ceil(v.length/20)===0?N:""}}}},plugins:{tooltip:{callbacks:{title:function(u){return u[0].label||""}}}}}})})}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=b({type:s,selectors:[["app-ingresos-pacientes-chart"]],viewQuery:function(e,o){if(e&1&&E(Se,7),e&2){let a;w(a=y())&&(o.canvasRef=a.first)}},decls:3,vars:0,consts:[["canvas",""],[1,"relative","h-80","w-full"],[1,"absolute","inset-0","h-full","w-full"]],template:function(e,o){e&1&&(k(0,"div",1),D(1,"canvas",2,0),V())},encapsulation:2})};var se=class s{loading=S(Z);turnosPorDiaChart;turnosPorEspecialidadChart;turnosPorMedicoChart;turnosFinalizadosChart;ngAfterViewInit(){this.cargarDatos()}cargarDatos(){return p(this,null,function*(){this.loading.show();try{yield Promise.all([this.cargarTurnosPorMedico(),this.cargarTurnosFinalizados()])}finally{this.loading.hide()}})}cargarTurnosPorMedico(){return p(this,null,function*(){yield this.turnosPorMedicoChart?.render("","")})}cargarTurnosFinalizados(){return p(this,null,function*(){yield this.turnosFinalizadosChart?.render("","")})}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=b({type:s,selectors:[["app-home"]],viewQuery:function(e,o){if(e&1&&(E(U,5),E(W,5),E(K,5),E(J,5)),e&2){let a;w(a=y())&&(o.turnosPorDiaChart=a.first),w(a=y())&&(o.turnosPorEspecialidadChart=a.first),w(a=y())&&(o.turnosPorMedicoChart=a.first),w(a=y())&&(o.turnosFinalizadosChart=a.first)}},decls:80,vars:0,consts:[[1,"h-full","w-full","p-1"],[1,"h-full","w-full","overflow-auto","rounded-2xl","border","border-white","bg-crema","p-6","shadow-inner"],[1,"mb-8"],[1,"mb-2","text-4xl","font-bold","text-azul-oscuro"],[1,"text-gray-600"],[1,"grid","gap-6","lg:grid-cols-2"],[1,"rounded-xl","bg-white","p-6","shadow-lg","transition-all","hover:shadow-xl"],[1,"mb-4","flex","items-center","gap-3"],[1,"rounded-lg","bg-blue-100","p-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"text-xl","font-semibold","text-gray-800"],[1,"text-sm","text-gray-500"],[1,"rounded-lg","bg-gray-50","p-4"],[1,"rounded-lg","bg-purple-100","p-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-purple-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"],[1,"rounded-xl","bg-white","p-6","shadow-lg","transition-all","hover:shadow-xl","lg:col-span-2"],[1,"rounded-lg","bg-teal-100","p-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-teal-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"],[1,"flex-1"],[1,"rounded-lg","bg-green-100","p-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"rounded-lg","bg-indigo-100","p-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-indigo-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"],[1,"rounded-lg","bg-cyan-100","p-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-cyan-600"]],template:function(e,o){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),r(4," Panel de Estad\xEDsticas "),n(),t(5,"p",4),r(6," An\xE1lisis y m\xE9tricas del sistema en tiempo real "),n()(),t(7,"div",5)(8,"section",6)(9,"div",7)(10,"div",8),B(),t(11,"svg",9),C(12,"path",10),n()(),q(),t(13,"div")(14,"h3",11),r(15,"Turnos por D\xEDa"),n(),t(16,"p",12),r(17,"Distribuci\xF3n diaria de turnos"),n()()(),t(18,"div",13),C(19,"app-turnos-por-dia-chart"),n()(),t(20,"section",6)(21,"div",7)(22,"div",14),B(),t(23,"svg",15),C(24,"path",16),n()(),q(),t(25,"div")(26,"h3",11),r(27," Turnos por Especialidad "),n(),t(28,"p",12),r(29,"Distribuci\xF3n por \xE1rea m\xE9dica"),n()()(),t(30,"div",13),C(31,"app-turnos-por-especialidad-chart"),n()(),t(32,"section",17)(33,"div",7)(34,"div",18),B(),t(35,"svg",19),C(36,"path",20),n()(),q(),t(37,"div",21)(38,"h3",11),r(39," Turnos por M\xE9dico "),n(),t(40,"p",12),r(41," Historial completo de turnos por profesional "),n()()(),t(42,"div",13),C(43,"app-turnos-por-medico-chart"),n()(),t(44,"section",17)(45,"div",7)(46,"div",22),B(),t(47,"svg",23),C(48,"path",24),n()(),q(),t(49,"div")(50,"h3",11),r(51," Turnos Finalizados por M\xE9dico "),n(),t(52,"p",12),r(53," Consultas completadas exitosamente "),n()()(),t(54,"div",13),C(55,"app-turnos-finalizados-por-medico-chart"),n()(),t(56,"section",6)(57,"div",7)(58,"div",25),B(),t(59,"svg",26),C(60,"path",27),n()(),q(),t(61,"div")(62,"h3",11),r(63," Ingresos - Especialistas "),n(),t(64,"p",12),r(65,"\xDAltimos 60 d\xEDas (por d\xEDa)"),n()()(),t(66,"div",13),C(67,"app-ingresos-especialistas-chart"),n()(),t(68,"section",6)(69,"div",7)(70,"div",28),B(),t(71,"svg",29),C(72,"path",27),n()(),q(),t(73,"div")(74,"h3",11),r(75," Ingresos - Pacientes "),n(),t(76,"p",12),r(77,"\xDAltimos 60 d\xEDas (por d\xEDa)"),n()()(),t(78,"div",13),C(79,"app-ingresos-pacientes-chart"),n()()()()())},dependencies:[U,W,K,J,re,oe],encapsulation:2})};var Me=(s,i)=>i.citaId;function De(s,i){s&1&&(t(0,"div",5)(1,"div",7),C(2,"div",8),t(3,"p",4),r(4,"Cargando informaci\xF3n..."),n()()())}function Ae(s,i){if(s&1){let e=G();t(0,"button",38),z("click",function(){L(e);let a=_(4);return H(a.navegarA("solicitar-turnos"))}),r(1," Solicitar un turno "),n()}}function Ie(s,i){if(s&1&&(t(0,"div",21)(1,"mat-icon",35),r(2,"event_busy"),n(),t(3,"p",36),r(4),n(),I(5,Ae,2,0,"button",37),n()),s&2){let e=_(2);g(4),j(" ",e.rol==="paciente"?"No tienes turnos programados":"No tienes turnos pendientes"," "),g(),R(e.rol==="paciente"?5:-1)}}function Re(s,i){if(s&1&&(t(0,"mat-icon",36),r(1,"person"),n(),t(2,"span"),r(3),n()),s&2){let e=_().$implicit;g(3),O(e.especialistaNombreCompleto)}}function ke(s,i){if(s&1&&(t(0,"mat-icon",36),r(1,"person"),n(),t(2,"span"),r(3),n()),s&2){let e=_().$implicit;g(3),O(e.pacienteNombreCompleto)}}function Ve(s,i){if(s&1){let e=G();t(0,"div",39)(1,"div",40)(2,"div",41)(3,"div",42)(4,"span",43),r(5),n(),t(6,"span",44),r(7),n()(),t(8,"div",45)(9,"mat-icon",36),r(10,"calendar_today"),n(),t(11,"span",46),r(12),n()(),t(13,"div",47)(14,"mat-icon",36),r(15,"schedule"),n(),t(16,"span"),r(17),n(),t(18,"span",48),r(19,"\u2022"),n(),I(20,Re,4,1)(21,ke,4,1),n()(),t(22,"button",49),z("click",function(){L(e);let a=_(3),c=_();return H(c.navegarA(a.rol==="paciente"?"mis-turnos-paciente":"mis-turnos-especialista"))}),r(23," Ver Detalles "),n()()()}if(s&2){let e=i.$implicit,o=_(3),a=_();g(4),ue(a.getEstadoClase(e.estado)),g(),j(" ",e.estado.charAt(0).toUpperCase()+e.estado.slice(1)," "),g(2),j(" ",e.especialidadNombre," "),g(5),j(" ",a.formatearFecha(e.fechaHora)," "),g(5),O(a.formatearHora(e.fechaHora)),g(3),R(o.rol==="paciente"?20:21)}}function Fe(s,i){if(s&1&&(t(0,"div",22),me(1,Ve,24,7,"div",39,Me),n()),s&2){let e=_(3);g(),pe(e.proximosTurnos())}}function Le(s,i){if(s&1){let e=G();t(0,"button",50),z("click",function(){L(e);let a=_(3);return H(a.navegarA("solicitar-turnos"))}),t(1,"mat-icon",12),r(2,"add_circle"),n(),t(3,"div",51)(4,"p",52),r(5,"Solicitar Turno"),n(),t(6,"p",53),r(7,"Agenda una nueva cita"),n()()(),t(8,"button",50),z("click",function(){L(e);let a=_(3);return H(a.navegarA("mis-turnos-paciente"))}),t(9,"mat-icon",12),r(10,"list_alt"),n(),t(11,"div",51)(12,"p",52),r(13,"Mis Turnos"),n(),t(14,"p",53),r(15,"Ver historial completo"),n()()(),t(16,"button",50),z("click",function(){L(e);let a=_(3);return H(a.navegarA("perfil-paciente"))}),t(17,"mat-icon",12),r(18,"account_circle"),n(),t(19,"div",51)(20,"p",52),r(21,"Mi Perfil"),n(),t(22,"p",53),r(23,"Editar informaci\xF3n"),n()()()}}function He(s,i){if(s&1){let e=G();t(0,"button",50),z("click",function(){L(e);let a=_(3);return H(a.navegarA("mis-turnos-especialista"))}),t(1,"mat-icon",12),r(2,"event_note"),n(),t(3,"div",51)(4,"p",52),r(5,"Mis Turnos"),n(),t(6,"p",53),r(7,"Ver agenda completa"),n()()(),t(8,"button",50),z("click",function(){L(e);let a=_(3);return H(a.navegarA("pacientes"))}),t(9,"mat-icon",12),r(10,"people"),n(),t(11,"div",51)(12,"p",52),r(13,"Mis Pacientes"),n(),t(14,"p",53),r(15,"Ver historial cl\xEDnico"),n()()(),t(16,"button",50),z("click",function(){L(e);let a=_(3);return H(a.navegarA("perfil-especialista"))}),t(17,"mat-icon",12),r(18,"account_circle"),n(),t(19,"div",51)(20,"p",52),r(21,"Mi Perfil"),n(),t(22,"p",53),r(23,"Configurar horarios"),n()()()}}function ze(s,i){s&1&&(t(0,"li",54)(1,"mat-icon",55),r(2,"check_circle"),n(),t(3,"span"),r(4,"Record\xE1 confirmar tus turnos con 24hs de anticipaci\xF3n"),n()(),t(5,"li",54)(6,"mat-icon",55),r(7,"check_circle"),n(),t(8,"span"),r(9,"Pod\xE9s cancelar turnos hasta 12hs antes"),n()(),t(10,"li",54)(11,"mat-icon",55),r(12,"check_circle"),n(),t(13,"span"),r(14,"No olvides completar las encuestas de satisfacci\xF3n"),n()())}function Qe(s,i){s&1&&(t(0,"li",54)(1,"mat-icon",55),r(2,"check_circle"),n(),t(3,"span"),r(4,"Revis\xE1 tu agenda diariamente"),n()(),t(5,"li",54)(6,"mat-icon",55),r(7,"check_circle"),n(),t(8,"span"),r(9,"Complet\xE1 el registro m\xE9dico de cada consulta"),n()(),t(10,"li",54)(11,"mat-icon",55),r(12,"check_circle"),n(),t(13,"span"),r(14,"Manten\xE9 actualizada tu disponibilidad horaria"),n()())}function Ne(s,i){if(s&1&&(t(0,"div",6)(1,"div",9)(2,"div",10)(3,"div",11)(4,"mat-icon",12),r(5,"event_available"),n(),t(6,"span",13),r(7),n()(),t(8,"p",14),r(9),n()(),t(10,"div",15)(11,"div",11)(12,"mat-icon",12),r(13,"today"),n(),t(14,"span",13),r(15),n()(),t(16,"p",14),r(17,"Turnos Hoy"),n()(),t(18,"div",16)(19,"div",11)(20,"mat-icon",12),r(21,"calendar_month"),n(),t(22,"span",13),r(23),n()(),t(24,"p",14),r(25),n()()(),t(26,"div",17)(27,"div",18)(28,"h2",19)(29,"mat-icon",20),r(30,"event_note"),n(),r(31," Pr\xF3ximos Turnos "),n()(),I(32,Ie,6,2,"div",21)(33,Fe,3,0,"div",22),n(),t(34,"div",17)(35,"h2",23)(36,"mat-icon",20),r(37,"flash_on"),n(),r(38," Acciones R\xE1pidas "),n(),t(39,"div",9),I(40,Le,24,0)(41,He,24,0),n()(),t(42,"div",24)(43,"div",25)(44,"div",26)(45,"mat-icon",27),r(46,"info"),n(),t(47,"h3",28),r(48," Informaci\xF3n Importante "),n()(),t(49,"ul",29),I(50,ze,15,0)(51,Qe,15,0),n()(),t(52,"div",30)(53,"div",26)(54,"mat-icon",31),r(55,"contact_support"),n(),t(56,"h3",28),r(57," \xBFNecesit\xE1s Ayuda? "),n()(),t(58,"p",32),r(59," Nuestro equipo est\xE1 disponible para asistirte con cualquier consulta o inconveniente. "),n(),t(60,"div",29)(61,"div",33)(62,"mat-icon",34),r(63,"email"),n(),t(64,"span"),r(65,"soporte@clinica.com"),n()(),t(66,"div",33)(67,"mat-icon",34),r(68,"phone"),n(),t(69,"span"),r(70,"0800-123-4567"),n()()()()()()),s&2){let e=_(),o=_();g(7),O(o.resumen().turnosPendientes),g(2),j(" ",e.rol==="paciente"?"Turnos Pendientes":"Turnos por Atender"," "),g(6),O(o.resumen().turnosHoy),g(8),O(o.resumen().turnosMes),g(2),j(" ",e.rol==="paciente"?"Turnos Este Mes":"Atendidos Este Mes"," "),g(7),R(o.proximosTurnos().length===0?32:33),g(8),R(e.rol==="paciente"?40:e.rol==="especialista"?41:-1),g(10),R(e.rol==="paciente"?50:51)}}function Oe(s,i){if(s&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),r(4),n(),t(5,"p",4),r(6),n()(),I(7,De,5,0,"div",5)(8,Ne,71,8,"div",6),n()()),s&2){let e=_();g(4),j(" \xA1Bienvenido/a, ",i.nombre,"! "),g(2),O(e.getFechaActual()),g(),R(e.cargando()?7:8)}}var le=class s{constructor(i,e,o,a){this.authSupabase=i;this.turnosService=e;this.router=o;this.loading=a;this.usuario$=this.authSupabase.user$}usuario$;usuarioActual=null;realtimeChannel;proximosTurnos=X([]);resumen=X({turnosPendientes:0,turnosHoy:0,turnosMes:0});cargando=X(!0);ngOnInit(){return p(this,null,function*(){this.usuarioActual=yield ce(this.usuario$),this.usuarioActual&&(yield this.cargarDatos(),this.suscribirseACambiosCitas())})}ngOnDestroy(){this.realtimeChannel&&T.removeChannel(this.realtimeChannel)}suscribirseACambiosCitas(){if(!this.usuarioActual?.id)return;let i=this.usuarioActual.id,e=this.usuarioActual.rol;this.realtimeChannel=T.channel("citas-changes").on("postgres_changes",{event:"*",schema:"public",table:"citas",filter:e==="paciente"?`paciente_id=eq.${i}`:`especialista_id=eq.${i}`},()=>{this.cargarDatos()}).subscribe()}cargarDatos(){return p(this,null,function*(){if(this.usuarioActual?.id){this.cargando.set(!0);try{let i=[];this.usuarioActual.rol==="paciente"?i=yield this.turnosService.obtenerCitasPaciente(this.usuarioActual.id):this.usuarioActual.rol==="especialista"&&(i=yield this.turnosService.obtenerCitasEspecialista(this.usuarioActual.id)),this.proximosTurnos.set(this.turnosService.obtenerProximosTurnos(i,3));let e=this.turnosService.calcularResumenActividad(i);this.resumen.set({turnosPendientes:e.turnosPendientes,turnosHoy:e.turnosHoy,turnosMes:e.turnosMes})}catch(i){console.error("Error al cargar datos:",i)}finally{this.cargando.set(!1)}}})}formatearFecha(i){return new Date(i).toLocaleDateString("es-AR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}getFechaActual(){return new Date().toLocaleDateString("es-AR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}formatearHora(i){return new Date(i).toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit"})}getEstadoClase(i){return{solicitado:"bg-yellow-100 text-yellow-800",aceptado:"bg-green-100 text-green-800",rechazado:"bg-red-100 text-red-800",cancelado:"bg-gray-100 text-gray-800",realizado:"bg-blue-100 text-blue-800",completado:"bg-blue-100 text-blue-800"}[i]||"bg-gray-100 text-gray-800"}navegarA(i){i!=="mis-turnos-especialista"&&i!=="pacientes"&&i!=="mis-turnos-paciente"&&this.loading.show();let e=`/home/${i}`;if(this.router.url===e){i!=="mis-turnos-especialista"&&this.loading.hide();return}this.router.navigate([e])}static \u0275fac=function(e){return new(e||s)(Y(ae),Y(ve),Y(fe),Y(Z))};static \u0275cmp=b({type:s,selectors:[["app-entrada"]],decls:2,vars:3,consts:[[1,"h-full","w-full","p-1"],[1,"h-full","w-full","overflow-auto","rounded-2xl","border","border-white","bg-crema","p-6","shadow-inner"],[1,"mb-6"],[1,"mb-2","text-3xl","font-bold","text-azul-oscuro"],[1,"text-gray-600"],[1,"flex","items-center","justify-center","py-12"],[1,"mx-auto","max-w-6xl","space-y-6"],[1,"text-center"],[1,"mx-auto","mb-4","h-12","w-12","animate-spin","rounded-full","border-4","border-azul-oscuro","border-t-transparent"],[1,"grid","grid-cols-1","gap-4","md:grid-cols-2","lg:grid-cols-3"],[1,"rounded-lg","bg-gradient-to-br","from-blue-500","to-blue-600","p-4","text-white","shadow-md","transition-transform","hover:scale-105"],[1,"mb-2","flex","items-center","justify-between"],[1,"text-3xl"],[1,"text-3xl","font-bold"],[1,"text-sm","font-medium"],[1,"rounded-lg","bg-gradient-to-br","from-green-500","to-green-600","p-4","text-white","shadow-md","transition-transform","hover:scale-105"],[1,"rounded-lg","bg-gradient-to-br","from-purple-500","to-purple-600","p-4","text-white","shadow-md","transition-transform","hover:scale-105"],[1,"rounded-lg","bg-white","p-6","shadow-md"],[1,"mb-4","flex","items-center","justify-between"],[1,"text-2xl","font-semibold","text-azul-oscuro"],[1,"mr-2","align-middle"],[1,"py-8","text-center","text-gray-500"],[1,"space-y-3"],[1,"mb-4","text-2xl","font-semibold","text-azul-oscuro"],[1,"grid","grid-cols-1","gap-4","md:grid-cols-2"],[1,"rounded-lg","bg-blue-50","p-6","shadow-md"],[1,"mb-3","flex","items-center","gap-2"],[1,"text-2xl","text-blue-600"],[1,"text-lg","font-semibold","text-azul-oscuro"],[1,"space-y-2","text-sm","text-gray-700"],[1,"rounded-lg","bg-green-50","p-6","shadow-md"],[1,"text-2xl","text-green-600"],[1,"mb-3","text-sm","text-gray-700"],[1,"flex","items-center","gap-2"],[1,"text-sm","text-green-600"],[1,"mb-2","text-5xl","text-gray-300"],[1,"text-lg"],[1,"mt-4","rounded-lg","bg-azul-oscuro","px-6","py-2","font-medium","text-white","transition-colors","hover:bg-blue-700"],[1,"mt-4","rounded-lg","bg-azul-oscuro","px-6","py-2","font-medium","text-white","transition-colors","hover:bg-blue-700",3,"click"],[1,"rounded-lg","border","border-gray-200","bg-gray-50","p-4","transition-shadow","hover:shadow-md"],[1,"flex","items-start","justify-between"],[1,"flex-1"],[1,"mb-2","flex","items-center","gap-3"],[1,"rounded-full","px-3","py-1","text-xs","font-semibold"],[1,"text-sm","font-medium","text-gray-700"],[1,"mb-2","flex","items-center","gap-2","text-gray-700"],[1,"font-medium"],[1,"flex","items-center","gap-2","text-gray-600"],[1,"mx-2"],[1,"rounded-lg","bg-azul-oscuro","px-4","py-2","text-sm","font-medium","text-white","transition-colors","hover:bg-blue-700",3,"click"],[1,"flex","items-center","gap-3","rounded-lg","border-2","border-azul-oscuro","bg-white","p-4","transition-all","hover:bg-azul-oscuro","hover:text-white",3,"click"],[1,"text-left"],[1,"font-semibold"],[1,"text-sm","opacity-75"],[1,"flex","items-start","gap-2"],[1,"text-sm","text-blue-600"]],template:function(e,o){if(e&1&&(I(0,Oe,9,3,"div",0),ee(1,"async")),e&2){let a;R((a=te(1,1,o.usuario$))?0:-1,a)}},dependencies:[ne,ge,he,ie],encapsulation:2})};function je(s,i){s&1&&C(0,"app-home")}function $e(s,i){s&1&&C(0,"app-entrada")}function Be(s,i){s&1&&I(0,je,1,0,"app-home")(1,$e,1,0,"app-entrada"),s&2&&R(i.rol==="admin"?0:1)}var xe=class s{constructor(i){this.authSupabase=i;this.usuario$=this.authSupabase.user$}usuario$;loading=S(Z);ngAfterViewInit(){setTimeout(()=>{this.loading.hide()},0)}static \u0275fac=function(e){return new(e||s)(Y(ae))};static \u0275cmp=b({type:s,selectors:[["app-home-router"]],decls:2,vars:3,template:function(e,o){if(e&1&&(I(0,Be,2,1),ee(1,"async")),e&2){let a;R((a=te(1,1,o.usuario$))?0:-1,a)}},dependencies:[ne,se,le,ie],encapsulation:2})};export{xe as HomeRouter};

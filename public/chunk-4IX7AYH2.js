import{a as Ne,b as je,c as qe,d as De}from"./chunk-VECELFGG.js";import"./chunk-BO4ZDUNU.js";import{a as Me,b as Be,f as Ae,i as ke,j as Pe,k as Oe}from"./chunk-UTZVYCSF.js";import{f as Ie,g as Ve,n as Te}from"./chunk-K57SLITR.js";import{a as Re}from"./chunk-LAA3L6D3.js";import{a as X,b as Y}from"./chunk-E5ORBMNA.js";import"./chunk-ICAC2HSA.js";import"./chunk-AQT7K737.js";import"./chunk-GMNSTVT4.js";import{b as _e}from"./chunk-QE3RF6SY.js";import{f as he}from"./chunk-VNRMIUI5.js";import"./chunk-QQX64FUM.js";import{b as K,c as b,e as Q,f as ve,h as ye,i as be,j as xe,l as Fe,m as Ee,t as Se,u as Ce,v as we}from"./chunk-M22NWZ4Q.js";import{e as $,f as fe,g as Z,l as J}from"./chunk-V3F5M33P.js";import{$b as k,Ab as O,Cb as T,Ja as se,Ka as m,Ob as de,Pa as z,Qb as p,Rb as me,Sb as G,Ub as pe,Va as U,Vb as ue,Wb as ge,Y as ne,_a as E,ab as ce,ba as q,ca as D,da as le,nb as c,ob as l,pb as o,qb as M,wb as W}from"./chunk-PO4THZAS.js";import{c as oe,f as ie,h as Xe,j as N}from"./chunk-TWZW5B45.js";var ze=ie(()=>{"use strict"});var Le=ie((ee,He)=>{"use strict";(function(r,t){typeof ee=="object"?He.exports=ee=t():typeof define=="function"&&define.amd?define([],t):r.CryptoJS=t()})(ee,function(){var r=r||function(t,e){var n;if(typeof window<"u"&&window.crypto&&(n=window.crypto),typeof self<"u"&&self.crypto&&(n=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(n=globalThis.crypto),!n&&typeof window<"u"&&window.msCrypto&&(n=window.msCrypto),!n&&typeof global<"u"&&global.crypto&&(n=global.crypto),!n&&typeof oe=="function")try{n=ze()}catch{}var d=function(){if(n){if(typeof n.getRandomValues=="function")try{return n.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof n.randomBytes=="function")try{return n.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},g=Object.create||function(){function i(){}return function(s){var h;return i.prototype=s,h=new i,i.prototype=null,h}}(),y={},F=y.lib={},P=F.Base=function(){return{extend:function(i){var s=g(this);return i&&s.mixIn(i),(!s.hasOwnProperty("init")||this.init===s.init)&&(s.init=function(){s.$super.init.apply(this,arguments)}),s.init.prototype=s,s.$super=this,s},create:function(){var i=this.extend();return i.init.apply(i,arguments),i},init:function(){},mixIn:function(i){for(var s in i)i.hasOwnProperty(s)&&(this[s]=i[s]);i.hasOwnProperty("toString")&&(this.toString=i.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),C=F.WordArray=P.extend({init:function(i,s){i=this.words=i||[],s!=e?this.sigBytes=s:this.sigBytes=i.length*4},toString:function(i){return(i||w).stringify(this)},concat:function(i){var s=this.words,h=i.words,u=this.sigBytes,x=i.sigBytes;if(this.clamp(),u%4)for(var v=0;v<x;v++){var A=h[v>>>2]>>>24-v%4*8&255;s[u+v>>>2]|=A<<24-(u+v)%4*8}else for(var V=0;V<x;V+=4)s[u+V>>>2]=h[V>>>2];return this.sigBytes+=x,this},clamp:function(){var i=this.words,s=this.sigBytes;i[s>>>2]&=4294967295<<32-s%4*8,i.length=t.ceil(s/4)},clone:function(){var i=P.clone.call(this);return i.words=this.words.slice(0),i},random:function(i){for(var s=[],h=0;h<i;h+=4)s.push(d());return new C.init(s,i)}}),S=y.enc={},w=S.Hex={stringify:function(i){for(var s=i.words,h=i.sigBytes,u=[],x=0;x<h;x++){var v=s[x>>>2]>>>24-x%4*8&255;u.push((v>>>4).toString(16)),u.push((v&15).toString(16))}return u.join("")},parse:function(i){for(var s=i.length,h=[],u=0;u<s;u+=2)h[u>>>3]|=parseInt(i.substr(u,2),16)<<24-u%8*4;return new C.init(h,s/2)}},R=S.Latin1={stringify:function(i){for(var s=i.words,h=i.sigBytes,u=[],x=0;x<h;x++){var v=s[x>>>2]>>>24-x%4*8&255;u.push(String.fromCharCode(v))}return u.join("")},parse:function(i){for(var s=i.length,h=[],u=0;u<s;u++)h[u>>>2]|=(i.charCodeAt(u)&255)<<24-u%4*8;return new C.init(h,s)}},_=S.Utf8={stringify:function(i){try{return decodeURIComponent(escape(R.stringify(i)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(i){return R.parse(unescape(encodeURIComponent(i)))}},f=F.BufferedBlockAlgorithm=P.extend({reset:function(){this._data=new C.init,this._nDataBytes=0},_append:function(i){typeof i=="string"&&(i=_.parse(i)),this._data.concat(i),this._nDataBytes+=i.sigBytes},_process:function(i){var s,h=this._data,u=h.words,x=h.sigBytes,v=this.blockSize,A=v*4,V=x/A;i?V=t.ceil(V):V=t.max((V|0)-this._minBufferSize,0);var a=V*v,L=t.min(a*4,x);if(a){for(var H=0;H<a;H+=v)this._doProcessBlock(u,H);s=u.splice(0,a),h.sigBytes-=L}return new C.init(s,L)},clone:function(){var i=P.clone.call(this);return i._data=this._data.clone(),i},_minBufferSize:0}),I=F.Hasher=f.extend({cfg:P.extend(),init:function(i){this.cfg=this.cfg.extend(i),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(i){return this._append(i),this._process(),this},finalize:function(i){i&&this._append(i);var s=this._doFinalize();return s},blockSize:512/32,_createHelper:function(i){return function(s,h){return new i.init(h).finalize(s)}},_createHmacHelper:function(i){return function(s,h){return new B.HMAC.init(i,h).finalize(s)}}}),B=y.algo={};return y}(Math);return r})});var We=ie((te,Ue)=>{"use strict";(function(r,t){typeof te=="object"?Ue.exports=te=t(Le()):typeof define=="function"&&define.amd?define(["./core"],t):t(r.CryptoJS)})(te,function(r){return function(t){var e=r,n=e.lib,d=n.WordArray,g=n.Hasher,y=e.algo,F=[],P=[];(function(){function w(I){for(var B=t.sqrt(I),i=2;i<=B;i++)if(!(I%i))return!1;return!0}function R(I){return(I-(I|0))*4294967296|0}for(var _=2,f=0;f<64;)w(_)&&(f<8&&(F[f]=R(t.pow(_,1/2))),P[f]=R(t.pow(_,1/3)),f++),_++})();var C=[],S=y.SHA256=g.extend({_doReset:function(){this._hash=new d.init(F.slice(0))},_doProcessBlock:function(w,R){for(var _=this._hash.words,f=_[0],I=_[1],B=_[2],i=_[3],s=_[4],h=_[5],u=_[6],x=_[7],v=0;v<64;v++){if(v<16)C[v]=w[R+v]|0;else{var A=C[v-15],V=(A<<25|A>>>7)^(A<<14|A>>>18)^A>>>3,a=C[v-2],L=(a<<15|a>>>17)^(a<<13|a>>>19)^a>>>10;C[v]=V+C[v-7]+L+C[v-16]}var H=s&h^~s&u,Ze=f&I^f&B^I&B,Je=(f<<30|f>>>2)^(f<<19|f>>>13)^(f<<10|f>>>22),Ke=(s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25),ae=x+Ke+H+P[v]+C[v],Qe=Je+Ze;x=u,u=h,h=s,s=i+ae|0,i=B,B=I,I=f,f=ae+Qe|0}_[0]=_[0]+f|0,_[1]=_[1]+I|0,_[2]=_[2]+B|0,_[3]=_[3]+i|0,_[4]=_[4]+s|0,_[5]=_[5]+h|0,_[6]=_[6]+u|0,_[7]=_[7]+x|0},_doFinalize:function(){var w=this._data,R=w.words,_=this._nDataBytes*8,f=w.sigBytes*8;return R[f>>>5]|=128<<24-f%32,R[(f+64>>>9<<4)+14]=t.floor(_/4294967296),R[(f+64>>>9<<4)+15]=_,w.sigBytes=R.length*4,this._process(),this._hash},clone:function(){var w=g.clone.call(this);return w._hash=this._hash.clone(),w}});e.SHA256=g._createHelper(S),e.HmacSHA256=g._createHmacHelper(S)}(Math),r.SHA256})});var Ge=Xe(We());var it=(r,t)=>({"text-green-600":r,"text-red-600":t});function at(r,t){r&1&&(l(0,"div",10),le(),l(1,"svg",11),M(2,"circle",12)(3,"path",13),o()())}function ot(r,t){if(r&1&&(l(0,"p",14),p(1),o()),r&2){let e=T();c("ngClass",k(2,it,e.captchaValido,!e.captchaValido)),m(),G(" ",e.mensajeVerificacion," ")}}var re=class r{captchaResuelto=new ce;auth=ne(Y);captchas=[];captchaActual;userInput="";captchaValido=!1;mensajeVerificacion="";verificando=!1;cargado=!1;ngOnInit(){return N(this,null,function*(){yield this.cargarCaptchasDesdeSupabase()})}cargarCaptchasDesdeSupabase(){return N(this,null,function*(){if(this.captchas=yield this.auth.getCaptchas(),!this.captchas.length){console.error("No se pudieron cargar captchas");return}this.captchaActual=this.obtenerCaptchaAleatorio(),this.cargado=!0})}obtenerCaptchaAleatorio(){if(this.captchas.length<2)return this.captchas[0];let t;do{let e=Math.floor(Math.random()*this.captchas.length);t=this.captchas[e]}while(t===this.captchaActual);return t}verificarRespuesta(){return N(this,null,function*(){this.mensajeVerificacion="",this.verificando=!0,yield new Promise(e=>setTimeout(e,500));let t=(0,Ge.default)(this.userInput.trim().toLowerCase()).toString();this.captchaValido=t===this.captchaActual.answerHash,this.mensajeVerificacion=this.captchaValido?"\u2705 Respuesta correcta":"\u274C Respuesta incorrecta",this.verificando=!1,this.captchaResuelto.emit(this.captchaValido)})}cambiarCaptcha(){this.captchaActual=this.obtenerCaptchaAleatorio(),this.userInput="",this.mensajeVerificacion=""}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=U({type:r,selectors:[["app-mi-captcha"]],outputs:{captchaResuelto:"captchaResuelto"},decls:12,vars:9,consts:[[1,"relative","w-[300px]","items-center","justify-center","align-middle","text-sm"],["class","absolute inset-0 z-10 flex items-center justify-center bg-white/120 backdrop-blur-sm",4,"ngIf"],[1,"rounded-lg","border","border-gray-300","bg-crema","p-4","shadow-sm"],[1,"flex","flex-col","items-center","gap-2"],["alt","captcha",1,"h-24","w-full","rounded","border","bg-white","object-contain",3,"src"],["placeholder","Escrib\xED lo que ves",1,"w-full","rounded","border","border-gray-300","bg-white","px-3","py-1.5","focus:ring-2","focus:ring-azul-oscuro","focus:outline-none",3,"ngModelChange","ngModel","disabled"],[1,"flex","w-full","justify-between","gap-2"],[1,"flex-1","rounded","bg-verde-claro","px-3","py-1.5","text-lg","text-white","hover:bg-verde-claro/80","disabled:opacity-50",3,"click","disabled"],[1,"flex-1","rounded","bg-azul-claro","px-3","py-1.5","text-lg","text-white","hover:bg-azul-claro/80","disabled:opacity-50",3,"click","disabled"],["class","mt-1",3,"ngClass",4,"ngIf"],[1,"absolute","inset-0","z-10","flex","items-center","justify-center","bg-white/120","backdrop-blur-sm"],["viewBox","0 0 24 24","fill","none",1,"h-6","w-6","animate-spin","text-blue-600"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z",1,"opacity-75"],[1,"mt-1",3,"ngClass"]],template:function(e,n){e&1&&(l(0,"div",0),E(1,at,4,0,"div",1),l(2,"div",2)(3,"div",3),M(4,"img",4),l(5,"input",5),ge("ngModelChange",function(g){return ue(n.userInput,g)||(n.userInput=g),g}),o(),l(6,"div",6)(7,"button",7),O("click",function(){return n.verificarRespuesta()}),p(8," Verificar "),o(),l(9,"button",8),O("click",function(){return n.cambiarCaptcha()}),p(10," Cambiar "),o()(),E(11,ot,2,5,"p",9),o()()()),e&2&&(m(),c("ngIf",n.verificando||!n.cargado),m(2),de("opacity-50",n.verificando),m(),c("src",n.captchaActual.imagenUrl,se),m(),pe("ngModel",n.userInput),c("disabled",n.verificando),m(2),c("disabled",n.verificando),m(2),c("disabled",n.verificando),m(2),c("ngIf",n.mensajeVerificacion))},dependencies:[J,$,Z,Ce,K,Q,ye],encapsulation:2})};var j=(r,t)=>({"mat-form-field-valid":r,"mat-form-field-invalid":t});function nt(r,t){if(r&1){let e=W();l(0,"div",4)(1,"p",5),p(2,"\xBFQu\xE9 tipo de usuario sos?"),o(),l(3,"div",6)(4,"div",7),O("click",function(){q(e);let d=T();return D(d.seleccionarTipo("paciente"))}),l(5,"div",8),M(6,"img",9),l(7,"div",10)(8,"h3",11),p(9,"Paciente"),o()()()(),l(10,"div",7),O("click",function(){q(e);let d=T();return D(d.seleccionarTipo("especialista"))}),l(11,"div",8),M(12,"img",12),l(13,"div",10)(14,"h3",11),p(15,"Especialista"),o()()()()()()}}function lt(r,t){r&1&&(l(0,"mat-error"),p(1,"Campo obligatorio"),o())}function st(r,t){r&1&&(l(0,"mat-error"),p(1,"M\xEDnimo 2 caracteres"),o())}function ct(r,t){r&1&&(l(0,"mat-error"),p(1,"Solo letras"),o())}function dt(r,t){r&1&&(l(0,"mat-error"),p(1,"Campo obligatorio"),o())}function mt(r,t){r&1&&(l(0,"mat-error"),p(1,"M\xEDnimo 2 caracteres"),o())}function pt(r,t){r&1&&(l(0,"mat-error"),p(1,"Solo letras"),o())}function ut(r,t){r&1&&(l(0,"mat-error"),p(1,"Campo obligatorio"),o())}function gt(r,t){r&1&&(l(0,"mat-error"),p(1,"M\xEDnimo 18"),o())}function ft(r,t){r&1&&(l(0,"mat-error"),p(1,"M\xE1ximo 99"),o())}function _t(r,t){r&1&&(l(0,"mat-error"),p(1,"Campo obligatorio"),o())}function ht(r,t){r&1&&(l(0,"mat-error"),p(1,"Debe contener 8 d\xEDgitos"),o())}function vt(r,t){if(r&1&&(l(0,"mat-option",37),p(1),o()),r&2){let e=t.$implicit;c("value",e),m(),me(e)}}function yt(r,t){r&1&&(l(0,"mat-error"),p(1,"Campo obligatorio"),o())}function bt(r,t){if(r&1&&(l(0,"mat-form-field",15)(1,"mat-label"),p(2,"Obra Social"),o(),l(3,"mat-select",35),E(4,vt,2,2,"mat-option",36),o(),E(5,yt,2,0,"mat-error",17),o()),r&2){let e,n,d=T(2);c("ngClass",k(3,j,((e=d.registroForm.get("obraSocial"))==null?null:e.valid)&&(((e=d.registroForm.get("obraSocial"))==null?null:e.dirty)||((e=d.registroForm.get("obraSocial"))==null?null:e.touched)),((e=d.registroForm.get("obraSocial"))==null?null:e.invalid)&&(((e=d.registroForm.get("obraSocial"))==null?null:e.dirty)||((e=d.registroForm.get("obraSocial"))==null?null:e.touched)))),m(4),c("ngForOf",d.obraSocialOptions),m(),c("ngIf",(n=d.registroForm.get("obraSocial"))==null?null:n.hasError("required"))}}function xt(r,t){r&1&&(l(0,"mat-error"),p(1,"Campo obligatorio"),o())}function Ft(r,t){r&1&&(l(0,"mat-error"),p(1,"Email inv\xE1lido"),o())}function Et(r,t){r&1&&(l(0,"mat-error"),p(1,"Campo obligatorio"),o())}function St(r,t){r&1&&(l(0,"mat-error"),p(1,"M\xEDnimo 7 caracteres"),o())}function Ct(r,t){if(r&1&&(l(0,"mat-option",37),p(1),o()),r&2){let e=t.$implicit;c("value",e),m(),G(" ",e.nombre," ")}}function wt(r,t){r&1&&(l(0,"mat-error"),p(1,"Campo obligatorio"),o())}function Rt(r,t){if(r&1&&(l(0,"mat-form-field",15)(1,"mat-label"),p(2,"Especialidad"),o(),l(3,"mat-select",38),E(4,Ct,2,2,"mat-option",36),o(),E(5,wt,2,0,"mat-error",17),o()),r&2){let e,n,d=T(2);c("ngClass",k(3,j,((e=d.registroForm.get("especialidad"))==null?null:e.valid)&&(((e=d.registroForm.get("especialidad"))==null?null:e.dirty)||((e=d.registroForm.get("especialidad"))==null?null:e.touched)),((e=d.registroForm.get("especialidad"))==null?null:e.invalid)&&(((e=d.registroForm.get("especialidad"))==null?null:e.dirty)||((e=d.registroForm.get("especialidad"))==null?null:e.touched)))),m(4),c("ngForOf",d.especialidadOptions),m(),c("ngIf",(n=d.registroForm.get("especialidad"))==null?null:n.hasError("required"))}}function It(r,t){r&1&&(l(0,"mat-error"),p(1,"Campo obligatorio"),o())}function Vt(r,t){r&1&&(l(0,"mat-error"),p(1,"M\xEDnimo 2 caracteres"),o())}function Tt(r,t){r&1&&(l(0,"mat-error"),p(1,"Solo letras"),o())}function Mt(r,t){if(r&1&&(l(0,"mat-form-field",15)(1,"mat-label"),p(2,"Otra Especialidad"),o(),M(3,"input",39),E(4,It,2,0,"mat-error",17)(5,Vt,2,0,"mat-error",17)(6,Tt,2,0,"mat-error",17),o()),r&2){let e,n,d,g,y,F=T(2);c("ngClass",k(5,j,((e=F.registroForm.get("otraEspecialidad"))==null?null:e.valid)&&(((e=F.registroForm.get("otraEspecialidad"))==null?null:e.dirty)||((e=F.registroForm.get("otraEspecialidad"))==null?null:e.touched)),((e=F.registroForm.get("otraEspecialidad"))==null?null:e.invalid)&&(((e=F.registroForm.get("otraEspecialidad"))==null?null:e.dirty)||((e=F.registroForm.get("otraEspecialidad"))==null?null:e.touched)))),m(3),c("disabled",!((n=F.registroForm.get("otraEspecialidad"))!=null&&n.enabled)),m(),c("ngIf",(d=F.registroForm.get("otraEspecialidad"))==null?null:d.hasError("required")),m(),c("ngIf",(g=F.registroForm.get("otraEspecialidad"))==null?null:g.hasError("minlength")),m(),c("ngIf",(y=F.registroForm.get("otraEspecialidad"))==null?null:y.hasError("pattern"))}}function Bt(r,t){r&1&&(l(0,"mat-error"),p(1," Debe seleccionar una imagen de perfil. "),o())}function At(r,t){r&1&&(l(0,"mat-error"),p(1," Solo se permiten archivos .jpg o .png "),o())}function kt(r,t){r&1&&(l(0,"mat-error"),p(1," Debe seleccionar una imagen de fondo. "),o())}function Pt(r,t){r&1&&(l(0,"mat-error"),p(1," Solo se permiten archivos .jpg o .png "),o())}function Ot(r,t){if(r&1){let e=W();l(0,"div",24)(1,"label",25),p(2,"Foto Fondo"),o(),l(3,"input",26),O("change",function(d){q(e);let g=T(2);return D(g.onFileSelected(d,"fondo"))}),o(),E(4,kt,2,0,"mat-error",17)(5,Pt,2,0,"mat-error",17),o()}if(r&2){let e,n,d=T(2);m(4),c("ngIf",(e=d.registroForm.get("imagenFondo"))==null?null:e.hasError("required")),m(),c("ngIf",(n=d.registroForm.get("imagen"))==null?null:n.hasError("invalidType"))}}function Nt(r,t){r&1&&(l(0,"div",40),p(1," Debe resolver correctamente el CAPTCHA. "),o())}function jt(r,t){if(r&1){let e=W();l(0,"div",13)(1,"form",14),O("ngSubmit",function(){q(e);let d=T();return D(d.registrar())}),l(2,"mat-form-field",15)(3,"mat-label"),p(4,"Nombre"),o(),M(5,"input",16),E(6,lt,2,0,"mat-error",17)(7,st,2,0,"mat-error",17)(8,ct,2,0,"mat-error",17),o(),l(9,"mat-form-field",15)(10,"mat-label"),p(11,"Apellido"),o(),M(12,"input",18),E(13,dt,2,0,"mat-error",17)(14,mt,2,0,"mat-error",17)(15,pt,2,0,"mat-error",17),o(),l(16,"mat-form-field",15)(17,"mat-label"),p(18,"Edad"),o(),M(19,"input",19),E(20,ut,2,0,"mat-error",17)(21,gt,2,0,"mat-error",17)(22,ft,2,0,"mat-error",17),o(),l(23,"mat-form-field",15)(24,"mat-label"),p(25,"DNI"),o(),M(26,"input",20),E(27,_t,2,0,"mat-error",17)(28,ht,2,0,"mat-error",17),o(),E(29,bt,6,6,"mat-form-field",21),l(30,"mat-form-field",15)(31,"mat-label"),p(32,"Email"),o(),M(33,"input",22),E(34,xt,2,0,"mat-error",17)(35,Ft,2,0,"mat-error",17),o(),l(36,"mat-form-field",15)(37,"mat-label"),p(38,"Contrase\xF1a"),o(),M(39,"input",23),E(40,Et,2,0,"mat-error",17)(41,St,2,0,"mat-error",17),o(),E(42,Rt,6,6,"mat-form-field",21)(43,Mt,7,8,"mat-form-field",21),l(44,"div",24)(45,"label",25),p(46,"Foto Perfil"),o(),l(47,"input",26),O("change",function(d){q(e);let g=T();return D(g.onFileSelected(d,"perfil"))}),o(),E(48,Bt,2,0,"mat-error",17)(49,At,2,0,"mat-error",17),o(),E(50,Ot,6,2,"div",27),l(51,"div",28)(52,"button",29)(53,"span"),p(54,"Registrarse"),o()()(),l(55,"div",30)(56,"button",31),O("click",function(){q(e);let d=T();return D(d.tipoUsuario=null)}),p(57," Cambiar tipo de usuario "),o()(),l(58,"div",32),E(59,Nt,2,0,"div",33),l(60,"app-mi-captcha",34),O("captchaResuelto",function(d){q(e);let g=T();return D(g.onCaptchaResuelto(d))}),o()()()()}if(r&2){let e,n,d,g,y,F,P,C,S,w,R,_,f,I,B,i,s,h,u,x,v,A,V,a=T();m(),c("formGroup",a.registroForm),m(),c("ngClass",k(30,j,((e=a.registroForm.get("nombre"))==null?null:e.valid)&&(((e=a.registroForm.get("nombre"))==null?null:e.dirty)||((e=a.registroForm.get("nombre"))==null?null:e.touched)),((e=a.registroForm.get("nombre"))==null?null:e.invalid)&&(((e=a.registroForm.get("nombre"))==null?null:e.dirty)||((e=a.registroForm.get("nombre"))==null?null:e.touched)))),m(4),c("ngIf",(n=a.registroForm.get("nombre"))==null?null:n.hasError("required")),m(),c("ngIf",(d=a.registroForm.get("nombre"))==null?null:d.hasError("minlength")),m(),c("ngIf",(g=a.registroForm.get("nombre"))==null?null:g.hasError("pattern")),m(),c("ngClass",k(33,j,((y=a.registroForm.get("apellido"))==null?null:y.valid)&&(((y=a.registroForm.get("apellido"))==null?null:y.dirty)||((y=a.registroForm.get("apellido"))==null?null:y.touched)),((y=a.registroForm.get("apellido"))==null?null:y.invalid)&&(((y=a.registroForm.get("apellido"))==null?null:y.dirty)||((y=a.registroForm.get("apellido"))==null?null:y.touched)))),m(4),c("ngIf",(F=a.registroForm.get("apellido"))==null?null:F.hasError("required")),m(),c("ngIf",(P=a.registroForm.get("apellido"))==null?null:P.hasError("minlength")),m(),c("ngIf",(C=a.registroForm.get("apellido"))==null?null:C.hasError("pattern")),m(),c("ngClass",k(36,j,((S=a.registroForm.get("edad"))==null?null:S.valid)&&(((S=a.registroForm.get("edad"))==null?null:S.dirty)||((S=a.registroForm.get("edad"))==null?null:S.touched)),((S=a.registroForm.get("edad"))==null?null:S.invalid)&&(((S=a.registroForm.get("edad"))==null?null:S.dirty)||((S=a.registroForm.get("edad"))==null?null:S.touched)))),m(4),c("ngIf",(w=a.registroForm.get("edad"))==null?null:w.hasError("required")),m(),c("ngIf",(R=a.registroForm.get("edad"))==null?null:R.hasError("min")),m(),c("ngIf",(_=a.registroForm.get("edad"))==null?null:_.hasError("max")),m(),c("ngClass",k(39,j,((f=a.registroForm.get("dni"))==null?null:f.valid)&&(((f=a.registroForm.get("dni"))==null?null:f.dirty)||((f=a.registroForm.get("dni"))==null?null:f.touched)),((f=a.registroForm.get("dni"))==null?null:f.invalid)&&(((f=a.registroForm.get("dni"))==null?null:f.dirty)||((f=a.registroForm.get("dni"))==null?null:f.touched)))),m(4),c("ngIf",(I=a.registroForm.get("dni"))==null?null:I.hasError("required")),m(),c("ngIf",(B=a.registroForm.get("dni"))==null?null:B.hasError("pattern")),m(),c("ngIf",a.tipoUsuario==="paciente"),m(),c("ngClass",k(42,j,((i=a.registroForm.get("mail"))==null?null:i.valid)&&(((i=a.registroForm.get("mail"))==null?null:i.dirty)||((i=a.registroForm.get("mail"))==null?null:i.touched)),((i=a.registroForm.get("mail"))==null?null:i.invalid)&&(((i=a.registroForm.get("mail"))==null?null:i.dirty)||((i=a.registroForm.get("mail"))==null?null:i.touched)))),m(4),c("ngIf",(s=a.registroForm.get("mail"))==null?null:s.hasError("required")),m(),c("ngIf",(h=a.registroForm.get("mail"))==null?null:h.hasError("email")),m(),c("ngClass",k(45,j,((u=a.registroForm.get("password"))==null?null:u.valid)&&(((u=a.registroForm.get("password"))==null?null:u.dirty)||((u=a.registroForm.get("password"))==null?null:u.touched)),((u=a.registroForm.get("password"))==null?null:u.invalid)&&(((u=a.registroForm.get("password"))==null?null:u.dirty)||((u=a.registroForm.get("password"))==null?null:u.touched)))),m(4),c("ngIf",(x=a.registroForm.get("password"))==null?null:x.hasError("required")),m(),c("ngIf",(v=a.registroForm.get("password"))==null?null:v.hasError("minlength")),m(),c("ngIf",a.tipoUsuario==="especialista"),m(),c("ngIf",a.tipoUsuario==="especialista"),m(5),c("ngIf",(A=a.registroForm.get("imagenPerfil"))==null?null:A.hasError("required")),m(),c("ngIf",(V=a.registroForm.get("imagen"))==null?null:V.hasError("invalidType")),m(),c("ngIf",a.tipoUsuario==="paciente"),m(2),c("disabled",a.registroForm.invalid),m(7),c("ngIf",(a.registroForm.errors==null?null:a.registroForm.errors.captchaInvalido)&&a.registroForm.touched)}}var $e=class r{constructor(t,e,n,d,g){this.fb=t;this.auth=e;this.snackBar=n;this.router=d;this.loading=g}registroForm;tipoUsuario=null;obraSocialOptions=De;especialidadOptions=[];captchaEsValido=!1;captchaValidoValidator=()=>t=>this.captchaEsValido?null:{captchaInvalido:!0};subEspecialidad;ngOnInit(){return N(this,null,function*(){try{this.loading.show(),this.especialidadOptions=yield this.auth.obtenerEspecialidades(),this.especialidadOptions.push({id:-1,nombre:"Otra"}),this.registroForm=this.fb.group({nombre:["",[b.required,b.minLength(2),b.pattern(/^[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+$/)]],apellido:["",[b.required,b.minLength(2),b.pattern(/^[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+$/)]],edad:[null,[b.required,b.min(18),b.max(99)]],dni:["",[b.required,b.pattern(/^\d{8}$/)]],obraSocial:[""],mail:["",[b.required,b.email]],password:["",[b.required,b.minLength(7)]],especialidad:[""],otraEspecialidad:[{value:"",disabled:!0},[b.minLength(2),b.pattern(/^[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+$/)]],imagenPerfil:[null,b.required],imagenFondo:[""]},{validators:this.captchaValidoValidator()}),this.subEspecialidad=this.registroForm.get("especialidad").valueChanges.subscribe(t=>{let e=this.registroForm.get("otraEspecialidad");t?.id===-1?(e.enable(),e.setValidators([b.required,b.minLength(2),b.pattern(/^[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+$/)])):(e.disable(),e.clearValidators()),e.updateValueAndValidity()})}catch{}finally{this.loading.hide()}})}ngOnDestroy(){this.subEspecialidad.unsubscribe()}seleccionarTipo(t){if(this.tipoUsuario=t,!!this.registroForm){if(t==="paciente")this.registroForm.get("obraSocial")?.setValidators([b.required]),this.registroForm.get("imagenFondo")?.setValidators([b.required]),this.registroForm.get("especialidad")?.clearValidators(),this.registroForm.get("otraEspecialidad")?.clearValidators();else{this.registroForm.get("obraSocial")?.clearValidators(),this.registroForm.get("especialidad")?.setValidators([b.required]);let e=this.registroForm.get("otraEspecialidad");this.registroForm.get("especialidad")?.value!=="Otra"&&(e.disable(),e.clearValidators())}this.registroForm.get("obraSocial")?.updateValueAndValidity(),this.registroForm.get("especialidad")?.updateValueAndValidity(),this.registroForm.get("otraEspecialidad")?.updateValueAndValidity()}}onFileSelected(t,e){let n=e==="perfil"?"imagenPerfil":"imagenFondo",d=t.target,g=this.registroForm.get(n);if(!d.files?.length){g.setValue(null),g.setErrors({required:!0});return}let y=d.files[0];if(!["image/jpeg","image/png","image/jpg"].includes(y.type)){g.setErrors({invalidType:!0});return}g.setValue(y),g.setErrors(null)}registrar(){return N(this,null,function*(){if(!(this.registroForm.invalid||!this.tipoUsuario)){this.loading.show();try{this.tipoUsuario==="paciente"?yield this.handleRegistroPaciente():yield this.handleRegistroEspecialista()}finally{this.loading.hide()}}})}handleRegistroPaciente(){return N(this,null,function*(){try{let t=this.registroForm.value,e=yield X(t.imagenPerfil),n=yield X(t.imagenFondo),d={nombre:t.nombre,apellido:t.apellido,edad:t.edad,dni:t.dni,obraSocial:t.obraSocial,mail:t.mail,contrasena:t.password,imagenPerfil:e,imagenFondo:n},g=yield this.auth.registerPaciente(d),y=g.errorCode?.toLowerCase();console.log(g.errorCode),y?.includes("error desconocido")?this.mostrarResultado(g.success,g.message):this.mostrarResultado(g.success,g.errorCode)}catch{this.mostrarResultado(!1,"Error al procesar las im\xE1genes.")}})}handleRegistroEspecialista(){return N(this,null,function*(){try{let t=this.registroForm.value,e=yield X(t.imagenPerfil),n=t.especialidad.id===-1?t.otraEspecialidad:t.especialidad.nombre,d={nombre:t.nombre,apellido:t.apellido,edad:t.edad,dni:t.dni,mail:t.mail,contrasena:t.password,especialidad:n,imagenPerfil:e},g=yield this.auth.registerEspecialista(d);g.errorCode?.toLowerCase()?.includes("error desconocido")?this.mostrarResultado(g.success,g.message):this.mostrarResultado(g.success,g.errorCode)}catch{this.mostrarResultado(!1,"Error al procesar la imagen.")}})}mostrarResultado(t,e){if(!t){this.snackBar.open(e||"Ocurri\xF3 un error.","Cerrar",{duration:4e3,panelClass:["bg-red-600","text-white"]});return}this.tipoUsuario=null,this.router.navigate(["/welcome-page/confirmacion"])}onCaptchaResuelto(t){this.captchaEsValido=t,this.registroForm.updateValueAndValidity()}static \u0275fac=function(e){return new(e||r)(z(Se),z(Y),z(Te),z(_e),z(Re))};static \u0275cmp=U({type:r,selectors:[["app-register"]],decls:5,vars:2,consts:[[1,"min-h-screen","bg-gray-200","pt-30","pb-60"],[1,"pb-1","text-center","text-4xl","font-bold","text-azul-oscuro"],["class","pt-16 pb-30 text-center",4,"ngIf"],["class","flex justify-center py-8",4,"ngIf"],[1,"pt-16","pb-30","text-center"],[1,"mb-6","text-xl","text-gray-700"],[1,"flex","flex-col","items-center","gap-6"],[1,"w-[315px]","cursor-pointer","p-2","transition-transform","hover:scale-105",3,"click"],[1,"rounded-2xl","bg-white","shadow-lg"],["src","assets/imagenes/Registro/pacientes.jpg","alt","Paciente",1,"h-50","w-full","rounded-t-2xl","object-cover"],[1,"p-4"],[1,"text-xl","font-bold","text-azul-oscuro"],["src","assets/imagenes/Registro/especialistas.jpg","alt","Especialista",1,"h-50","w-full","rounded-t-2xl","object-cover"],[1,"flex","justify-center","py-8"],[1,"grid","w-full","max-w-2xl","grid-cols-1","gap-4","rounded-xl","bg-crema","p-8","shadow-lg","md:grid-cols-2",3,"ngSubmit","formGroup"],["appearance","fill",1,"col-span-1",3,"ngClass"],["matInput","","formControlName","nombre"],[4,"ngIf"],["matInput","","formControlName","apellido"],["matInput","","type","number","formControlName","edad"],["matInput","","formControlName","dni"],["appearance","fill","class","col-span-1",3,"ngClass",4,"ngIf"],["matInput","","type","email","formControlName","mail"],["matInput","","type","password","formControlName","password"],[1,"col-span-2","flex","flex-col","gap-2"],[1,"font-semibold","text-azul-oscuro"],["type","file","accept","image/*",1,"register-input",3,"change"],["class","col-span-2 flex flex-col gap-2",4,"ngIf"],[1,"col-span-2","flex","justify-center","pt-4"],["mat-raised-button","","color","primary","type","submit",1,"flex","items-center","justify-center","gap-2","rounded-full","bg-verde-oscuro","px-8","py-2","text-white","shadow-lg",3,"disabled"],[1,"col-span-2","mt-1","flex","justify-center"],["mat-button","","type","button",1,"text-sm","text-gray-600","underline",3,"click"],[1,"col-span-2","mt-1","flex","flex-col","items-center"],["class","mb-2 text-center text-sm text-red-600",4,"ngIf"],[3,"captchaResuelto"],["formControlName","obraSocial"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["formControlName","especialidad"],["matInput","","formControlName","otraEspecialidad",3,"disabled"],[1,"mb-2","text-center","text-sm","text-red-600"]],template:function(e,n){e&1&&(l(0,"div",0)(1,"h2",1),p(2,"Registro"),o(),E(3,nt,16,0,"div",2)(4,jt,61,48,"div",3),o()),e&2&&(m(3),c("ngIf",!n.tipoUsuario&&n.registroForm),m(),c("ngIf",n.tipoUsuario&&n.registroForm))},dependencies:[J,$,fe,Z,we,be,K,xe,Q,ve,Fe,Ee,ke,Ae,Me,Be,Oe,Pe,qe,je,Ne,Ve,Ie,he,re],styles:[".register-input[_ngcontent-%COMP%]{padding:12px 20px;margin:10px 0;border:2px solid #333;border-radius:6px;background-color:#222;color:#fff;font-size:16px;cursor:pointer;transition:all .3s ease}.register-input[_ngcontent-%COMP%]:hover{border-color:#92cc34;background-color:#2c2c2c}.register-input[_ngcontent-%COMP%]:focus{border-color:#19b44d;background-color:#2c2c2c;outline:none}.register-input[_ngcontent-%COMP%]::-webkit-file-upload-button{background-color:#fff;color:#fff;padding:8px 15px;border-radius:4px;border:none;cursor:pointer;font-size:14px;transition:background-color .3s ease}"]})};export{$e as Register};

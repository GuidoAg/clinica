import{a as H}from"./chunk-WSULEND5.js";import{n as le}from"./chunk-ZTAJVVXQ.js";import{b as ne}from"./chunk-ZSNERKQC.js";import"./chunk-QU5QNJKE.js";import"./chunk-X5YLR3NI.js";import"./chunk-Q4YNZBQ2.js";import"./chunk-HICRNNMR.js";import{b as ee,c as W,g as D,j as N,l as te,m as ie,u as re,v as ae,w as P,x as oe}from"./chunk-T6NMK5EM.js";import{e as I,i as Z,j as $,k as B}from"./chunk-M3XRSK3P.js";import{Db as p,Fb as d,Oa as l,P as Q,Qb as X,Ta as O,Tb as c,Ub as A,Vb as v,Xb as h,Yb as f,Z as k,Za as T,Zb as b,bc as y,ca as u,cc as z,da as m,eb as K,ec as R,f as J,fc as q,gc as Y,na as w,nb as _,ob as x,pb as F,qb as M,rb as S,sb as g,tb as a,ub as o,zb as C}from"./chunk-7RTQA4J5.js";import{i as V}from"./chunk-ODN5LVDJ.js";var pe=n=>({"max-w-3xl p-10":n}),E=n=>({"border-red-500 ring-red-300":n}),ge=(n,r)=>({"bg-indigo-600 hover:bg-indigo-800":n,"bg-gray-400":r});function _e(n,r){if(n&1){let e=C();a(0,"button",11),p("click",function(){u(e);let t=d(2);return m(t.mostrarFormularioCancelar=!0)}),c(1," Cancelar turno "),o()}}function xe(n,r){if(n&1){let e=C();a(0,"button",12),p("click",function(){u(e);let t=d(2);return m(t.mostrarFormularioRechazar=!0)}),c(1," Rechazar turno "),o()}}function Ce(n,r){if(n&1){let e=C();a(0,"button",13),p("click",function(){u(e);let t=d(2);return m(t.mostrarFormularioAceptar=!0)}),c(1," Aceptar turno "),o()}}function he(n,r){if(n&1){let e=C();a(0,"button",14),p("click",function(){u(e);let t=d(2);return m(t.mostrarFormularioFinalizar=!0)}),c(1," Finalizar turno "),o()}}function fe(n,r){if(n&1){let e=C();a(0,"button",15),p("click",function(){u(e);let t=d(2);return m(t.verResenia())}),c(1," Ver rese\xF1a "),o()}}function be(n,r){if(n&1){let e=C();a(0,"button",16),p("click",function(){u(e);let t=d(2);return m(t.mostrarFormularioHistoriaClinica=!0)}),c(1," Cargar historia cl\xEDnica "),o()}}function ve(n,r){if(n&1&&(a(0,"div",2),_(1,_e,2,0,"button",5),_(2,xe,2,0,"button",6),_(3,Ce,2,0,"button",7),_(4,he,2,0,"button",8),_(5,fe,2,0,"button",9),_(6,be,2,0,"button",10),o()),n&2){let e=d();l(),x(e.puedeCancelar?1:-1),l(),x(e.puedeRechazar?2:-1),l(),x(e.puedeAceptar?3:-1),l(),x(e.puedeFinalizar?4:-1),l(),x(e.puedeVerResenia?5:-1),l(),x(e.puedeCargarHistoriaClinica?6:-1)}}function ye(n,r){if(n&1){let e=C();a(0,"div",2)(1,"textarea",17),b("ngModelChange",function(t){u(e);let s=d();return f(s.comentarioCancelar,t)||(s.comentarioCancelar=t),m(t)}),o(),a(2,"div",18)(3,"button",19),p("click",function(){u(e);let t=d();return m(t.cancelarAccionCancelar())}),c(4," Cancelar "),o(),a(5,"button",20),p("click",function(){u(e);let t=d();return m(t.confirmarCancelarTurno())}),c(6," Confirmar cancelaci\xF3n "),o()()()}if(n&2){let e=d();l(),h("ngModel",e.comentarioCancelar),l(4),g("disabled",!e.comentarioCancelar.trim()||e.cargando())}}function we(n,r){if(n&1){let e=C();a(0,"div",2)(1,"textarea",21),b("ngModelChange",function(t){u(e);let s=d();return f(s.comentarioRechazar,t)||(s.comentarioRechazar=t),m(t)}),o(),a(2,"div",18)(3,"button",19),p("click",function(){u(e);let t=d();return m(t.cancelarAccionRechazar())}),c(4," Cancelar "),o(),a(5,"button",20),p("click",function(){u(e);let t=d();return m(t.confirmarRechazarTurno())}),c(6," Confirmar Rechazo "),o()()()}if(n&2){let e=d();l(),h("ngModel",e.comentarioRechazar),l(4),g("disabled",!e.comentarioRechazar.trim()||e.cargando())}}function Ee(n,r){if(n&1){let e=C();a(0,"div",2)(1,"div",18)(2,"button",19),p("click",function(){u(e);let t=d();return m(t.cancelarAccionAceptar())}),c(3," Cancelar "),o(),a(4,"button",22),p("click",function(){u(e);let t=d();return m(t.confirmarAceptarTurno())}),c(5," Confirmar Aceptar "),o()()()}}function Fe(n,r){if(n&1){let e=C();a(0,"div",2)(1,"textarea",23),b("ngModelChange",function(t){u(e);let s=d();return f(s.reseniaFinalizar,t)||(s.reseniaFinalizar=t),m(t)}),o(),a(2,"div",18)(3,"button",19),p("click",function(){u(e);let t=d();return m(t.cancelarAccionFinalizar())}),c(4," Cancelar "),o(),a(5,"button",24),p("click",function(){u(e);let t=d();return m(t.confirmarFinalizarTurno())}),c(6," Confirmar Finalizar "),o()()()}if(n&2){let e=d();l(),h("ngModel",e.reseniaFinalizar),l(4),g("disabled",!e.reseniaFinalizar.trim()||e.cargando())}}function Me(n,r){if(n&1){let e=C();a(0,"div",3)(1,"h3",25),c(2," Rese\xF1a "),o(),a(3,"p",26),c(4),o(),a(5,"button",27),p("click",function(){u(e);let t=d();return m(t.volverDesdeVistaResenia())}),c(6," Volver "),o()()}if(n&2){let e=d();l(4),v(" ",e.cita.resenia||"No se ha dejado una rese\xF1a para este turno."," ")}}function Se(n,r){if(n&1){let e=C();a(0,"div",39)(1,"div")(2,"label",57),c(3),o(),a(4,"input",58),b("ngModelChange",function(t){let s=u(e).$implicit;return f(s.clave,t)||(s.clave=t),m(t)}),o()(),a(5,"div")(6,"label",57),c(7,"Valor"),o(),a(8,"input",58),b("ngModelChange",function(t){let s=u(e).$implicit;return f(s.valor,t)||(s.valor=t),m(t)}),o()()()}if(n&2){let e=r.$implicit,i=r.$index;l(2),g("for","clave-texto-"+i),l(),v("Clave #",i+1),l(),g("id","clave-texto-"+i),h("ngModel",e.clave),l(2),g("for","valor-texto-"+i),l(2),g("id","valor-texto-"+i),h("ngModel",e.valor)}}function Ve(n,r){if(n&1){let e=C();a(0,"div",4)(1,"h3",28),c(2," Cargar historia cl\xEDnica "),o(),a(3,"div",29)(4,"div")(5,"label",30),c(6,"Altura (cm)"),o(),a(7,"input",31),b("ngModelChange",function(t){u(e);let s=d();return f(s.registro.alturaCm,t)||(s.registro.alturaCm=t),m(t)}),o()(),a(8,"div")(9,"label",32),c(10,"Peso (kg)"),o(),a(11,"input",33),b("ngModelChange",function(t){u(e);let s=d();return f(s.registro.pesoKg,t)||(s.registro.pesoKg=t),m(t)}),o()(),a(12,"div")(13,"label",34),c(14,"Temperatura (\xB0C)"),o(),a(15,"input",35),b("ngModelChange",function(t){u(e);let s=d();return f(s.registro.temperaturaC,t)||(s.registro.temperaturaC=t),m(t)}),o()(),a(16,"div")(17,"label",36),c(18,"Presi\xF3n arterial"),o(),a(19,"input",37),b("ngModelChange",function(t){u(e);let s=d();return f(s.registro.presionArterial,t)||(s.registro.presionArterial=t),m(t)}),o()()(),a(20,"div",38)(21,"div",4),M(22,Se,9,7,"div",39,F),o(),a(24,"div",40)(25,"div",29)(26,"div")(27,"label",41),c(28,"Clave slider"),o(),a(29,"input",42),b("ngModelChange",function(t){u(e);let s=d();return f(s.datoSlider.clave,t)||(s.datoSlider.clave=t),m(t)}),o()(),a(30,"div")(31,"label",43),c(32),o(),a(33,"input",44),b("ngModelChange",function(t){u(e);let s=d();return f(s.datoSlider.valor,t)||(s.datoSlider.valor=t),m(t)}),o()()(),a(34,"div",29)(35,"div")(36,"label",45),c(37,"Clave num\xE9rica"),o(),a(38,"input",46),b("ngModelChange",function(t){u(e);let s=d();return f(s.datoNumero.clave,t)||(s.datoNumero.clave=t),m(t)}),o()(),a(39,"div")(40,"label",47),c(41,"Valor"),o(),a(42,"input",48),b("ngModelChange",function(t){u(e);let s=d();return f(s.datoNumero.valor,t)||(s.datoNumero.valor=t),m(t)}),o()()(),a(43,"div",49)(44,"div")(45,"label",50),c(46,"Clave boolean"),o(),a(47,"input",51),b("ngModelChange",function(t){u(e);let s=d();return f(s.datoBoolean.clave,t)||(s.datoBoolean.clave=t),m(t)}),o()(),a(48,"div",52)(49,"input",53),b("ngModelChange",function(t){u(e);let s=d();return f(s.datoBoolean.valor,t)||(s.datoBoolean.valor=t),m(t)}),o(),a(50,"span",54),c(51,"S\xED / No"),o()()()()(),a(52,"div",55)(53,"button",56),p("click",function(){u(e);let t=d();return m(t.guardarHistoriaClinica())}),c(54," Guardar historia cl\xEDnica "),o()()()}if(n&2){let e=d();l(7),h("ngModel",e.registro.alturaCm),g("ngClass",y(21,E,!e.registro.alturaCm)),l(4),h("ngModel",e.registro.pesoKg),g("ngClass",y(23,E,!e.registro.pesoKg)),l(4),h("ngModel",e.registro.temperaturaC),g("ngClass",y(25,E,!e.registro.temperaturaC)),l(4),h("ngModel",e.registro.presionArterial),g("ngClass",y(27,E,!e.registro.presionArterial.trim())),l(3),S(e.datosTexto),l(7),h("ngModel",e.datoSlider.clave),g("ngClass",y(29,E,!e.datoSlider.clave.trim())),l(3),v(" Valor (0\u2013100): ",e.datoSlider.valor," "),l(),h("ngModel",e.datoSlider.valor),l(5),h("ngModel",e.datoNumero.clave),g("ngClass",y(31,E,!e.datoNumero.clave.trim())),l(4),h("ngModel",e.datoNumero.valor),g("ngClass",y(33,E,e.datoNumero.valor===null)),l(5),h("ngModel",e.datoBoolean.clave),g("ngClass",y(35,E,!e.datoBoolean.clave.trim())),l(2),h("ngModel",e.datoBoolean.valor),l(4),g("disabled",e.cargando()||!e.esFormularioHistoriaClinicaValido())("ngClass",z(37,ge,e.esFormularioHistoriaClinicaValido()&&!e.cargando(),!e.esFormularioHistoriaClinicaValido()||e.cargando()))}}var L=class n{cita;cerrar=new K;accionRealizada=new K;turnos=k(H);fb=k(ae);snackBar=k(le);cargando=w(!1);mostrarFormularioCancelar=!1;mostrarFormularioRechazar=!1;mostrarFormularioAceptar=!1;mostrarFormularioFinalizar=!1;mostrarFormularioResenia=!1;mostrarFormularioHistoriaClinica=!1;comentarioCancelar="";comentarioRechazar="";reseniaFinalizar="";get puedeCancelar(){return this.cita.estado!=="completado"&&this.cita.estado!=="cancelado"&&this.cita.estado!=="aceptado"&&this.cita.estado!=="rechazado"&&!this.mostrarFormularioCancelar&&!this.mostrarFormularioAceptar&&!this.mostrarFormularioFinalizar&&!this.mostrarFormularioRechazar&&!this.mostrarFormularioHistoriaClinica&&!this.mostrarFormularioResenia}get puedeRechazar(){return this.cita.estado!=="completado"&&this.cita.estado!=="cancelado"&&this.cita.estado!=="aceptado"&&this.cita.estado!=="rechazado"&&!this.mostrarFormularioCancelar&&!this.mostrarFormularioAceptar&&!this.mostrarFormularioFinalizar&&!this.mostrarFormularioRechazar&&!this.mostrarFormularioHistoriaClinica&&!this.mostrarFormularioResenia}get puedeAceptar(){return this.cita.estado!=="completado"&&this.cita.estado!=="cancelado"&&this.cita.estado!=="aceptado"&&this.cita.estado!=="rechazado"&&!this.mostrarFormularioCancelar&&!this.mostrarFormularioAceptar&&!this.mostrarFormularioFinalizar&&!this.mostrarFormularioRechazar&&!this.mostrarFormularioHistoriaClinica&&!this.mostrarFormularioResenia}get puedeFinalizar(){return this.cita.estado==="aceptado"&&!this.mostrarFormularioCancelar&&!this.mostrarFormularioAceptar&&!this.mostrarFormularioFinalizar&&!this.mostrarFormularioRechazar&&!this.mostrarFormularioHistoriaClinica&&!this.mostrarFormularioResenia}get puedeCargarHistoriaClinica(){return this.cita.estado==="completado"&&!this.yaTieneHistoriaClinica&&!this.mostrarFormularioCancelar&&!this.mostrarFormularioAceptar&&!this.mostrarFormularioFinalizar&&!this.mostrarFormularioRechazar&&!this.mostrarFormularioResenia&&!this.mostrarFormularioHistoriaClinica}get puedeVerResenia(){return!!this.cita.resenia&&this.cita.resenia.trim().length>0&&!this.mostrarFormularioCancelar&&!this.mostrarFormularioAceptar&&!this.mostrarFormularioFinalizar&&!this.mostrarFormularioRechazar&&!this.mostrarFormularioResenia&&!this.mostrarFormularioHistoriaClinica}get yaTieneHistoriaClinica(){return this.cita.alturaCm!==null&&this.cita.pesoKg!==null&&this.cita.temperaturaC!==null&&!!this.cita.presionArterial?.trim()}registro={alturaCm:0,pesoKg:0,temperaturaC:0,presionArterial:"",citaId:0};datosTexto=[{clave:"",valor:""},{clave:"",valor:""},{clave:"",valor:""}];datoSlider={clave:"",valor:50};datoNumero={clave:"",valor:null};datoBoolean={clave:"",valor:!1};cancelarAccionCancelar(){this.mostrarFormularioCancelar=!1,this.comentarioCancelar=""}confirmarCancelarTurno(){this.comentarioCancelar.trim()&&(this.cargando.set(!0),this.turnos.cancelarCitaEspecialista(this.cita,this.comentarioCancelar.trim()).then(r=>{this.cargando.set(!1),r.success?(this.snackBar.open("Turno cancelado exitosamente.","Cerrar",{duration:3e3}),this.accionRealizada.emit("cancelado"),this.cerrar.emit()):this.snackBar.open(r.message??"Ocurri\xF3 un error","Cerrar",{duration:4e3})}).finally(()=>{this.mostrarFormularioCancelar=!1,this.comentarioCancelar=""}))}cancelarAccionRechazar(){this.mostrarFormularioRechazar=!1,this.comentarioRechazar=""}confirmarRechazarTurno(){this.comentarioRechazar.trim()&&(this.cargando.set(!0),this.turnos.rechazarCitaEspecialista(this.cita,this.comentarioRechazar.trim()).then(r=>{this.cargando.set(!1),r.success?(this.snackBar.open("Turno rechazado exitosamente.","Cerrar",{duration:3e3}),this.accionRealizada.emit("rechazado"),this.cerrar.emit()):this.snackBar.open(r.message??"Ocurri\xF3 un error","Cerrar",{duration:4e3})}).finally(()=>{this.mostrarFormularioRechazar=!1,this.comentarioRechazar=""}))}cancelarAccionAceptar(){this.mostrarFormularioAceptar=!1}confirmarAceptarTurno(){this.cargando.set(!0),this.turnos.aceptarCitaEspecialista(this.cita).then(r=>{this.cargando.set(!1),r.success?(this.snackBar.open("Turno aceptado exitosamente.","Cerrar",{duration:3e3}),this.accionRealizada.emit("aceptado"),this.cerrar.emit()):this.snackBar.open(r.message??"Ocurri\xF3 un error","Cerrar",{duration:4e3})}).finally(()=>{this.mostrarFormularioAceptar=!1})}cancelarAccionFinalizar(){this.mostrarFormularioFinalizar=!1,this.reseniaFinalizar=""}confirmarFinalizarTurno(){this.reseniaFinalizar.trim()&&(this.cargando.set(!0),this.turnos.completarCitaEspecialista(this.cita,this.reseniaFinalizar.trim()).then(r=>{this.cargando.set(!1),r.success?(this.snackBar.open("Turno finalizado exitosamente.","Cerrar",{duration:3e3}),this.accionRealizada.emit("completado"),this.cerrar.emit()):this.snackBar.open(r.message??"Ocurri\xF3 un error","Cerrar",{duration:4e3})}).finally(()=>{this.mostrarFormularioFinalizar=!1,this.reseniaFinalizar=""}))}verResenia(){this.mostrarFormularioResenia=!0}volverDesdeVistaResenia(){this.mostrarFormularioResenia=!1}cancelarHistoriaClinica(){this.mostrarFormularioHistoriaClinica=!1}guardarHistoriaClinica(){return V(this,null,function*(){this.cargando.set(!0);let r=[...this.datosTexto.map(i=>({id:0,clave:i.clave,valor:i.valor,citaId:this.registro.citaId})),{id:0,clave:this.datoSlider.clave,valor:this.datoSlider.valor.toString(),citaId:this.registro.citaId},{id:0,clave:this.datoNumero.clave,valor:(this.datoNumero.valor??0).toString(),citaId:this.registro.citaId},{id:0,clave:this.datoBoolean.clave,valor:this.datoBoolean.valor?"S\xED":"No",citaId:this.registro.citaId}].filter(i=>i.clave&&i.valor);if(!this.registro.alturaCm||!this.registro.pesoKg||!this.registro.temperaturaC||!this.registro.presionArterial?.trim()||!this.datoSlider.clave.trim()||!this.datoNumero.clave.trim()||this.datoNumero.valor===null||!this.datoBoolean.clave.trim()){this.snackBar.open("Complet\xE1 todos los campos obligatorios","Cerrar",{duration:3e3});return}this.registro.citaId=this.cita.citaId;let e=yield this.turnos.cargarHistoriaClinica(this.registro,r);this.cargando.set(!1),e.success?(this.snackBar.open("Historia cl\xEDnica guardada","Cerrar",{duration:3e3}),this.accionRealizada.emit("historia_clinica"),this.cerrar.emit()):this.snackBar.open(e.message??"Error al guardar","Cerrar",{duration:4e3})})}esFormularioHistoriaClinicaValido(){let r=this.registro,e=this.datoSlider.clave.trim()!=="",i=this.datoNumero.clave.trim()!==""&&this.datoNumero.valor!==null,t=this.datoBoolean.clave.trim()!=="",s=this.datosTexto.every(j=>{let U=j.clave.trim(),G=j.valor.trim();return U&&G||!U&&!G});return r.alturaCm!==null&&r.pesoKg!==null&&r.temperaturaC!==null&&!!r.presionArterial?.trim()&&e&&i&&t&&s}cerrarModal(){this.cerrar.emit()}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=T({type:n,selectors:[["app-acciones-especialista"]],inputs:{cita:"cita"},outputs:{cerrar:"cerrar",accionRealizada:"accionRealizada"},decls:9,vars:10,consts:[["tabindex","0","role","button","aria-label","Cerrar modal",1,"fixed","inset-0","z-50","flex","items-center","justify-center","bg-black/50","backdrop-blur-sm",3,"click","keyup.enter"],["tabindex","0","role","dialog","aria-modal","true",1,"fixed","top-1/2","left-1/2","z-50","w-full","max-w-md","-translate-x-1/2","-translate-y-1/2","transform","rounded-2xl","bg-white","p-8","shadow-xl","transition-all","duration-300","md:max-w-3xl",3,"click","keyup","ngClass"],[1,"flex","flex-col","gap-3"],[1,"flex","flex-col","items-center","gap-4","text-center"],[1,"flex","flex-col","gap-4"],[1,"rounded-lg","bg-gray-500","px-4","py-2","font-semibold","text-white","transition-transform","hover:scale-105","hover:bg-gray-800"],[1,"rounded-lg","bg-red-500","px-4","py-2","font-semibold","text-white","transition-transform","hover:scale-105","hover:bg-red-700"],[1,"rounded-lg","bg-green-500","px-4","py-2","font-semibold","text-white","transition-transform","hover:scale-105","hover:bg-green-800"],[1,"rounded-lg","bg-blue-400","px-4","py-2","font-semibold","text-white","transition-transform","hover:scale-105","hover:bg-blue-800"],[1,"rounded-lg","bg-pink-400","px-4","py-2","font-semibold","text-white","transition-transform","hover:scale-105","hover:bg-pink-700"],[1,"rounded-lg","bg-indigo-500","px-4","py-2","font-semibold","text-white","transition-transform","hover:scale-105","hover:bg-indigo-700"],[1,"rounded-lg","bg-gray-500","px-4","py-2","font-semibold","text-white","transition-transform","hover:scale-105","hover:bg-gray-800",3,"click"],[1,"rounded-lg","bg-red-500","px-4","py-2","font-semibold","text-white","transition-transform","hover:scale-105","hover:bg-red-700",3,"click"],[1,"rounded-lg","bg-green-500","px-4","py-2","font-semibold","text-white","transition-transform","hover:scale-105","hover:bg-green-800",3,"click"],[1,"rounded-lg","bg-blue-400","px-4","py-2","font-semibold","text-white","transition-transform","hover:scale-105","hover:bg-blue-800",3,"click"],[1,"rounded-lg","bg-pink-400","px-4","py-2","font-semibold","text-white","transition-transform","hover:scale-105","hover:bg-pink-700",3,"click"],[1,"rounded-lg","bg-indigo-500","px-4","py-2","font-semibold","text-white","transition-transform","hover:scale-105","hover:bg-indigo-700",3,"click"],["placeholder","Ingrese el motivo de cancelaci\xF3n","rows","3",1,"w-full","resize-none","rounded","border","border-gray-300","px-3","py-2","text-sm","focus:ring-2","focus:ring-red-500","focus:outline-none",3,"ngModelChange","ngModel"],[1,"flex","justify-end","gap-3"],["type","button",1,"rounded","border","border-gray-400","px-4","py-2","text-sm","text-gray-700","hover:bg-gray-100",3,"click"],["type","button",1,"rounded","bg-red-600","px-4","py-2","text-sm","font-semibold","text-white","hover:bg-red-800","disabled:opacity-50",3,"click","disabled"],["placeholder","Ingrese el motivo de rechazo","rows","3",1,"w-full","resize-none","rounded","border","border-gray-300","px-3","py-2","text-sm","focus:ring-2","focus:ring-red-500","focus:outline-none",3,"ngModelChange","ngModel"],["type","button",1,"rounded","bg-green-500","px-4","py-2","text-sm","font-semibold","text-white","hover:bg-green-700","disabled:opacity-50",3,"click"],["placeholder","Ingrese una rese\xF1a","rows","3",1,"w-full","resize-none","rounded","border","border-gray-300","px-3","py-2","text-sm","focus:ring-2","focus:ring-pink-400","focus:outline-none",3,"ngModelChange","ngModel"],["type","button",1,"rounded","bg-pink-400","px-4","py-2","text-sm","font-semibold","text-white","hover:bg-pink-600","disabled:opacity-50",3,"click","disabled"],[1,"text-xl","font-bold","text-[color:var(--color-azul-oscuro)]"],[1,"px-2","text-gray-700","italic"],[1,"mt-4","rounded","bg-gray-300","px-4","py-2","text-sm","font-semibold","text-gray-800","hover:bg-gray-400",3,"click"],[1,"text-center","text-xl","font-bold","text-[color:var(--color-azul-oscuro)]"],[1,"grid","grid-cols-2","gap-4"],["for","altura",1,"mb-1","block","text-sm","font-medium","text-gray-700"],["id","altura","required","","type","number",1,"w-full","rounded-lg","border","px-3","py-2","text-sm","shadow-sm","transition","focus:border-indigo-500","focus:ring","focus:ring-indigo-300",3,"ngModelChange","ngModel","ngClass"],["for","peso",1,"mb-1","block","text-sm","font-medium","text-gray-700"],["id","peso","required","","type","number",1,"w-full","rounded-lg","border","px-3","py-2","text-sm","shadow-sm","transition","focus:border-indigo-500","focus:ring","focus:ring-indigo-300",3,"ngModelChange","ngModel","ngClass"],["for","temperatura",1,"mb-1","block","text-sm","font-medium","text-gray-700"],["id","temperatura","required","","type","number",1,"w-full","rounded-lg","border","px-3","py-2","text-sm","shadow-sm","transition","focus:border-indigo-500","focus:ring","focus:ring-indigo-300",3,"ngModelChange","ngModel","ngClass"],["for","presion",1,"mb-1","block","text-sm","font-medium","text-gray-700"],["id","presion","required","","type","text",1,"w-full","rounded-lg","border","px-3","py-2","text-sm","shadow-sm","transition","focus:border-indigo-500","focus:ring","focus:ring-indigo-300",3,"ngModelChange","ngModel","ngClass"],[1,"mt-6","grid","grid-cols-1","gap-6","md:grid-cols-2"],[1,"grid","grid-cols-2","gap-2"],[1,"mt-6","flex","flex-col","gap-6"],["for","clave-slider",1,"text-sm","font-medium","text-gray-700"],["id","clave-slider","required","","type","text",1,"w-full","rounded-lg","border","px-3","py-2","text-sm","shadow-sm","transition","focus:border-indigo-500","focus:ring","focus:ring-indigo-300",3,"ngModelChange","ngModel","ngClass"],["for","valor-slider",1,"text-sm","font-medium","text-gray-700"],["id","valor-slider","type","range","min","0","max","100",1,"w-full","accent-indigo-500",3,"ngModelChange","ngModel"],["for","clave-numero",1,"text-sm","font-medium","text-gray-700"],["id","clave-numero","required","","type","text",1,"w-full","rounded-lg","border","px-3","py-2","text-sm","shadow-sm","transition","focus:border-indigo-500","focus:ring","focus:ring-indigo-300",3,"ngModelChange","ngModel","ngClass"],["for","valor-numero",1,"text-sm","font-medium","text-gray-700"],["id","valor-numero","required","","type","number",1,"w-full","rounded-lg","border","px-3","py-2","text-sm","shadow-sm","transition","focus:border-indigo-500","focus:ring","focus:ring-indigo-300",3,"ngModelChange","ngModel","ngClass"],[1,"grid","grid-cols-2","items-center","gap-4"],["for","clave-boolean",1,"text-sm","font-medium","text-gray-700"],["id","clave-boolean","required","","type","text",1,"w-full","rounded-lg","border","px-3","py-2","text-sm","shadow-sm","transition","focus:border-indigo-500","focus:ring","focus:ring-indigo-300",3,"ngModelChange","ngModel","ngClass"],[1,"mt-6","flex","items-center","gap-2"],["type","checkbox",1,"h-5","w-5","accent-indigo-600",3,"ngModelChange","ngModel"],[1,"text-sm","text-gray-700"],[1,"mt-6","flex","justify-end","gap-4"],[1,"rounded-lg","px-4","py-2","text-sm","font-semibold","text-white","transition","disabled:cursor-not-allowed","disabled:opacity-50",3,"click","disabled","ngClass"],[1,"mb-1","block","text-sm","font-medium","text-gray-700",3,"for"],["type","text",1,"w-full","rounded-lg","border","border-gray-300","px-3","py-2","text-sm","shadow-sm","transition","focus:border-indigo-500","focus:ring","focus:ring-indigo-300",3,"ngModelChange","id","ngModel"]],template:function(e,i){e&1&&(a(0,"div",0),p("click",function(){return i.cerrarModal()})("keyup.enter",function(){return i.cerrarModal()}),o(),a(1,"div",1),p("click",function(s){return s.stopPropagation()})("keyup",function(s){return s.stopPropagation()}),_(2,ve,7,6,"div",2),_(3,ye,7,2,"div",2),_(4,we,7,2,"div",2),_(5,Ee,6,0,"div",2),_(6,Fe,7,2,"div",2),_(7,Me,7,1,"div",3),_(8,Ve,55,40,"div",4),o()),e&2&&(l(),g("ngClass",y(8,pe,i.mostrarFormularioHistoriaClinica)),l(),x(!i.mostrarFormularioCancelar&&!i.mostrarFormularioRechazar&&!i.mostrarFormularioAceptar&&!i.mostrarFormularioFinalizar&&!i.mostrarFormularioResenia?2:-1),l(),x(i.mostrarFormularioCancelar?3:-1),l(),x(i.mostrarFormularioRechazar?4:-1),l(),x(i.mostrarFormularioAceptar?5:-1),l(),x(i.mostrarFormularioFinalizar?6:-1),l(),x(i.mostrarFormularioResenia?7:-1),l(),x(i.mostrarFormularioHistoriaClinica?8:-1))},dependencies:[B,I,P,W,te,ie,ee,D,re,N,oe],encapsulation:2})};var ke=(n,r)=>({"cursor-pointer select-none hover:bg-[color:var(--color-azul-oscuro)] hover:text-white":n,"bg-[color:var(--color-azul-oscuro)]/80 text-white":r});function Te(n,r){if(n&1){let e=C();a(0,"app-acciones-especialista",11),p("cerrar",function(){u(e);let t=d();return m(t.cerrarPopupAcciones())})("accionRealizada",function(){u(e);let t=d();return m(t.accionDesdeModal())}),o()}if(n&2){let e=d();g("cita",e.citaSeleccionada())}}function Ae(n,r){if(n&1){let e=C();a(0,"th",12),p("click",function(){let t=u(e).$implicit,s=d();return m(s.filtroColumna.set(t.key))}),c(1),o()}if(n&2){let e=r.$implicit,i=d();g("ngClass",z(2,ke,e.key!=="datosDinamicos"&&e.key!=="acciones",i.filtroColumna()===e.key&&e.key!=="datosDinamicos"&&e.key!=="acciones")),l(),v(" ",e.label," ")}}function ze(n,r){if(n&1&&(a(0,"div")(1,"strong"),c(2),o(),c(3),o()),n&2){let e=r.$implicit;l(2),v("",e.clave,":"),l(),v(" ",e.valor)}}function Re(n,r){if(n&1&&(a(0,"tr")(1,"td",20)(2,"div",21),M(3,ze,4,2,"div",null,F),o()()()),n&2){let e=d().$implicit;l(3),S(e.datosDinamicos)}}function Ie(n,r){if(n&1){let e=C();a(0,"tr",13),p("click",function(){let t=u(e).$implicit,s=d(2);return m(s.toggleFilaExpandida(t.citaId))}),a(1,"td",14),c(2),o(),a(3,"td",14),c(4),R(5,"date"),o(),a(6,"td",15),c(7),R(8,"titlecase"),o(),a(9,"td",14),c(10),o(),a(11,"td",14),c(12),o(),a(13,"td",14),c(14),o(),a(15,"td",14),c(16),o(),a(17,"td",14),c(18),o(),a(19,"td",14),c(20),o(),a(21,"td",14),c(22),o(),a(23,"td",16)(24,"button",17),c(25),o()(),a(26,"td",18)(27,"button",19),p("click",function(){let t=u(e).$implicit,s=d(2);return m(s.abrirPopupAcciones(t))}),c(28," Acciones "),o()()(),_(29,Re,5,0,"tr")}if(n&2){let e=r.$implicit,i=d(2);X("background-color",i.filaExpandida()===e.citaId?"rgba(46, 64, 45, 0.2)":null),l(2),A(e.citaId),l(2),v(" ",Y(5,15,e.fechaHora,"short")," "),l(2),g("ngClass",i.estadoClaseMap[e.estado]??"bg-gray-100 text-gray-700"),l(),v(" ",q(8,18,e.estado)," "),l(3),A(e.alturaCm),l(2),A(e.pesoKg),l(2),v(" ",e.temperaturaC," "),l(2),v(" ",e.presionArterial," "),l(2),v(" ",e.pacienteNombreCompleto," "),l(2),v(" ",e.especialistaNombreCompleto," "),l(2),v(" ",e.especialidadNombre," "),l(3),v(" ",i.filaExpandida()===e.citaId?"Ocultar":"Mostrar"," "),l(4),x(i.filaExpandida()===e.citaId?29:-1)}}function Be(n,r){if(n&1&&M(0,Ie,30,20,null,null,F),n&2){let e=d();S(e.citasFiltradas)}}function We(n,r){n&1&&(a(0,"tr")(1,"td",22),c(2," Cargando datos... "),o()())}var se=class n{constructor(r,e){this.turnosService=r;this.authSupabase=e;this.usuario$=this.authSupabase.user$}usuario$;usuarioActual=null;destroy$=new J;citas=w([]);filaExpandida=w(null);cargando=w(!0);citaSeleccionada=w(null);mostrarPopupAcciones=!1;estadoClaseMap={solicitado:"bg-yellow-200 text-yellow-800",aceptado:"bg-green-200 text-green-800",rechazado:"bg-red-200 text-red-800",cancelado:"bg-gray-300 text-gray-800",completado:"bg-blue-200 text-blue-800"};columnas=[{key:"citaId",label:"ID"},{key:"fechaHora",label:"Fecha/Hora"},{key:"estado",label:"Estado"},{key:"alturaCm",label:"Altura (cm)"},{key:"pesoKg",label:"Peso (kg)"},{key:"temperaturaC",label:"Temp (\xB0C)"},{key:"presionArterial",label:"Presi\xF3n"},{key:"pacienteNombreCompleto",label:"Paciente"},{key:"especialistaNombreCompleto",label:"Especialista"},{key:"especialidadNombre",label:"Especialidad"}];columnasConDatosDinamicos=[...this.columnas,{key:"datosDinamicos",label:"Datos din\xE1micos"}];filtroColumna=w(null);_filtroValor=w("");get filtroValorModel(){return this._filtroValor()}set filtroValorModel(r){this._filtroValor.set(r)}ngOnInit(){return V(this,null,function*(){this.usuario$.pipe(Q(this.destroy$)).subscribe(r=>{if(!r){this.usuarioActual=null;return}r.id=typeof r.id=="string"?Number(r.id):r.id,this.usuarioActual=r,this.cargarCitas()})})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}cargarCitas(){return V(this,null,function*(){this.cargando.set(!0);try{if(this.usuarioActual?.id!=null){let r=yield this.turnosService.obtenerCitasEspecialista(this.usuarioActual.id);this.citas.set(r)}}catch(r){console.error("Error al obtener citas",r)}finally{this.cargando.set(!1)}})}toggleFilaExpandida(r){this.filaExpandida.set(this.filaExpandida()===r?null:r)}activarFiltro(r){this.filtroColumna.set(r),this._filtroValor.set("")}get citasFiltradas(){let r=this.filtroColumna(),e=this._filtroValor().toLowerCase();return!r||e.trim()===""?this.citas():this.citas().filter(i=>{let t=i[r];return t==null?!1:t instanceof Date?t.toLocaleString().toLowerCase().includes(e):t.toString().toLowerCase().includes(e)})}get filtroColumnaLabel(){return this.columnas.find(e=>e.key===this.filtroColumna())?.label??""}limpiarFiltro(){this.filtroColumna.set(""),this._filtroValor.set("")}mostrarAcciones(){this.filtroColumna.set(""),this._filtroValor.set("")}abrirPopupAcciones(r){this.citaSeleccionada.set(r),this.mostrarPopupAcciones=!0}cerrarPopupAcciones(){this.mostrarPopupAcciones=!1,this.citaSeleccionada.set(null)}accionDesdeModal(){this.cerrarPopupAcciones(),this.cargarCitas()}static \u0275fac=function(e){return new(e||n)(O(H),O(ne))};static \u0275cmp=T({type:n,selectors:[["app-mis-turnos-especialista"]],decls:19,vars:6,consts:[[1,"h-full","w-full","p-1"],[1,"h-full","w-full","overflow-auto","rounded-2xl","border","border-white","bg-[color:var(--color-crema)]","p-6","shadow-inner"],[1,"mb-4","flex","flex-wrap","items-center","gap-3"],["for","filtro",1,"text-sm","font-semibold","text-[color:var(--color-azul-oscuro)]"],["id","filtro","type","text","placeholder","Ingres\xE1 filtro",1,"w-64","rounded","border","border-gray-300","px-3","py-1","text-sm","focus:ring-2","focus:ring-[color:var(--color-azul-oscuro)]","focus:outline-none",3,"ngModelChange","ngModel"],["type","button",1,"rounded","bg-[color:var(--color-azul-oscuro)]","px-3","py-1","text-sm","font-semibold","text-white","shadow","transition-transform","hover:scale-105","hover:bg-[color:var(--color-azul-claro)]",3,"click"],[1,"ml-auto"],[3,"cita"],[1,"min-w-full","border-collapse","border","border-gray-300","text-sm"],[1,"bg-[color:var(--color-azul-claro)]","text-[color:var(--color-azul-oscuro)]"],[1,"cursor-pointer","border","border-gray-300","px-3","py-2","transition-colors","duration-200","select-none","hover:bg-[color:var(--color-azul-oscuro)]","hover:text-white",3,"ngClass"],[3,"cerrar","accionRealizada","cita"],[1,"cursor-pointer","border","border-gray-300","px-3","py-2","transition-colors","duration-200","select-none","hover:bg-[color:var(--color-azul-oscuro)]","hover:text-white",3,"click","ngClass"],[1,"cursor-pointer","border","border-gray-300","transition-colors","duration-150","hover:bg-[color:var(--color-verde-claro)]",3,"click"],[1,"border","border-gray-300","px-3","py-1"],[1,"rounded","border","border-gray-300","px-3","py-1","text-center","font-semibold",3,"ngClass"],[1,"border","border-gray-300","px-3","py-1","text-center"],["type","button",1,"text-[color:var(--color-azul-oscuro)]","underline","hover:text-[color:var(--color-azul-claro)]"],[1,"border","border-gray-300","bg-green-200","px-3","py-1","text-center","hover:bg-green-500"],["type","button",1,"font-bold","text-[color:var(--color-azul-oscuro)]","hover:text-[color:var(--color-white)]",3,"click"],["colspan","11",1,"border","border-gray-300","bg-[color:var(--color-crema)]","px-3","py-2","text-[color:var(--color-azul-oscuro)]"],[1,"grid","grid-cols-2","gap-4"],["colspan","11",1,"border","border-gray-300","px-3","py-6","text-center","font-semibold","text-[color:var(--color-azul-oscuro)]"]],template:function(e,i){e&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"label",3),c(4),R(5,"titlecase"),o(),a(6,"input",4),b("ngModelChange",function(s){return f(i.filtroValorModel,s)||(i.filtroValorModel=s),s}),o(),a(7,"button",5),p("click",function(){return i.limpiarFiltro()}),c(8," Limpiar "),o(),a(9,"div",6),_(10,Te,1,1,"app-acciones-especialista",7),o()(),a(11,"table",8)(12,"thead")(13,"tr",9),M(14,Ae,2,5,"th",10,F),o()(),a(16,"tbody"),_(17,Be,2,0)(18,We,3,0,"tr"),o()()()()),e&2&&(l(4),v(" Filtrar por ",q(5,4,i.filtroColumnaLabel),": "),l(2),h("ngModel",i.filtroValorModel),l(4),x(i.mostrarPopupAcciones&&i.citaSeleccionada()?10:-1),l(4),S(i.columnasConDatosDinamicos),l(3),x(i.cargando()?18:17))},dependencies:[B,I,P,W,D,N,L,Z,$],encapsulation:2})};export{se as MisTurnosEspecialista};

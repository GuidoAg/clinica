import{a as Be}from"./chunk-RTOFS77S.js";import{a as Pe,b as Le}from"./chunk-ISZQ6G3H.js";import"./chunk-GGQ7LRWG.js";import{d as He}from"./chunk-6FYFN6NE.js";import"./chunk-FK6H3RFT.js";import{c as Ae,d as Re,f as xe,g as ke}from"./chunk-P2GLRHRS.js";import{b as me}from"./chunk-VPTHVLTQ.js";import{b as q,c as U,h as ze,i as Ee,k as K}from"./chunk-YDT6XDAL.js";import"./chunk-LMZWYZYD.js";import{b as De}from"./chunk-FGBWPZOQ.js";import{f as Fe,g as Ve}from"./chunk-MYA2PN56.js";import{b as de,c as pe}from"./chunk-JYNQ7DY3.js";import"./chunk-FFHKXHWV.js";import{g as ce,j as Y}from"./chunk-DDKTLT4U.js";import{Ab as Q,Eb as P,Gb as _,Kb as I,Lb as M,Mb as D,Oa as l,Ta as Z,Tb as Te,U as Se,Ub as s,Vb as k,Wb as m,Xb as be,Z as y,Za as E,ca as S,da as T,dc as Ie,ea as O,fa as G,gc as d,hc as p,ic as Me,n as ye,na as $,nb as F,ob as V,rb as se,sb as le,tb as X,ub as n,vb as o,wb as b,xb as B,yb as H,zb as z}from"./chunk-PTIYVII4.js";import{a as te,b as ie,j as u}from"./chunk-K4ALXBGI.js";var A=class r{datosCache;datosCacheTimestamp;CACHE_DURATION_MS=180*1e3;precargarDatosEstadisticas(){return u(this,null,function*(){let t=Date.now();if(this.datosCache&&this.datosCacheTimestamp&&t-this.datosCacheTimestamp<this.CACHE_DURATION_MS)return;let[e,a,i,c]=yield Promise.all([q.from(U.CITAS).select("especialidad_id, paciente_id, especialista_id, estado, fecha_hora"),q.from(U.ESPECIALIDADES).select(ze.BASICO),q.from(U.ESPECIALISTA_ESPECIALIDADES).select("especialidad_id, perfil_id"),q.from(U.PERFILES).select("id, nombre, apellido, rol")]);if(e.error||!e.data){console.error("[Supabase] Error al precargar citas:",e.error?.message);return}if(a.error||!a.data){console.error("[Supabase] Error al precargar especialidades:",a.error?.message);return}if(i.error||!i.data){console.error("[Supabase] Error al precargar relaciones especialistas:",i.error?.message);return}if(c.error||!c.data){console.error("[Supabase] Error al precargar perfiles:",c.error?.message);return}let h=[...new Set(e.data.map(C=>C.especialista_id).filter(C=>C!==null))],f=c.data.filter(C=>h.includes(C.id));this.datosCache={citas:e.data,especialidades:a.data,relacionesEspecialistas:i.data,perfilesMedicos:f,perfilesCompletos:c.data},this.datosCacheTimestamp=t})}obtenerDatosCache(){return u(this,null,function*(){return yield this.precargarDatosEstadisticas(),this.datosCache})}obtenerLogIngresos(){return u(this,null,function*(){let[t,e]=yield Promise.all([q.from(U.REGISTRO_INGRESOS).select(Ee.BASICO).order("fecha_ingreso",{ascending:!1}),this.obtenerDatosCache()]);return t.error||!t.data?(console.error("[Supabase] Error al obtener log de ingresos:",t.error?.message),[]):t.data.map(a=>{let i=e.perfilesCompletos.find(c=>c.id===a.perfil_id);return{fecha:a.fecha_ingreso,nombre:i?.nombre??"Desconocido",apellido:i?.apellido??"",rol:i?.rol??"N/A"}})})}obtenerTurnosPorEspecialidad(){return u(this,null,function*(){let t=yield this.obtenerDatosCache(),e=[...new Set(t.citas.map(i=>i.especialidad_id).filter(i=>i!==null))],a=new Map;for(let i of t.citas)i.especialidad_id&&a.set(i.especialidad_id,(a.get(i.especialidad_id)??0)+1);return e.map(i=>({especialidad:t.especialidades.find(h=>h.id===i)?.nombre??"Sin especialidad",cantidad:a.get(i)??0}))})}obtenerPacientesPorEspecialidad(){return u(this,null,function*(){let t=yield this.obtenerDatosCache(),e=[...new Set(t.citas.map(i=>i.especialidad_id).filter(i=>i!==null))],a=new Map;for(let i of t.citas)!i.especialidad_id||!i.paciente_id||(a.has(i.especialidad_id)||a.set(i.especialidad_id,new Set),a.get(i.especialidad_id).add(i.paciente_id));return e.map(i=>{let c=t.especialidades.find(f=>f.id===i),h=a.get(i)?.size??0;return{especialidad:c?.nombre??"Sin especialidad",cantidad:h}})})}obtenerMedicosPorEspecialidad(){return u(this,null,function*(){let t=yield this.obtenerDatosCache(),e=[...new Set(t.relacionesEspecialistas.map(i=>i.especialidad_id).filter(i=>i!==null))],a=new Map;for(let i of t.relacionesEspecialistas)!i.especialidad_id||!i.perfil_id||(a.has(i.especialidad_id)||a.set(i.especialidad_id,new Set),a.get(i.especialidad_id).add(i.perfil_id));return e.map(i=>{let c=t.especialidades.find(f=>f.id===i),h=a.get(i)?.size??0;return{especialidad:c?.nombre??"Sin especialidad",cantidad:h}})})}obtenerCitasPorEstado(t){return u(this,null,function*(){let e=yield this.obtenerDatosCache(),a=t?e.citas.filter(c=>c.paciente_id===t):e.citas,i=new Map;for(let c of a)c.estado&&i.set(c.estado,(i.get(c.estado)??0)+1);return Object.values(Pe).map(c=>({estado:c,cantidad:i.get(c)??0}))})}obtenerPacientes(){return u(this,null,function*(){let t=yield this.obtenerDatosCache(),e=new Set(t.citas.map(a=>a.paciente_id).filter(a=>a!==null));return Array.from(e).map(a=>{let i=t.perfilesCompletos.find(c=>c.id===a);return i?{id:a,nombre:i.nombre??"",apellido:i.apellido??""}:null}).filter(a=>a!==null).sort((a,i)=>a.apellido.localeCompare(i.apellido))})}obtenerTurnosPorDia(){return u(this,null,function*(){let t=yield this.obtenerDatosCache(),e=new Map;for(let a of t.citas){let i=new Date(a.fecha_hora).toISOString().split("T")[0];e.set(i,(e.get(i)??0)+1)}return Array.from(e.entries()).map(([a,i])=>({fecha:a,cantidad:i})).sort((a,i)=>a.fecha.localeCompare(i.fecha))})}obtenerTurnosPorMedico(t,e){return u(this,null,function*(){let a=yield this.obtenerDatosCache(),i=a.citas.filter(c=>{if(!t||!e)return!0;let h=new Date(c.fecha_hora);return h>=new Date(t)&&h<=new Date(e)});return this.procesarTurnosPorMedico(i,a.perfilesMedicos,null)})}obtenerTurnosFinalizadosPorMedico(t,e){return u(this,null,function*(){let a=yield this.obtenerDatosCache(),i=a.citas.filter(c=>(!t||!e||new Date(c.fecha_hora)>=new Date(t)&&new Date(c.fecha_hora)<=new Date(e))&&c.estado==="completado");return this.procesarTurnosPorMedico(i,a.perfilesMedicos,null)})}procesarTurnosPorMedico(t,e,a){let i=a?t.filter(f=>f.estado===a):t,c=[...new Set(i.map(f=>f.especialista_id).filter(f=>f!==null))];if(c.length===0)return[];let h=new Map;for(let f of i)f.especialista_id&&h.set(f.especialista_id,(h.get(f.especialista_id)??0)+1);return c.map(f=>{let C=e.find(x=>x.id===f);return{nombre:C?`${C.nombre} ${C.apellido}`:"Desconocido",cantidad:h.get(f)??0}})}obtenerIngresosEspecialistas60Dias(){return u(this,null,function*(){return this.obtenerIngresosPorRol("especialista")})}obtenerIngresosPacientes60Dias(){return u(this,null,function*(){return this.obtenerIngresosPorRol("paciente")})}obtenerIngresosPorRol(t){return u(this,null,function*(){let e=new Date;e.setDate(e.getDate()-60);let a=e.toISOString(),[i,c]=yield Promise.all([q.from(U.REGISTRO_INGRESOS).select(Ee.BASICO).gte("fecha_ingreso",a).order("fecha_ingreso",{ascending:!0}),this.obtenerDatosCache()]);if(i.error||!i.data)return console.error(`[Supabase] Error al obtener ingresos de ${t}:`,i.error?.message),{datos:[],maxY:40};let h=new Set(c.perfilesCompletos.filter(g=>g.rol===t).map(g=>g.id)),f=i.data.filter(g=>h.has(g.perfil_id)),C=new Map;for(let g of f){let w=new Date(g.fecha_ingreso),L=`${w.getFullYear()}-${String(w.getMonth()+1).padStart(2,"0")}-${String(w.getDate()).padStart(2,"0")}`;C.set(L,(C.get(L)??0)+1)}let x=Array.from(C.entries()).map(([g,w])=>({fecha_hora:g,cantidad:w})),v=Math.max(...x.map(g=>g.cantidad),0),R=v===0?40:Math.ceil((v+1)/5)*5;return{datos:x,maxY:R}})}static \u0275fac=function(e){return new(e||r)};static \u0275prov=Se({token:r,factory:r.\u0275fac,providedIn:"root"})};var Oe=["canvas"],ae=class r{estadisticas=y(A);canvasRef;ngAfterViewInit(){return u(this,null,function*(){let{Chart:t,BarElement:e,BarController:a,CategoryScale:i,LinearScale:c,Tooltip:h,Legend:f}=yield import("./chunk-DPEENRGO.js");t.register(e,a,i,c,h,f);let C=this.canvasRef.nativeElement,x=yield this.estadisticas.obtenerTurnosPorDia(),v=x.map(g=>g.fecha),R=x.map(g=>g.cantidad);new t(C,{type:"bar",data:{labels:v,datasets:[{label:"Turnos por D\xEDa",data:R,backgroundColor:"rgba(54, 162, 235, 0.7)"}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{stepSize:1,precision:0}}}}})})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=E({type:r,selectors:[["app-turnos-por-dia-chart"]],viewQuery:function(e,a){if(e&1&&I(Oe,7),e&2){let i;M(i=D())&&(a.canvasRef=i.first)}},decls:2,vars:0,consts:[["canvas",""],[1,"mx-auto","h-64","w-full"]],template:function(e,a){e&1&&z(0,"canvas",1,0)},encapsulation:2})};var $e=["canvas"],ne=class r{estadisticas=y(A);chart;canvasRef;ngAfterViewInit(){this.render()}render(){return u(this,null,function*(){let{Chart:t,ArcElement:e,PieController:a,Tooltip:i,Legend:c}=yield import("./chunk-DPEENRGO.js");t.register(e,a,i,c);let h=yield this.estadisticas.obtenerTurnosPorEspecialidad(),f=h.map(v=>v.especialidad),C=h.map(v=>v.cantidad),x=this.canvasRef.nativeElement;this.chart?.destroy(),this.chart=new t(x,{type:"pie",data:{labels:f,datasets:[{label:"Turnos por Especialidad",data:C,backgroundColor:["rgba(255, 99, 132, 0.7)","rgba(54, 162, 235, 0.7)","rgba(255, 206, 86, 0.7)","rgba(75, 192, 192, 0.7)","rgba(153, 102, 255, 0.7)","rgba(255, 159, 64, 0.7)"],borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1}})})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=E({type:r,selectors:[["app-turnos-por-especialidad-chart"]],viewQuery:function(e,a){if(e&1&&I($e,7),e&2){let i;M(i=D())&&(a.canvasRef=i.first)}},decls:3,vars:0,consts:[["canvas",""],[1,"relative","h-64","w-full"],[1,"absolute","inset-0","h-full","w-full"]],template:function(e,a){e&1&&(B(0,"div",1),z(1,"canvas",2,0),H())},encapsulation:2})};var We=["canvas"],oe=class r{estadisticas=y(A);chart;canvasRef;render(t,e){return u(this,null,function*(){let{Chart:a,BarElement:i,BarController:c,CategoryScale:h,LinearScale:f,Tooltip:C,Legend:x}=yield import("./chunk-DPEENRGO.js");a.register(i,c,h,f,C,x);let v=yield this.estadisticas.obtenerTurnosPorMedico(t,e),R=v.map(L=>L.nombre),g=v.map(L=>L.cantidad),w=this.canvasRef.nativeElement;this.chart?.destroy(),this.chart=new a(w,{type:"bar",data:{labels:R,datasets:[{label:"Turnos por M\xE9dico",data:g,backgroundColor:"rgba(75, 192, 192, 0.7)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{stepSize:1,precision:0}}}}})})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=E({type:r,selectors:[["app-turnos-por-medico-chart"]],viewQuery:function(e,a){if(e&1&&I(We,7),e&2){let i;M(i=D())&&(a.canvasRef=i.first)}},decls:3,vars:0,consts:[["canvas",""],[1,"relative","h-64","w-full"],[1,"absolute","inset-0","h-full","w-full"]],template:function(e,a){e&1&&(B(0,"div",1),z(1,"canvas",2,0),H())},encapsulation:2})};var Ge=["canvas"],re=class r{estadisticas=y(A);chart;canvasRef;render(t,e){return u(this,null,function*(){let{Chart:a,BarElement:i,BarController:c,CategoryScale:h,LinearScale:f,Tooltip:C,Legend:x}=yield import("./chunk-DPEENRGO.js");a.register(i,c,h,f,C,x);let v=yield this.estadisticas.obtenerTurnosFinalizadosPorMedico(t,e),R=v.map(w=>w.nombre),g=v.map(w=>w.cantidad);this.chart?.destroy(),this.chart=new a(this.canvasRef.nativeElement,{type:"bar",data:{labels:R,datasets:[{label:"Turnos Finalizados por M\xE9dico",data:g,backgroundColor:"rgba(153, 102, 255, 0.7)",borderColor:"rgba(153, 102, 255, 1)",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{stepSize:1,precision:0}}}}})})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=E({type:r,selectors:[["app-turnos-finalizados-por-medico-chart"]],viewQuery:function(e,a){if(e&1&&I(Ge,7),e&2){let i;M(i=D())&&(a.canvasRef=i.first)}},decls:3,vars:0,consts:[["canvas",""],[1,"relative","h-64","w-full"],[1,"absolute","inset-0","h-full","w-full"]],template:function(e,a){e&1&&(B(0,"div",1),z(1,"canvas",2,0),H())},encapsulation:2})};var qe=["canvas"],ue=class r{estadisticas=y(A);chart;canvasRef;ngAfterViewInit(){this.render()}render(){return u(this,null,function*(){let{Chart:t,LineElement:e,LineController:a,PointElement:i,CategoryScale:c,LinearScale:h,Tooltip:f,Legend:C,Filler:x}=yield import("./chunk-DPEENRGO.js");t.register(e,a,i,c,h,f,C,x);let{datos:v,maxY:R}=yield this.estadisticas.obtenerIngresosEspecialistas60Dias(),g=v.map(N=>N.fecha_hora),w=v.map(N=>N.cantidad),L=this.canvasRef.nativeElement;this.chart?.destroy(),this.chart=new t(L,{type:"line",data:{labels:g,datasets:[{label:"Ingresos de Especialistas (\xFAltimos 60 d\xEDas)",data:w,borderColor:"rgba(54, 162, 235, 1)",backgroundColor:"rgba(54, 162, 235, 0.1)",borderWidth:2,fill:!0,tension:.4,pointRadius:2,pointHoverRadius:5}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,max:R,ticks:{stepSize:5,precision:0}},x:{ticks:{maxTicksLimit:20,callback:function(N,J){let ee=g[J];return ee&&J%Math.ceil(g.length/20)===0?ee:""}}}},plugins:{tooltip:{callbacks:{title:function(N){return N[0].label||""}}}}}})})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=E({type:r,selectors:[["app-ingresos-especialistas-chart"]],viewQuery:function(e,a){if(e&1&&I(qe,7),e&2){let i;M(i=D())&&(a.canvasRef=i.first)}},decls:3,vars:0,consts:[["canvas",""],[1,"relative","h-80","w-full"],[1,"absolute","inset-0","h-full","w-full"]],template:function(e,a){e&1&&(B(0,"div",1),z(1,"canvas",2,0),H())},encapsulation:2})};var Ue=["canvas"],he=class r{estadisticas=y(A);chart;canvasRef;ngAfterViewInit(){this.render()}render(){return u(this,null,function*(){let{Chart:t,LineElement:e,LineController:a,PointElement:i,CategoryScale:c,LinearScale:h,Tooltip:f,Legend:C,Filler:x}=yield import("./chunk-DPEENRGO.js");t.register(e,a,i,c,h,f,C,x);let{datos:v,maxY:R}=yield this.estadisticas.obtenerIngresosPacientes60Dias(),g=v.map(N=>N.fecha_hora),w=v.map(N=>N.cantidad),L=this.canvasRef.nativeElement;this.chart?.destroy(),this.chart=new t(L,{type:"line",data:{labels:g,datasets:[{label:"Ingresos de Pacientes (\xFAltimos 60 d\xEDas)",data:w,borderColor:"rgba(75, 192, 192, 1)",backgroundColor:"rgba(75, 192, 192, 0.1)",borderWidth:2,fill:!0,tension:.4,pointRadius:2,pointHoverRadius:5}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,max:R,ticks:{stepSize:5,precision:0}},x:{ticks:{maxTicksLimit:20,callback:function(N,J){let ee=g[J];return ee&&J%Math.ceil(g.length/20)===0?ee:""}}}},plugins:{tooltip:{callbacks:{title:function(N){return N[0].label||""}}}}}})})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=E({type:r,selectors:[["app-ingresos-pacientes-chart"]],viewQuery:function(e,a){if(e&1&&I(Ue,7),e&2){let i;M(i=D())&&(a.canvasRef=i.first)}},decls:3,vars:0,consts:[["canvas",""],[1,"relative","h-80","w-full"],[1,"absolute","inset-0","h-full","w-full"]],template:function(e,a){e&1&&(B(0,"div",1),z(1,"canvas",2,0),H())},encapsulation:2})};var Ye=["canvas"],fe=class r{estadisticas=y(A);chart;canvasRef;ngAfterViewInit(){this.render()}render(){return u(this,null,function*(){let{Chart:t,ArcElement:e,PieController:a,Tooltip:i,Legend:c}=yield import("./chunk-DPEENRGO.js");t.register(e,a,i,c);let h=yield this.estadisticas.obtenerPacientesPorEspecialidad(),f=h.map(v=>v.especialidad),C=h.map(v=>v.cantidad),x=this.canvasRef.nativeElement;this.chart?.destroy(),this.chart=new t(x,{type:"pie",data:{labels:f,datasets:[{label:"Pacientes por Especialidad",data:C,backgroundColor:["rgba(59, 130, 246, 0.7)","rgba(147, 51, 234, 0.7)","rgba(236, 72, 153, 0.7)","rgba(251, 146, 60, 0.7)","rgba(34, 197, 94, 0.7)","rgba(244, 63, 94, 0.7)","rgba(14, 165, 233, 0.7)","rgba(168, 85, 247, 0.7)"],borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"},tooltip:{callbacks:{label:function(v){let R=v.label||"",g=v.parsed||0;return`${R}: ${g} paciente${g!==1?"s":""}`}}}}}})})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=E({type:r,selectors:[["app-pacientes-por-especialidad-chart"]],viewQuery:function(e,a){if(e&1&&I(Ye,7),e&2){let i;M(i=D())&&(a.canvasRef=i.first)}},decls:3,vars:0,consts:[["canvas",""],[1,"relative","h-64","w-full"],[1,"absolute","inset-0","h-full","w-full"]],template:function(e,a){e&1&&(B(0,"div",1),z(1,"canvas",2,0),H())},encapsulation:2})};var Ze=["canvas"],ge=class r{estadisticas=y(A);chart;canvasRef;ngAfterViewInit(){this.render()}render(){return u(this,null,function*(){let{Chart:t,ArcElement:e,PieController:a,Tooltip:i,Legend:c}=yield import("./chunk-DPEENRGO.js");t.register(e,a,i,c);let h=yield this.estadisticas.obtenerMedicosPorEspecialidad(),f=h.map(v=>v.especialidad),C=h.map(v=>v.cantidad),x=this.canvasRef.nativeElement;this.chart?.destroy(),this.chart=new t(x,{type:"pie",data:{labels:f,datasets:[{label:"M\xE9dicos por Especialidad",data:C,backgroundColor:["rgba(99, 102, 241, 0.7)","rgba(236, 72, 153, 0.7)","rgba(34, 197, 94, 0.7)","rgba(251, 146, 60, 0.7)","rgba(14, 165, 233, 0.7)","rgba(168, 85, 247, 0.7)","rgba(245, 158, 11, 0.7)","rgba(239, 68, 68, 0.7)"],borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"},tooltip:{callbacks:{label:function(v){let R=v.label||"",g=v.parsed||0;return`${R}: ${g} m\xE9dico${g!==1?"s":""}`}}}}}})})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=E({type:r,selectors:[["app-medicos-por-especialidad-chart"]],viewQuery:function(e,a){if(e&1&&I(Ze,7),e&2){let i;M(i=D())&&(a.canvasRef=i.first)}},decls:3,vars:0,consts:[["canvas",""],[1,"relative","h-64","w-full"],[1,"absolute","inset-0","h-full","w-full"]],template:function(e,a){e&1&&(B(0,"div",1),z(1,"canvas",2,0),H())},encapsulation:2})};var Xe=["canvas"],Ke=(r,t)=>t.id;function Je(r,t){if(r&1){let e=Q();n(0,"div",4)(1,"span",8),s(2),o(),n(3,"button",9),P("click",function(){S(e);let i=_();return T(i.limpiarFiltro())}),s(4," Ver todos "),o()()}if(r&2){let e=_();l(2),be(" Mostrando: ",e.pacienteSeleccionado().apellido,", ",e.pacienteSeleccionado().nombre," ")}}function et(r,t){if(r&1){let e=Q();n(0,"button",19),P("click",function(){let i=S(e).$implicit,c=_(2);return T(c.seleccionarPaciente(i))}),s(1),o()}if(r&2){let e=t.$implicit;l(),be(" ",e.apellido,", ",e.nombre," ")}}function tt(r,t){if(r&1){let e=Q();n(0,"div",7)(1,"div",10),P("clickFuera",function(){S(e);let i=_();return T(i.cerrarPopup())}),n(2,"div",11)(3,"h3",12),s(4," Seleccionar Paciente "),o(),n(5,"button",13),P("click",function(){S(e);let i=_();return T(i.cerrarPopup())}),s(6," \u2715 "),o()(),n(7,"div",14)(8,"button",15),P("click",function(){S(e);let i=_();return T(i.seleccionarTodos())}),s(9," Mostrar todos los pacientes "),o()(),n(10,"div",16)(11,"div",17),se(12,et,2,2,"button",18,Ke),o()()()()}if(r&2){let e=_();l(12),le(e.pacientes())}}var ve=class r{estadisticas=y(A);chart;pacienteSeleccionado=$(null);mostrarPopup=$(!1);pacientes=$([]);canvasRef;ngAfterViewInit(){this.cargarPacientes(),this.render()}cargarPacientes(){return u(this,null,function*(){let t=yield this.estadisticas.obtenerPacientes();this.pacientes.set(t)})}abrirSeleccionPaciente(){this.mostrarPopup.set(!0)}cerrarPopup(){this.mostrarPopup.set(!1)}seleccionarPaciente(t){this.pacienteSeleccionado.set(t),this.cerrarPopup(),this.render()}seleccionarTodos(){this.pacienteSeleccionado.set(null),this.cerrarPopup(),this.render()}limpiarFiltro(){this.pacienteSeleccionado.set(null),this.render()}render(){return u(this,null,function*(){let{Chart:t,BarElement:e,BarController:a,CategoryScale:i,LinearScale:c,Tooltip:h,Legend:f}=yield import("./chunk-DPEENRGO.js");t.register(e,a,i,c,h,f);let C=this.pacienteSeleccionado()?.id,x=yield this.estadisticas.obtenerCitasPorEstado(C),v=x.map(w=>w.estado),R=x.map(w=>w.cantidad),g=this.canvasRef.nativeElement;this.chart?.destroy(),this.chart=new t(g,{type:"bar",data:{labels:v,datasets:[{label:"Cantidad de Citas",data:R,backgroundColor:["rgba(59, 130, 246, 0.7)","rgba(34, 197, 94, 0.7)","rgba(239, 68, 68, 0.7)","rgba(249, 115, 22, 0.7)","rgba(16, 185, 129, 0.7)"],borderColor:["rgba(59, 130, 246, 1)","rgba(34, 197, 94, 1)","rgba(239, 68, 68, 1)","rgba(249, 115, 22, 1)","rgba(147, 51, 234, 1)","rgba(16, 185, 129, 1)"],borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{stepSize:1}}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(w){let L=w.parsed.y||0;return`Cantidad: ${L} cita${L!==1?"s":""}`}}}}}})})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=E({type:r,selectors:[["app-citas-por-estado-chart"]],viewQuery:function(e,a){if(e&1&&I(Xe,7),e&2){let i;M(i=D())&&(a.canvasRef=i.first)}},decls:9,vars:3,consts:[["canvas",""],[1,"relative"],[1,"mb-3","flex","items-center","justify-between"],[1,"rounded-lg","bg-indigo-600","px-4","py-2","text-sm","font-medium","text-white","transition-colors","hover:bg-indigo-700",3,"click"],[1,"flex","items-center","gap-2"],[1,"relative","h-64","w-full"],[1,"absolute","inset-0","h-full","w-full"],[1,"fixed","inset-0","z-50","flex","items-center","justify-center","bg-black/30","backdrop-blur-sm"],[1,"text-sm","text-gray-600"],[1,"rounded-lg","bg-gray-200","px-3","py-1","text-sm","text-gray-700","transition-colors","hover:bg-gray-300",3,"click"],["appClickFueraPopup","",1,"w-full","max-w-md","rounded-lg","bg-white","p-6","shadow-xl",3,"clickFuera"],[1,"mb-4","flex","items-center","justify-between"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-gray-400","hover:text-gray-600",3,"click"],[1,"mb-4"],[1,"w-full","rounded-lg","bg-indigo-100","px-4","py-2","text-sm","font-medium","text-indigo-700","transition-colors","hover:bg-indigo-200",3,"click"],[1,"rounded-lg","border","border-gray-200","bg-gray-50"],[1,"max-h-96","overflow-y-auto","p-2"],[1,"w-full","rounded-lg","px-4","py-2","text-left","text-sm","transition-colors","hover:bg-white","hover:shadow-sm"],[1,"w-full","rounded-lg","px-4","py-2","text-left","text-sm","transition-colors","hover:bg-white","hover:shadow-sm",3,"click"]],template:function(e,a){if(e&1){let i=Q();n(0,"div",1)(1,"div",2)(2,"button",3),P("click",function(){return S(i),T(a.abrirSeleccionPaciente())}),s(3),o(),F(4,Je,5,2,"div",4),o(),n(5,"div",5),b(6,"canvas",6,0),o(),F(8,tt,14,0,"div",7),o()}e&2&&(l(3),m(" ",a.pacienteSeleccionado()?"Cambiar paciente":"Filtrar por paciente"," "),l(),V(a.pacienteSeleccionado()?4:-1),l(4),V(a.mostrarPopup()?8:-1))},dependencies:[Y,Be],encapsulation:2})};var Ne=[{titulo:"Distribuci\xF3n de Turnos por D\xEDa",descripcion:"An\xE1lisis de la distribuci\xF3n de citas agendadas a lo largo de la semana, permitiendo identificar los d\xEDas de mayor demanda y optimizar la disponibilidad del personal m\xE9dico."},{titulo:"Turnos por Especialidad M\xE9dica",descripcion:"Visualizaci\xF3n de la demanda de servicios por \xE1rea de especializaci\xF3n, facilitando la planificaci\xF3n de recursos y la asignaci\xF3n eficiente de profesionales."},{titulo:"Carga de Trabajo por M\xE9dico",descripcion:"Distribuci\xF3n de turnos asignados a cada profesional m\xE9dico en el per\xEDodo seleccionado, permitiendo equilibrar la carga de trabajo y detectar posibles sobrecargas."},{titulo:"Turnos Finalizados por M\xE9dico",descripcion:"Registro de consultas completadas exitosamente por cada profesional, indicador clave de productividad y cumplimiento de agenda m\xE9dica."},{titulo:"Registro de Ingresos - Especialistas",descripcion:"Seguimiento temporal de la actividad de acceso al sistema por parte del personal m\xE9dico durante los \xFAltimos 60 d\xEDas, \xFAtil para monitorear el uso de la plataforma."},{titulo:"Registro de Ingresos - Pacientes",descripcion:"Seguimiento de la actividad de acceso al sistema por parte de los pacientes durante los \xFAltimos 60 d\xEDas, indicador de engagement y uso del portal de pacientes."},{titulo:"Pacientes \xDAnicos por Especialidad",descripcion:"Cantidad de pacientes individuales atendidos en cada especialidad m\xE9dica, m\xE9trica fundamental para evaluar la cobertura y alcance de los servicios ofrecidos."},{titulo:"Personal M\xE9dico por Especialidad",descripcion:"Distribuci\xF3n del equipo de profesionales seg\xFAn su \xE1rea de especializaci\xF3n, esencial para garantizar la cobertura adecuada de todas las especialidades."},{titulo:"Estado de las Citas M\xE9dicas",descripcion:"Clasificaci\xF3n de todas las citas seg\xFAn su estado actual (solicitadas, aceptadas, rechazadas, canceladas y completadas), herramienta clave para el seguimiento operativo."}],we=class{pdf;pageWidth;pageHeight;yPosition=20;numeroPagina=1;config;constructor(t={}){this.pdf=new He({orientation:"portrait",unit:"mm",format:"a4"}),this.pageWidth=this.pdf.internal.pageSize.getWidth(),this.pageHeight=this.pdf.internal.pageSize.getHeight(),this.config={nombreArchivo:t.nombreArchivo||"informe_estadisticas",tituloDocumento:t.tituloDocumento||"INFORME DE ESTAD\xCDSTICAS",subtituloDocumento:t.subtituloDocumento||"Centro M\xE9dico - Panel Administrativo",colorPrimario:t.colorPrimario||[41,98,255],incluirFecha:t.incluirFecha??!0,incluirNumeroPagina:t.incluirNumeroPagina??!0,notaFinal:t.notaFinal||"Este informe ha sido generado autom\xE1ticamente por el Sistema de Gesti\xF3n del Centro M\xE9dico. Los datos reflejan el estado actual de las operaciones y est\xE1n sujetos a cambios en tiempo real."}}agregarEncabezado(){let[t,e,a]=this.config.colorPrimario;if(this.pdf.setFillColor(t,e,a),this.pdf.rect(0,0,this.pageWidth,35,"F"),this.pdf.setFontSize(22),this.pdf.setTextColor(255,255,255),this.pdf.setFont("helvetica","bold"),this.pdf.text(this.config.tituloDocumento,this.pageWidth/2,15,{align:"center"}),this.pdf.setFontSize(11),this.pdf.setFont("helvetica","normal"),this.pdf.text(this.config.subtituloDocumento,this.pageWidth/2,23,{align:"center"}),this.config.incluirFecha){let i=new Date().toLocaleDateString("es-AR",{weekday:"long",year:"numeric",month:"long",day:"numeric"});this.pdf.setFontSize(9),this.pdf.text(i,this.pageWidth/2,29,{align:"center"})}this.config.incluirNumeroPagina&&(this.pdf.setFontSize(8),this.pdf.setTextColor(150,150,150),this.pdf.text(`P\xE1gina ${this.numeroPagina}`,this.pageWidth-15,this.pageHeight-10,{align:"right"}))}verificarEspacio(t){return this.yPosition+t>this.pageHeight-20?(this.pdf.addPage(),this.numeroPagina++,this.agregarEncabezado(),this.yPosition=45,!0):!1}agregarGrafico(t,e){let[a,i,c]=this.config.colorPrimario;this.verificarEspacio(90),this.pdf.setDrawColor(a,i,c),this.pdf.setLineWidth(.5),this.pdf.line(15,this.yPosition,this.pageWidth-15,this.yPosition),this.yPosition+=5,this.pdf.setFontSize(14),this.pdf.setTextColor(a,i,c),this.pdf.setFont("helvetica","bold"),this.pdf.text(e.titulo,15,this.yPosition),this.yPosition+=8,this.pdf.setFontSize(9),this.pdf.setTextColor(80,80,80),this.pdf.setFont("helvetica","normal");let h=this.pdf.splitTextToSize(e.descripcion,this.pageWidth-30);this.pdf.text(h,15,this.yPosition),this.yPosition+=h.length*4+5,this.verificarEspacio(75),this.pdf.setDrawColor(220,220,220),this.pdf.setLineWidth(.3),this.pdf.roundedRect(13,this.yPosition-2,this.pageWidth-26,72,2,2,"S");let f=t.toDataURL("image/png"),C=this.pageWidth-34,x=t.height*C/t.width,R=Math.min(x,68),g=t.width*R/t.height,w=(this.pageWidth-g)/2;this.pdf.addImage(f,"PNG",w,this.yPosition,g,R),this.yPosition+=82}agregarNotaFinal(){let[t,e,a]=this.config.colorPrimario;this.yPosition<this.pageHeight-50?this.yPosition=this.pageHeight-45:(this.pdf.addPage(),this.numeroPagina++,this.agregarEncabezado(),this.yPosition=45),this.pdf.setDrawColor(t,e,a),this.pdf.setLineWidth(.5),this.pdf.line(15,this.yPosition,this.pageWidth-15,this.yPosition),this.yPosition+=8,this.pdf.setFontSize(9),this.pdf.setTextColor(100,100,100),this.pdf.setFont("helvetica","italic");let i=this.pdf.splitTextToSize(this.config.notaFinal,this.pageWidth-30);this.pdf.text(i,this.pageWidth/2,this.yPosition,{align:"center"})}generar(t){this.agregarEncabezado(),this.yPosition=45;let e=Math.min(t.length,Ne.length);for(let a=0;a<e;a++)this.agregarGrafico(t[a],Ne[a]);this.agregarNotaFinal()}descargar(){let t=new Date().toISOString().split("T")[0],e=`${this.config.nombreArchivo}_${t}.pdf`;this.pdf.save(e)}};function Qe(){return u(this,arguments,function*(r={}){let t=Array.from(document.querySelectorAll("canvas"));if(t.length===0)throw new Error("No se encontraron gr\xE1ficos para exportar");let e=new we(r);e.generar(t),e.descargar()})}function at(r,t){if(r&1){let e=Q();n(0,"div",8)(1,"section",9)(2,"div",10)(3,"div",11),O(),n(4,"svg",12),b(5,"path",13),o()(),G(),n(6,"div")(7,"h3",14),s(8),d(9,"transloco"),o(),n(10,"p",15),s(11),d(12,"transloco"),o()()(),n(13,"div",16),b(14,"app-turnos-por-dia-chart"),o()(),n(15,"section",9)(16,"div",10)(17,"div",17),O(),n(18,"svg",18),b(19,"path",19),o()(),G(),n(20,"div")(21,"h3",14),s(22),d(23,"transloco"),o(),n(24,"p",15),s(25),d(26,"transloco"),o()()(),n(27,"div",16),b(28,"app-turnos-por-especialidad-chart"),o()(),n(29,"section",20)(30,"div",10)(31,"div",21),O(),n(32,"svg",22),b(33,"path",23),o()(),G(),n(34,"div",24)(35,"h3",14),s(36),d(37,"transloco"),o(),n(38,"p",15),s(39),d(40,"transloco"),o()()(),n(41,"div",25)(42,"label",26)(43,"span",27),s(44),d(45,"transloco"),o(),n(46,"input",28),P("change",function(i){S(e);let c=_();return T(c.onDesdeTurnosMedicoChange(i))}),o()(),n(47,"label",26)(48,"span",27),s(49),d(50,"transloco"),o(),n(51,"input",28),P("change",function(i){S(e);let c=_();return T(c.onHastaTurnosMedicoChange(i))}),o()(),n(52,"button",29),P("click",function(){S(e);let i=_();return T(i.onAplicarTurnosMedico())}),s(53),d(54,"transloco"),o()(),n(55,"div",16),b(56,"app-turnos-por-medico-chart"),o()(),n(57,"section",20)(58,"div",10)(59,"div",30),O(),n(60,"svg",31),b(61,"path",32),o()(),G(),n(62,"div",24)(63,"h3",14),s(64),d(65,"transloco"),o(),n(66,"p",15),s(67),d(68,"transloco"),o()()(),n(69,"div",25)(70,"label",26)(71,"span",27),s(72),d(73,"transloco"),o(),n(74,"input",28),P("change",function(i){S(e);let c=_();return T(c.onDesdeTurnosFinalizadosChange(i))}),o()(),n(75,"label",26)(76,"span",27),s(77),d(78,"transloco"),o(),n(79,"input",28),P("change",function(i){S(e);let c=_();return T(c.onHastaTurnosFinalizadosChange(i))}),o()(),n(80,"button",29),P("click",function(){S(e);let i=_();return T(i.onAplicarTurnosFinalizados())}),s(81),d(82,"transloco"),o()(),n(83,"div",16),b(84,"app-turnos-finalizados-por-medico-chart"),o()(),n(85,"section",9)(86,"div",10)(87,"div",33),O(),n(88,"svg",34),b(89,"path",35),o()(),G(),n(90,"div")(91,"h3",14),s(92),d(93,"transloco"),o(),n(94,"p",15),s(95),d(96,"transloco"),o()()(),n(97,"div",16),b(98,"app-ingresos-especialistas-chart"),o()(),n(99,"section",9)(100,"div",10)(101,"div",36),O(),n(102,"svg",37),b(103,"path",35),o()(),G(),n(104,"div")(105,"h3",14),s(106),d(107,"transloco"),o(),n(108,"p",15),s(109),d(110,"transloco"),o()()(),n(111,"div",16),b(112,"app-ingresos-pacientes-chart"),o()(),n(113,"section",9)(114,"div",10)(115,"div",38),O(),n(116,"svg",39),b(117,"path",40),o()(),G(),n(118,"div")(119,"h3",14),s(120),d(121,"transloco"),o(),n(122,"p",15),s(123),d(124,"transloco"),o()()(),n(125,"div",16),b(126,"app-pacientes-por-especialidad-chart"),o()(),n(127,"section",9)(128,"div",10)(129,"div",41),O(),n(130,"svg",42),b(131,"path",43),o()(),G(),n(132,"div")(133,"h3",14),s(134),d(135,"transloco"),o(),n(136,"p",15),s(137),d(138,"transloco"),o()()(),n(139,"div",16),b(140,"app-medicos-por-especialidad-chart"),o()(),n(141,"section",20)(142,"div",10)(143,"div",44),O(),n(144,"svg",45),b(145,"path",46),o()(),G(),n(146,"div")(147,"h3",14),s(148),d(149,"transloco"),o(),n(150,"p",15),s(151),d(152,"transloco"),o()()(),n(153,"div",16),b(154,"app-citas-por-estado-chart"),o()()()}if(r&2){let e=_();l(8),m(" ",p(9,28,"homePage.graficos.turnosPorDia.titulo")," "),l(3),m(" ",p(12,30,"homePage.graficos.turnosPorDia.descripcion")," "),l(11),m(" ",p(23,32,"homePage.graficos.turnosPorEspecialidad.titulo")," "),l(3),m(" ",p(26,34,"homePage.graficos.turnosPorEspecialidad.descripcion")," "),l(11),m(" ",p(37,36,"homePage.graficos.turnosPorMedico.titulo")," "),l(3),m(" ",p(40,38,"homePage.graficos.turnosPorMedico.descripcion")," "),l(5),k(p(45,40,"homePage.filtros.desde")),l(2),X("value",e.rangoTurnosPorMedico().desde),l(3),k(p(50,42,"homePage.filtros.hasta")),l(2),X("value",e.rangoTurnosPorMedico().hasta),l(2),m(" ",p(54,44,"homePage.filtros.aplicar")," "),l(11),m(" ",p(65,46,"homePage.graficos.turnosFinalizados.titulo")," "),l(3),m(" ",p(68,48,"homePage.graficos.turnosFinalizados.descripcion")," "),l(5),k(p(73,50,"homePage.filtros.desde")),l(2),X("value",e.rangoTurnosFinalizados().desde),l(3),k(p(78,52,"homePage.filtros.hasta")),l(2),X("value",e.rangoTurnosFinalizados().hasta),l(2),m(" ",p(82,54,"homePage.filtros.aplicar")," "),l(11),m(" ",p(93,56,"homePage.graficos.ingresosEspecialistas.titulo")," "),l(3),m(" ",p(96,58,"homePage.graficos.ingresosEspecialistas.descripcion")," "),l(11),m(" ",p(107,60,"homePage.graficos.ingresosPacientes.titulo")," "),l(3),m(" ",p(110,62,"homePage.graficos.ingresosPacientes.descripcion")," "),l(11),m(" ",p(121,64,"homePage.graficos.pacientesPorEspecialidad.titulo")," "),l(3),m(" ",p(124,66,"homePage.graficos.pacientesPorEspecialidad.descripcion")," "),l(11),m(" ",p(135,68,"homePage.graficos.medicosPorEspecialidad.titulo")," "),l(3),m(" ",p(138,70,"homePage.graficos.medicosPorEspecialidad.descripcion")," "),l(11),m(" ",p(149,72,"homePage.graficos.citasPorEstado.titulo")," "),l(3),m(" ",p(152,74,"homePage.graficos.citasPorEstado.descripcion")," ")}}var _e=class r{loading=y(K);estadisticas=y(A);datosCargados=$(!1);rangoTurnosPorMedico=$({desde:"2024-01-01",hasta:"2027-01-01"});rangoTurnosFinalizados=$({desde:"2024-01-01",hasta:"2027-01-01"});turnosPorDiaChart;turnosPorEspecialidadChart;turnosPorMedicoChart;turnosFinalizadosChart;ngOnInit(){this.loading.show(),this.cargarDatosIniciales()}cargarDatosIniciales(){return u(this,null,function*(){try{yield this.estadisticas.precargarDatosEstadisticas(),this.datosCargados.set(!0),setTimeout(()=>this.cargarChartsConRangos(),0)}catch(t){console.error("Error precargando datos:",t),this.datosCargados.set(!0),this.loading.hide()}})}cargarChartsConRangos(){return u(this,null,function*(){try{yield Promise.all([this.cargarTurnosPorMedico(),this.cargarTurnosFinalizados()])}finally{this.loading.hide()}})}cargarTurnosPorMedico(){return u(this,null,function*(){let{desde:t,hasta:e}=this.rangoTurnosPorMedico();yield this.turnosPorMedicoChart?.render(t,e)})}cargarTurnosFinalizados(){return u(this,null,function*(){let{desde:t,hasta:e}=this.rangoTurnosFinalizados();yield this.turnosFinalizadosChart?.render(t,e)})}onDesdeTurnosMedicoChange(t){let e=t.target;this.rangoTurnosPorMedico.set(ie(te({},this.rangoTurnosPorMedico()),{desde:e.value}))}onHastaTurnosMedicoChange(t){let e=t.target;this.rangoTurnosPorMedico.set(ie(te({},this.rangoTurnosPorMedico()),{hasta:e.value}))}onAplicarTurnosMedico(){return u(this,null,function*(){this.loading.show();try{yield this.cargarTurnosPorMedico()}finally{this.loading.hide()}})}onDesdeTurnosFinalizadosChange(t){let e=t.target;this.rangoTurnosFinalizados.set(ie(te({},this.rangoTurnosFinalizados()),{desde:e.value}))}onHastaTurnosFinalizadosChange(t){let e=t.target;this.rangoTurnosFinalizados.set(ie(te({},this.rangoTurnosFinalizados()),{hasta:e.value}))}onAplicarTurnosFinalizados(){return u(this,null,function*(){this.loading.show();try{yield this.cargarTurnosFinalizados()}finally{this.loading.hide()}})}exportarEstadisticasPdf(){return u(this,null,function*(){this.loading.show();try{yield Qe()}catch(t){console.error("Error al exportar PDF:",t)}finally{this.loading.hide()}})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=E({type:r,selectors:[["app-home"]],viewQuery:function(e,a){if(e&1&&(I(ae,5),I(ne,5),I(oe,5),I(re,5)),e&2){let i;M(i=D())&&(a.turnosPorDiaChart=i.first),M(i=D())&&(a.turnosPorEspecialidadChart=i.first),M(i=D())&&(a.turnosPorMedicoChart=i.first),M(i=D())&&(a.turnosFinalizadosChart=i.first)}},decls:16,vars:10,consts:[[1,"h-full","w-full","p-1"],[1,"h-full","w-full","overflow-auto","rounded-2xl","border","border-white","bg-crema","p-6","shadow-inner"],[1,"mb-8","flex","items-center","justify-between"],[1,"mb-2","text-4xl","font-bold","text-azul-oscuro"],[1,"text-gray-600"],[1,"flex","items-center","gap-2","rounded-lg","bg-red-500","px-6","py-3","text-sm","font-medium","text-white","shadow-md","transition-all","hover:bg-red-700","hover:shadow-lg","active:scale-95",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"grid","gap-6","lg:grid-cols-2"],[1,"rounded-xl","bg-white","p-6","shadow-lg","transition-all","hover:shadow-xl"],[1,"mb-4","flex","items-center","gap-3"],[1,"rounded-lg","bg-blue-100","p-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"text-xl","font-semibold","text-gray-800"],[1,"text-sm","text-gray-500"],[1,"rounded-lg","bg-gray-50","p-4"],[1,"rounded-lg","bg-purple-100","p-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-purple-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"],[1,"rounded-xl","bg-white","p-6","shadow-lg","transition-all","hover:shadow-xl","lg:col-span-2"],[1,"rounded-lg","bg-teal-100","p-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-teal-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"],[1,"flex-1"],[1,"mb-4","flex","flex-wrap","items-center","gap-4","rounded-lg","bg-gray-50","p-4"],[1,"flex","items-center","gap-2"],[1,"text-sm","font-medium","text-gray-700"],["type","date",1,"focus:ring-opacity-50","rounded-lg","border","border-gray-300","px-3","py-2","text-sm","shadow-sm","focus:border-azul-oscuro","focus:ring-2","focus:ring-azul-oscuro","focus:outline-none",3,"change","value"],[1,"ml-auto","rounded-lg","bg-azul-oscuro","px-6","py-2","text-sm","font-medium","text-white","shadow-md","transition-all","hover:bg-azul-claro","hover:shadow-lg","active:scale-95",3,"click"],[1,"rounded-lg","bg-green-100","p-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"rounded-lg","bg-indigo-100","p-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-indigo-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"],[1,"rounded-lg","bg-cyan-100","p-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-cyan-600"],[1,"rounded-lg","bg-pink-100","p-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-pink-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"],[1,"rounded-lg","bg-amber-100","p-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-amber-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"],[1,"rounded-lg","bg-violet-100","p-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-violet-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"]],template:function(e,a){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"h1",3),s(5),d(6,"transloco"),o(),n(7,"p",4),s(8),d(9,"transloco"),o()(),n(10,"button",5),P("click",function(){return a.exportarEstadisticasPdf()}),O(),n(11,"svg",6),b(12,"path",7),o(),s(13),d(14,"transloco"),o()(),F(15,at,155,76,"div",8),o()()),e&2&&(l(5),m(" ",p(6,4,"homePage.titulo")," "),l(3),k(p(9,6,"homePage.subtitulo")),l(5),m(" ",p(14,8,"homePage.botonExportar")," "),l(2),V(a.datosCargados()?15:-1))},dependencies:[Y,ae,ne,oe,re,ue,he,fe,ge,ve,pe,de],encapsulation:2})};var rt=r=>({nombre:r}),st=(r,t)=>t.citaId;function lt(r,t){r&1&&(n(0,"div",5)(1,"div",7),b(2,"div",8),n(3,"p",4),s(4),d(5,"transloco"),o()()()),r&2&&(l(4),k(p(5,1,"entradaPage.cargando")))}function ct(r,t){if(r&1){let e=Q();n(0,"button",31),P("click",function(){S(e);let i=_(5);return T(i.navegarA("solicitar-turnos"))}),s(1),d(2,"transloco"),o()}r&2&&(l(),m(" ",p(2,1,"entradaPage.solicitarTurno")," "))}function dt(r,t){if(r&1&&(n(0,"div",13)(1,"mat-icon",28),s(2,"event_busy"),o(),n(3,"p",29),s(4),d(5,"transloco"),d(6,"transloco"),o(),F(7,ct,3,3,"button",30),o()),r&2){let e=_(3);l(4),m(" ",e.rol==="paciente"?p(5,2,"entradaPage.noTurnosPaciente"):p(6,4,"entradaPage.noTurnosEspecialista")," "),l(3),V(e.rol==="paciente"?7:-1)}}function pt(r,t){if(r&1&&(n(0,"mat-icon",29),s(1,"person"),o(),n(2,"span"),s(3),o()),r&2){let e=_().$implicit;l(3),k(e.especialistaNombreCompleto)}}function mt(r,t){if(r&1&&(n(0,"mat-icon",29),s(1,"person"),o(),n(2,"span"),s(3),o()),r&2){let e=_().$implicit;l(3),k(e.pacienteNombreCompleto)}}function ut(r,t){if(r&1){let e=Q();n(0,"div",32)(1,"div",33)(2,"div",34)(3,"div",35)(4,"span",36),s(5),o(),n(6,"span",37),s(7),o()(),n(8,"div",38)(9,"mat-icon",29),s(10,"calendar_today"),o(),n(11,"span",39),s(12),o()(),n(13,"div",40)(14,"mat-icon",29),s(15,"schedule"),o(),n(16,"span"),s(17),o(),n(18,"span",41),s(19,"\u2022"),o(),F(20,pt,4,1)(21,mt,4,1),o()(),n(22,"button",42),P("click",function(){S(e);let i=_(4),c=_();return T(c.navegarA(i.rol==="paciente"?"mis-turnos-paciente":"mis-turnos-especialista"))}),s(23),d(24,"transloco"),o()()()}if(r&2){let e=t.$implicit,a=_(4),i=_();l(4),Te(i.getEstadoClase(e.estado)),l(),m(" ",e.estado.charAt(0).toUpperCase()+e.estado.slice(1)," "),l(2),m(" ",e.especialidadNombre," "),l(5),m(" ",i.formatearFecha(e.fechaHora)," "),l(5),k(i.formatearHora(e.fechaHora)),l(3),V(a.rol==="paciente"?20:21),l(3),m(" ",p(24,8,"entradaPage.verDetalles")," ")}}function ht(r,t){if(r&1&&(n(0,"div",14),se(1,ut,25,10,"div",32,st),o()),r&2){let e=_(4);l(),le(e.proximosTurnos())}}function ft(r,t){if(r&1){let e=Q();n(0,"button",43),P("click",function(){S(e);let i=_(4);return T(i.navegarA("solicitar-turnos"))}),n(1,"mat-icon",44),s(2,"add_circle"),o(),n(3,"div",45)(4,"p",46),s(5),d(6,"transloco"),o(),n(7,"p",47),s(8),d(9,"transloco"),o()()(),n(10,"button",43),P("click",function(){S(e);let i=_(4);return T(i.navegarA("mis-turnos-paciente"))}),n(11,"mat-icon",44),s(12,"list_alt"),o(),n(13,"div",45)(14,"p",46),s(15),d(16,"transloco"),o(),n(17,"p",47),s(18),d(19,"transloco"),o()()(),n(20,"button",43),P("click",function(){S(e);let i=_(4);return T(i.navegarA("perfil-paciente"))}),n(21,"mat-icon",44),s(22,"account_circle"),o(),n(23,"div",45)(24,"p",46),s(25),d(26,"transloco"),o(),n(27,"p",47),s(28),d(29,"transloco"),o()()()}r&2&&(l(5),m(" ",p(6,6,"entradaPage.paciente.solicitarTurno")," "),l(3),m(" ",p(9,8,"entradaPage.paciente.solicitarTurnoDesc")," "),l(7),m(" ",p(16,10,"entradaPage.paciente.misTurnos")," "),l(3),m(" ",p(19,12,"entradaPage.paciente.misTurnosDesc")," "),l(7),m(" ",p(26,14,"entradaPage.paciente.miPerfil")," "),l(3),m(" ",p(29,16,"entradaPage.paciente.miPerfilDesc")," "))}function gt(r,t){if(r&1){let e=Q();n(0,"button",43),P("click",function(){S(e);let i=_(4);return T(i.navegarA("mis-turnos-especialista"))}),n(1,"mat-icon",44),s(2,"event_note"),o(),n(3,"div",45)(4,"p",46),s(5),d(6,"transloco"),o(),n(7,"p",47),s(8),d(9,"transloco"),o()()(),n(10,"button",43),P("click",function(){S(e);let i=_(4);return T(i.navegarA("pacientes"))}),n(11,"mat-icon",44),s(12,"people"),o(),n(13,"div",45)(14,"p",46),s(15),d(16,"transloco"),o(),n(17,"p",47),s(18),d(19,"transloco"),o()()(),n(20,"button",43),P("click",function(){S(e);let i=_(4);return T(i.navegarA("perfil-especialista"))}),n(21,"mat-icon",44),s(22,"account_circle"),o(),n(23,"div",45)(24,"p",46),s(25),d(26,"transloco"),o(),n(27,"p",47),s(28),d(29,"transloco"),o()()()}r&2&&(l(5),m(" ",p(6,6,"entradaPage.especialista.misTurnos")," "),l(3),m(" ",p(9,8,"entradaPage.especialista.misTurnosDesc")," "),l(7),m(" ",p(16,10,"entradaPage.especialista.misPacientes")," "),l(3),m(" ",p(19,12,"entradaPage.especialista.misPacientesDesc")," "),l(7),m(" ",p(26,14,"entradaPage.especialista.miPerfil")," "),l(3),m(" ",p(29,16,"entradaPage.especialista.miPerfilDesc")," "))}function vt(r,t){r&1&&(n(0,"li",48)(1,"mat-icon",49),s(2,"check_circle"),o(),n(3,"span"),s(4),d(5,"transloco"),o()(),n(6,"li",48)(7,"mat-icon",49),s(8,"check_circle"),o(),n(9,"span"),s(10),d(11,"transloco"),o()(),n(12,"li",48)(13,"mat-icon",49),s(14,"check_circle"),o(),n(15,"span"),s(16),d(17,"transloco"),o()()),r&2&&(l(4),k(p(5,3,"entradaPage.paciente.info1")),l(6),k(p(11,5,"entradaPage.paciente.info2")),l(6),k(p(17,7,"entradaPage.paciente.info3")))}function _t(r,t){r&1&&(n(0,"li",48)(1,"mat-icon",49),s(2,"check_circle"),o(),n(3,"span"),s(4),d(5,"transloco"),o()(),n(6,"li",48)(7,"mat-icon",49),s(8,"check_circle"),o(),n(9,"span"),s(10),d(11,"transloco"),o()(),n(12,"li",48)(13,"mat-icon",49),s(14,"check_circle"),o(),n(15,"span"),s(16),d(17,"transloco"),o()()),r&2&&(l(4),k(p(5,3,"entradaPage.especialista.info1")),l(6),k(p(11,5,"entradaPage.especialista.info2")),l(6),k(p(17,7,"entradaPage.especialista.info3")))}function Ct(r,t){if(r&1&&(n(0,"div",6)(1,"div",9)(2,"div",10)(3,"h2",11)(4,"mat-icon",12),s(5,"event_note"),o(),s(6),d(7,"transloco"),o()(),F(8,dt,8,6,"div",13)(9,ht,3,0,"div",14),o(),n(10,"div",9)(11,"h2",15)(12,"mat-icon",12),s(13,"flash_on"),o(),s(14),d(15,"transloco"),o(),n(16,"div",16),F(17,ft,30,18)(18,gt,30,18),o()(),n(19,"div",17)(20,"div",18)(21,"div",19)(22,"mat-icon",20),s(23,"info"),o(),n(24,"h3",21),s(25),d(26,"transloco"),o()(),n(27,"ul",22),F(28,vt,18,9)(29,_t,18,9),o()(),n(30,"div",23)(31,"div",19)(32,"mat-icon",24),s(33,"contact_support"),o(),n(34,"h3",21),s(35),d(36,"transloco"),o()(),n(37,"p",25),s(38),d(39,"transloco"),o(),n(40,"div",22)(41,"div",26)(42,"mat-icon",27),s(43,"email"),o(),n(44,"span"),s(45,"soporte@clinica.com"),o()(),n(46,"div",26)(47,"mat-icon",27),s(48,"phone"),o(),n(49,"span"),s(50,"0800-123-4567"),o()()()()()()),r&2){let e=_(2),a=_();l(6),m(" ",p(7,8,"entradaPage.proximosTurnos")," "),l(2),V(a.proximosTurnos().length===0?8:9),l(6),m(" ",p(15,10,"entradaPage.accionesRapidas")," "),l(3),V(e.rol==="paciente"?17:e.rol==="especialista"?18:-1),l(8),m(" ",p(26,12,"entradaPage.informacionImportante")," "),l(3),V(e.rol==="paciente"?28:29),l(7),m(" ",p(36,14,"entradaPage.necesitasAyuda")," "),l(3),m(" ",p(39,16,"entradaPage.necesitasAyudaDesc")," ")}}function bt(r,t){if(r&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),s(4),d(5,"transloco"),o(),n(6,"p",4),s(7),o()(),F(8,lt,6,3,"div",5)(9,Ct,51,18,"div",6),o()()),r&2){let e=_(),a=_();X("@slideInFromRight",void 0),l(4),m(" ",Me(5,4,"entradaPage.bienvenida",Ie(7,rt,e.nombre))," "),l(3),k(a.getFechaActual()),l(),V(a.cargando()?8:9)}}function xt(r,t){if(r&1&&F(0,bt,10,9,"div",0),r&2){let e=_();V(e.mostrarContenido?0:-1)}}var Ce=class r{constructor(t,e,a,i){this.authSupabase=t;this.turnosService=e;this.router=a;this.loading=i;this.usuario$=this.authSupabase.user$}usuario$;usuarioActual=null;realtimeChannel;proximosTurnos=$([]);cargando=$(!0);mostrarContenido=!1;ngOnInit(){return u(this,null,function*(){this.usuarioActual=yield ye(this.usuario$),this.usuarioActual&&(yield this.cargarDatos(),this.suscribirseACambiosCitas(),setTimeout(()=>{this.mostrarContenido=!0},100))})}ngOnDestroy(){this.realtimeChannel&&q.removeChannel(this.realtimeChannel)}suscribirseACambiosCitas(){if(!this.usuarioActual?.id)return;let t=this.usuarioActual.id,e=this.usuarioActual.rol;this.realtimeChannel=q.channel("citas-changes").on("postgres_changes",{event:"*",schema:"public",table:U.CITAS,filter:e==="paciente"?`paciente_id=eq.${t}`:`especialista_id=eq.${t}`},()=>{this.cargarDatos()}).subscribe()}cargarDatos(){return u(this,null,function*(){if(this.usuarioActual?.id){this.cargando.set(!0);try{let t=[];this.usuarioActual.rol==="paciente"?t=yield this.turnosService.obtenerCitasPaciente(this.usuarioActual.id):this.usuarioActual.rol==="especialista"&&(t=yield this.turnosService.obtenerCitasEspecialista(this.usuarioActual.id)),this.proximosTurnos.set(this.turnosService.obtenerProximosTurnos(t,3))}catch(t){console.error("Error al cargar datos:",t)}finally{this.cargando.set(!1)}}})}formatearFecha(t){return new Date(t).toLocaleDateString("es-AR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}getFechaActual(){return new Date().toLocaleDateString("es-AR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}formatearHora(t){return new Date(t).toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit"})}getEstadoClase(t){return{solicitado:"bg-yellow-100 text-yellow-800",aceptado:"bg-green-100 text-green-800",rechazado:"bg-red-100 text-red-800",cancelado:"bg-gray-100 text-gray-800",completado:"bg-blue-100 text-blue-800"}[t]||"bg-gray-100 text-gray-800"}navegarA(t){t!=="mis-turnos-especialista"&&t!=="pacientes"&&t!=="mis-turnos-paciente"&&this.loading.show();let e=`/home/${t}`;if(this.router.url===e){t!=="mis-turnos-especialista"&&this.loading.hide();return}this.router.navigate([e])}static \u0275fac=function(e){return new(e||r)(Z(me),Z(Le),Z(De),Z(K))};static \u0275cmp=E({type:r,selectors:[["app-entrada"]],decls:2,vars:3,consts:[[1,"h-full","w-full","overflow-hidden","p-1"],[1,"h-full","w-full","overflow-auto","rounded-2xl","border","border-white","bg-crema","p-6","shadow-inner"],[1,"mb-6"],[1,"mb-2","text-3xl","font-bold","text-azul-oscuro"],[1,"text-gray-600"],[1,"flex","items-center","justify-center","py-12"],[1,"mx-auto","max-w-6xl","space-y-6"],[1,"text-center"],[1,"mx-auto","mb-4","h-12","w-12","animate-spin","rounded-full","border-4","border-azul-oscuro","border-t-transparent"],[1,"rounded-lg","bg-white","p-6","shadow-md"],[1,"mb-4","flex","items-center","justify-between"],[1,"text-2xl","font-semibold","text-azul-oscuro"],[1,"mr-2","align-middle"],[1,"py-8","text-center","text-gray-500"],[1,"space-y-3"],[1,"mb-4","text-2xl","font-semibold","text-azul-oscuro"],[1,"grid","grid-cols-1","gap-4","md:grid-cols-2","lg:grid-cols-3"],[1,"grid","grid-cols-1","gap-4","md:grid-cols-2"],[1,"rounded-lg","bg-blue-50","p-6","shadow-md"],[1,"mb-3","flex","items-center","gap-2"],[1,"text-2xl","text-blue-600"],[1,"text-lg","font-semibold","text-azul-oscuro"],[1,"space-y-2","text-sm","text-gray-700"],[1,"rounded-lg","bg-green-50","p-6","shadow-md"],[1,"text-2xl","text-green-600"],[1,"mb-3","text-sm","text-gray-700"],[1,"flex","items-center","gap-2"],[1,"text-sm","text-green-600"],[1,"mb-2","text-5xl","text-gray-300"],[1,"text-lg"],[1,"mt-4","rounded-lg","bg-azul-oscuro","px-6","py-2","font-medium","text-white","transition-colors","hover:bg-blue-700"],[1,"mt-4","rounded-lg","bg-azul-oscuro","px-6","py-2","font-medium","text-white","transition-colors","hover:bg-blue-700",3,"click"],[1,"rounded-lg","border","border-gray-200","bg-gray-50","p-4","transition-shadow","hover:shadow-md"],[1,"flex","items-start","justify-between"],[1,"flex-1"],[1,"mb-2","flex","items-center","gap-3"],[1,"rounded-full","px-3","py-1","text-xs","font-semibold"],[1,"text-sm","font-medium","text-gray-700"],[1,"mb-2","flex","items-center","gap-2","text-gray-700"],[1,"font-medium"],[1,"flex","items-center","gap-2","text-gray-600"],[1,"mx-2"],[1,"rounded-lg","bg-azul-oscuro","px-4","py-2","text-sm","font-medium","text-white","transition-colors","hover:bg-blue-700",3,"click"],[1,"flex","items-center","gap-3","rounded-lg","border-2","border-azul-oscuro","bg-white","p-4","transition-all","hover:bg-azul-oscuro","hover:text-white",3,"click"],[1,"text-3xl"],[1,"text-left"],[1,"font-semibold"],[1,"text-sm","opacity-75"],[1,"flex","items-start","gap-2"],[1,"text-sm","text-blue-600"]],template:function(e,a){if(e&1&&(F(0,xt,1,1),d(1,"async")),e&2){let i;V((i=p(1,1,a.usuario$))?0:-1,i)}},dependencies:[Y,Ve,Fe,pe,ce,de],encapsulation:2,data:{animation:[Ae("slideInFromRight",[ke(":enter",[xe({transform:"translateX(150%)",opacity:0}),Re("600ms cubic-bezier(0.35, 0, 0.25, 1)",xe({transform:"translateX(0)",opacity:1}))])])]}})};function Et(r,t){r&1&&b(0,"app-home")}function Pt(r,t){r&1&&b(0,"app-entrada")}function wt(r,t){r&1&&F(0,Et,1,0,"app-home")(1,Pt,1,0,"app-entrada"),r&2&&V(t.rol==="admin"?0:1)}var je=class r{constructor(t){this.authSupabase=t;this.usuario$=this.authSupabase.user$}usuario$;loading=y(K);ngAfterViewInit(){setTimeout(()=>{this.loading.hide()},0)}static \u0275fac=function(e){return new(e||r)(Z(me))};static \u0275cmp=E({type:r,selectors:[["app-home-router"]],decls:2,vars:3,template:function(e,a){if(e&1&&(F(0,wt,2,1),d(1,"async")),e&2){let i;V((i=p(1,1,a.usuario$))?0:-1,i)}},dependencies:[Y,_e,Ce,ce],encapsulation:2})};export{je as HomeRouter};
